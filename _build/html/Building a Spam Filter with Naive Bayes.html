
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Building a Spam Filter with Naive Bayes &#8212; My Jupyter books</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/togglebutton.js"></script>
    <script type="text/javascript" src="_static/clipboard.min.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript">var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script type="text/javascript" src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" type="text/javascript" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script type="text/javascript">
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" type="text/javascript" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Building A Handwritten Digits Classifier using Cross Validation" href="HandwrittenDigitsClassifierUsingCrossValidation.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">My Jupyter books</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="landing-page.html">
   My Jupyter books
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="HandwrittenDigitsClassifierUsingCrossValidation.html">
   Building A Handwritten Digits Classifier using Cross Validation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Building a Spam Filter with Naive Bayes
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Building a Spam Filter with Naive Bayes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/arnoudbeerepoot/Building-A-Handwritten-Digits-Classifier-using-Cross-Validation"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/arnoudbeerepoot/Building-A-Handwritten-Digits-Classifier-using-Cross-Validation/issues/new?title=Issue%20on%20page%20%2FBuilding a Spam Filter with Naive Bayes.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/arnoudbeerepoot/Building-A-Handwritten-Digits-Classifier-using-Cross-Validation/master?urlpath=tree/Building a Spam Filter with Naive Bayes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-dataset-and-analyze-the-data">
   Import dataset and analyze the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-train-and-test-set">
   Create a train and test set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clean-the-dataset">
   Clean the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-accuracy">
   Test accuracy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="building-a-spam-filter-with-naive-bayes">
<h1>Building a Spam Filter with Naive Bayes<a class="headerlink" href="#building-a-spam-filter-with-naive-bayes" title="Permalink to this headline">¶</a></h1>
<p>In this project a spam filter is built based on the Naive Bayes algorithm. It will be used to classify SMS messages as spam or non-spam. The spam-filter is being trained with a dataset of 5572 SMS messages that are already classified by humans <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/sms+spam+collection">The UCI Machine Learning Repository</a>
See wikipedia for background information <a class="reference external" href="https://en.wikipedia.org/wiki/Naive_Bayes_classifier">Naive Bayes classifier</a></p>
<div class="section" id="import-dataset-and-analyze-the-data">
<h2>Import dataset and analyze the data<a class="headerlink" href="#import-dataset-and-analyze-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;SMSSpamCollection.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">,</span> <span class="s1">&#39;SMS&#39;</span><span class="p">])</span> 
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5572 entries, 0 to 5571
Data columns (total 2 columns):
Label    5572 non-null object
SMS      5572 non-null object
dtypes: object(2)
memory usage: 87.2+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show the first five rows</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Go until jurong point, crazy.. Available only ...</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>Ok lar... Joking wif u oni...</td>
    </tr>
    <tr>
      <td>2</td>
      <td>spam</td>
      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>U dun say so early hor... U c already then say...</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>Nah I don't think he goes to usf, he lives aro...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># how many spam vs non-spam messages are in the dataset?</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     4825
spam     747
Name: Label, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percentage_spam</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">747</span><span class="o">/</span><span class="p">(</span><span class="mi">4825</span><span class="o">+</span><span class="mi">747</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="s2">&quot;In the dataset </span><span class="si">{}</span><span class="s2"> </span><span class="si">% o</span><span class="s2">f the messages is spam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentage_spam</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;In the dataset 13.4 % of the messages is spam&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-a-train-and-test-set">
<h2>Create a train and test set<a class="headerlink" href="#create-a-train-and-test-set" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Randomize the entire dataset</span>
<span class="n">random</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the randomized dataset in a train and test set</span>
<span class="c1"># 80% is training that is 4458 records</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">random</span><span class="p">[:</span><span class="mi">4458</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">random</span><span class="p">[</span><span class="mi">4458</span><span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4458 entries, 0 to 4457
Data columns (total 2 columns):
Label    4458 non-null object
SMS      4458 non-null object
dtypes: object(2)
memory usage: 69.8+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of ham and spam messages in the train set</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     3858
spam     600
Name: Label, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percentage_spam_train</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">600</span><span class="o">/</span><span class="p">(</span><span class="mi">3858</span><span class="o">+</span><span class="mi">600</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="s2">&quot;In the training dataset </span><span class="si">{}</span><span class="s2"> </span><span class="si">% o</span><span class="s2">f the messages is spam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentage_spam_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;In the training dataset 13.5 % of the messages is spam&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of ham and spam messages in the test set</span>
<span class="n">test</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     967
spam    147
Name: Label, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percentage_spam_test</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">147</span><span class="o">/</span><span class="p">(</span><span class="mi">967</span><span class="o">+</span><span class="mi">147</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="s2">&quot;In the test dataset </span><span class="si">{}</span><span class="s2"> </span><span class="si">% o</span><span class="s2">f the messages is spam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentage_spam_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;In the test dataset 13.2 % of the messages is spam&#39;
</pre></div>
</div>
</div>
</div>
<p>Percentages of spam messages in train en test set are in the same range as the original dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Yep, by the pretty sculpture</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>Yes, princess. Are you going to make me moan?</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>Welp apparently he retired</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>Havent.</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>I forgot 2 ask ü all smth.. There's a card on ...</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ham</td>
      <td>Ok i thk i got it. Then u wan me 2 come now or...</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ham</td>
      <td>I want kfc its Tuesday. Only buy 2 meals ONLY ...</td>
    </tr>
    <tr>
      <td>7</td>
      <td>ham</td>
      <td>No dear i was sleeping :-P</td>
    </tr>
    <tr>
      <td>8</td>
      <td>ham</td>
      <td>Ok pa. Nothing problem:-)</td>
    </tr>
    <tr>
      <td>9</td>
      <td>ham</td>
      <td>Ill be there on  &amp;lt;#&amp;gt;  ok.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="clean-the-dataset">
<h2>Clean the dataset<a class="headerlink" href="#clean-the-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove punctuation</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;\W&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Yep  by the pretty sculpture</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>Yes  princess  Are you going to make me moan</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>Welp apparently he retired</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>Havent</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>I forgot 2 ask ü all smth   There s a card on ...</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ham</td>
      <td>Ok i thk i got it  Then u wan me 2 come now or...</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ham</td>
      <td>I want kfc its Tuesday  Only buy 2 meals ONLY ...</td>
    </tr>
    <tr>
      <td>7</td>
      <td>ham</td>
      <td>No dear i was sleeping   P</td>
    </tr>
    <tr>
      <td>8</td>
      <td>ham</td>
      <td>Ok pa  Nothing problem</td>
    </tr>
    <tr>
      <td>9</td>
      <td>ham</td>
      <td>Ill be there on   lt   gt   ok</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transform every letter in every word to lowercase</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>yep  by the pretty sculpture</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>yes  princess  are you going to make me moan</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>welp apparently he retired</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>havent</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>i forgot 2 ask ü all smth   there s a card on ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a vocabulary for the messages in the training set.</span>
<span class="c1"># The vocabulary should be a Python list containing all the unique words across all messages, </span>
<span class="c1"># where each word is represented as a string.</span>

<span class="c1"># Create a list of words</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">vocabulary</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
        <span class="n">vocabulary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="n">vocabulary</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">))</span>
<span class="n">vocabulary</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;thx&#39;,
 &#39;networking&#39;,
 &#39;0906346330&#39;,
 &#39;ages&#39;,
 &#39;logging&#39;,
 &#39;mutai&#39;,
 &#39;630&#39;,
 &#39;durban&#39;,
 &#39;philosophy&#39;,
 &#39;software&#39;,
 &#39;bid&#39;,
 &#39;vote&#39;,
 &#39;wthout&#39;,
 &#39;simonwatson5120&#39;,
 &#39;gives&#39;,
 &#39;elections&#39;,
 &#39;dooms&#39;,
 &#39;anniversary&#39;,
 &#39;charge&#39;,
 &#39;ros&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create dictionary with number of words in every SMS</span>
<span class="n">word_counts_per_sms</span> <span class="o">=</span> <span class="p">{</span><span class="n">unique_word</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">unique_word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">}</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">sms</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sms</span><span class="p">:</span>
        <span class="n">word_counts_per_sms</span><span class="p">[</span><span class="n">word</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">word_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">word_counts_per_sms</span><span class="p">)</span>
<span class="n">word_counts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>thx</th>
      <th>networking</th>
      <th>0906346330</th>
      <th>ages</th>
      <th>logging</th>
      <th>mutai</th>
      <th>630</th>
      <th>durban</th>
      <th>philosophy</th>
      <th>software</th>
      <th>...</th>
      <th>massages</th>
      <th>sporadically</th>
      <th>brum</th>
      <th>fridge</th>
      <th>docs</th>
      <th>syria</th>
      <th>intrude</th>
      <th>kilos</th>
      <th>drpd</th>
      <th>correction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7783 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">training_set_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">word_counts</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">training_set_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
      <th>thx</th>
      <th>networking</th>
      <th>0906346330</th>
      <th>ages</th>
      <th>logging</th>
      <th>mutai</th>
      <th>630</th>
      <th>durban</th>
      <th>...</th>
      <th>massages</th>
      <th>sporadically</th>
      <th>brum</th>
      <th>fridge</th>
      <th>docs</th>
      <th>syria</th>
      <th>intrude</th>
      <th>kilos</th>
      <th>drpd</th>
      <th>correction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>[yep, by, the, pretty, sculpture]</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>[yes, princess, are, you, going, to, make, me,...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>[welp, apparently, he, retired]</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>[havent]</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>[i, forgot, 2, ask, ü, all, smth, there, s, a,...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7785 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the probabilities P(Spam) and P(Ham)</span>

<span class="c1"># P(Spam) = Label(Spam)/Total </span>

<span class="n">p_spam</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;spam&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">)</span>
<span class="n">p_spam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13458950201884254
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># P(Ham) = Label(Ham)/Total</span>

<span class="n">p_ham</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ham&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">)</span>
<span class="n">p_ham</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8654104979811574
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate N_Spam; total number of words in all spam messages</span>

<span class="n">n_spam</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;spam&#39;</span><span class="p">][</span><span class="s1">&#39;SMS&#39;</span><span class="p">]:</span>
    <span class="n">n_spam</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="n">n_spam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15190
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate N_Ham; total number of words in all ham messages</span>

<span class="n">n_ham</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ham&#39;</span><span class="p">][</span><span class="s1">&#39;SMS&#39;</span><span class="p">]:</span>
    <span class="n">n_ham</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="n">n_ham</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57237
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate N_Vocabulary; Total number of unique words in all messages</span>

<span class="n">n_vocabulary</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">)</span>
<span class="n">n_vocabulary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7783
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In the calculations Laplace smoothing with a value of 1 is used</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the parameters P(wi|Spam) and P(wi|Ham)</span>

<span class="n">p_wi_spam</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">p_wi_ham</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">:</span>
    <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
<span class="n">spam</span> <span class="o">=</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;spam&#39;</span><span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ham&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">:</span>
    <span class="n">n_word_given_spam</span> <span class="o">=</span> <span class="n">spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">p_word_given_spam</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_word_given_spam</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_spam</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">n_vocabulary</span><span class="p">)</span>
    <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_word_given_spam</span>
    
    <span class="n">n_word_given_ham</span> <span class="o">=</span> <span class="n">ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">p_word_given_ham</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_word_given_ham</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_ham</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">n_vocabulary</span><span class="p">)</span>
    <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_word_given_ham</span>
    
<span class="n">p_wi_spam</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;thx&#39;: 4.3529360553693465e-05,
 &#39;networking&#39;: 4.3529360553693465e-05,
 &#39;0906346330&#39;: 8.705872110738693e-05,
 &#39;ages&#39;: 8.705872110738693e-05,
 &#39;logging&#39;: 4.3529360553693465e-05,
 &#39;mutai&#39;: 4.3529360553693465e-05,
 &#39;630&#39;: 4.3529360553693465e-05,
 &#39;durban&#39;: 4.3529360553693465e-05,
 &#39;philosophy&#39;: 4.3529360553693465e-05,
 &#39;software&#39;: 4.3529360553693465e-05,
 &#39;bid&#39;: 0.0003482348844295477,
 &#39;vote&#39;: 8.705872110738693e-05,
 &#39;wthout&#39;: 4.3529360553693465e-05,
 &#39;simonwatson5120&#39;: 8.705872110738693e-05,
 &#39;gives&#39;: 4.3529360553693465e-05,
 &#39;elections&#39;: 4.3529360553693465e-05,
 &#39;dooms&#39;: 4.3529360553693465e-05,
 &#39;anniversary&#39;: 4.3529360553693465e-05,
 &#39;charge&#39;: 0.00039176424498324117,
 &#39;ros&#39;: 4.3529360553693465e-05,
 &#39;srt&#39;: 4.3529360553693465e-05,
 &#39;places&#39;: 4.3529360553693465e-05,
 &#39;brdget&#39;: 4.3529360553693465e-05,
 &#39;str&#39;: 8.705872110738693e-05,
 &#39;gentleman&#39;: 4.3529360553693465e-05,
 &#39;entry&#39;: 0.0008270578505201758,
 &#39;usc&#39;: 4.3529360553693465e-05,
 &#39;portege&#39;: 4.3529360553693465e-05,
 &#39;abroad&#39;: 8.705872110738693e-05,
 &#39;trained&#39;: 8.705872110738693e-05,
 &#39;conacted&#39;: 8.705872110738693e-05,
 &#39;keeping&#39;: 4.3529360553693465e-05,
 &#39;gee&#39;: 4.3529360553693465e-05,
 &#39;difficulties&#39;: 4.3529360553693465e-05,
 &#39;navigate&#39;: 4.3529360553693465e-05,
 &#39;ready&#39;: 0.00021764680276846734,
 &#39;dry&#39;: 4.3529360553693465e-05,
 &#39;practicing&#39;: 4.3529360553693465e-05,
 &#39;cheered&#39;: 4.3529360553693465e-05,
 &#39;noice&#39;: 4.3529360553693465e-05,
 &#39;hearin&#39;: 4.3529360553693465e-05,
 &#39;custom&#39;: 4.3529360553693465e-05,
 &#39;pest&#39;: 4.3529360553693465e-05,
 &#39;being&#39;: 0.00030470552387585427,
 &#39;hack&#39;: 8.705872110738693e-05,
 &#39;starring&#39;: 4.3529360553693465e-05,
 &#39;6hl&#39;: 0.0001305880816610804,
 &#39;goggles&#39;: 4.3529360553693465e-05,
 &#39;945&#39;: 4.3529360553693465e-05,
 &#39;fringe&#39;: 4.3529360553693465e-05,
 &#39;thread&#39;: 4.3529360553693465e-05,
 &#39;removal&#39;: 0.0001305880816610804,
 &#39;thirunelvali&#39;: 4.3529360553693465e-05,
 &#39;spoon&#39;: 4.3529360553693465e-05,
 &#39;pounded&#39;: 4.3529360553693465e-05,
 &#39;08715500022&#39;: 8.705872110738693e-05,
 &#39;coach&#39;: 4.3529360553693465e-05,
 &#39;fr&#39;: 4.3529360553693465e-05,
 &#39;tool&#39;: 4.3529360553693465e-05,
 &#39;bridgwater&#39;: 4.3529360553693465e-05,
 &#39;m263uz&#39;: 0.00017411744221477386,
 &#39;aiyar&#39;: 4.3529360553693465e-05,
 &#39;thinkin&#39;: 4.3529360553693465e-05,
 &#39;related&#39;: 4.3529360553693465e-05,
 &#39;shall&#39;: 4.3529360553693465e-05,
 &#39;12mths&#39;: 0.0001305880816610804,
 &#39;educational&#39;: 4.3529360553693465e-05,
 &#39;ello&#39;: 4.3529360553693465e-05,
 &#39;dict&#39;: 4.3529360553693465e-05,
 &#39;smith&#39;: 8.705872110738693e-05,
 &#39;help08714742804&#39;: 8.705872110738693e-05,
 &#39;test&#39;: 4.3529360553693465e-05,
 &#39;3lp&#39;: 8.705872110738693e-05,
 &#39;dokey&#39;: 4.3529360553693465e-05,
 &#39;the&#39;: 0.006877638967483567,
 &#39;parco&#39;: 4.3529360553693465e-05,
 &#39;08718720201&#39;: 0.0003482348844295477,
 &#39;2bold&#39;: 4.3529360553693465e-05,
 &#39;tears&#39;: 4.3529360553693465e-05,
 &#39;drunk&#39;: 4.3529360553693465e-05,
 &#39;bank&#39;: 0.0001305880816610804,
 &#39;verify&#39;: 0.0001305880816610804,
 &#39;hmv1&#39;: 8.705872110738693e-05,
 &#39;moji&#39;: 4.3529360553693465e-05,
 &#39;westonzoyland&#39;: 4.3529360553693465e-05,
 &#39;arun&#39;: 4.3529360553693465e-05,
 &#39;roomate&#39;: 4.3529360553693465e-05,
 &#39;wiskey&#39;: 4.3529360553693465e-05,
 &#39;coffee&#39;: 4.3529360553693465e-05,
 &#39;li&#39;: 4.3529360553693465e-05,
 &#39;bookedthe&#39;: 4.3529360553693465e-05,
 &#39;1000call&#39;: 8.705872110738693e-05,
 &#39;beneficiary&#39;: 4.3529360553693465e-05,
 &#39;09066368470&#39;: 8.705872110738693e-05,
 &#39;swoop&#39;: 4.3529360553693465e-05,
 &#39;evrey&#39;: 4.3529360553693465e-05,
 &#39;dryer&#39;: 4.3529360553693465e-05,
 &#39;edhae&#39;: 4.3529360553693465e-05,
 &#39;reassurance&#39;: 4.3529360553693465e-05,
 &#39;cardiff&#39;: 4.3529360553693465e-05,
 &#39;09058095107&#39;: 8.705872110738693e-05,
 &#39;india&#39;: 8.705872110738693e-05,
 &#39;lager&#39;: 4.3529360553693465e-05,
 &#39;deciding&#39;: 4.3529360553693465e-05,
 &#39;spoken&#39;: 4.3529360553693465e-05,
 &#39;tea&#39;: 4.3529360553693465e-05,
 &#39;transferred&#39;: 8.705872110738693e-05,
 &#39;indyarocks&#39;: 4.3529360553693465e-05,
 &#39;yowifes&#39;: 4.3529360553693465e-05,
 &#39;smell&#39;: 4.3529360553693465e-05,
 &#39;classes&#39;: 4.3529360553693465e-05,
 &#39;yan&#39;: 4.3529360553693465e-05,
 &#39;1843&#39;: 4.3529360553693465e-05,
 &#39;hey&#39;: 0.00021764680276846734,
 &#39;naughty&#39;: 4.3529360553693465e-05,
 &#39;realize&#39;: 8.705872110738693e-05,
 &#39;that2worzels&#39;: 4.3529360553693465e-05,
 &#39;predicte&#39;: 4.3529360553693465e-05,
 &#39;m26&#39;: 8.705872110738693e-05,
 &#39;moseley&#39;: 4.3529360553693465e-05,
 &#39;doctors&#39;: 4.3529360553693465e-05,
 &#39;bangb&#39;: 8.705872110738693e-05,
 &#39;congratulation&#39;: 4.3529360553693465e-05,
 &#39;url&#39;: 4.3529360553693465e-05,
 &#39;meets&#39;: 4.3529360553693465e-05,
 &#39;tobed&#39;: 4.3529360553693465e-05,
 &#39;getsleep&#39;: 4.3529360553693465e-05,
 &#39;twinks&#39;: 8.705872110738693e-05,
 &#39;brains&#39;: 4.3529360553693465e-05,
 &#39;chart&#39;: 0.0001305880816610804,
 &#39;anyones&#39;: 4.3529360553693465e-05,
 &#39;different&#39;: 4.3529360553693465e-05,
 &#39;lined&#39;: 4.3529360553693465e-05,
 &#39;format&#39;: 8.705872110738693e-05,
 &#39;process&#39;: 4.3529360553693465e-05,
 &#39;suggestions&#39;: 4.3529360553693465e-05,
 &#39;rain&#39;: 4.3529360553693465e-05,
 &#39;lotto&#39;: 4.3529360553693465e-05,
 &#39;hav&#39;: 4.3529360553693465e-05,
 &#39;child&#39;: 8.705872110738693e-05,
 &#39;womdarfull&#39;: 4.3529360553693465e-05,
 &#39;rounder&#39;: 4.3529360553693465e-05,
 &#39;by&#39;: 0.0015235276193792714,
 &#39;studio&#39;: 4.3529360553693465e-05,
 &#39;appear&#39;: 4.3529360553693465e-05,
 &#39;havn&#39;: 4.3529360553693465e-05,
 &#39;stays&#39;: 4.3529360553693465e-05,
 &#39;complementary&#39;: 8.705872110738693e-05,
 &#39;chat&#39;: 0.001871762503808819,
 &#39;afford&#39;: 4.3529360553693465e-05,
 &#39;dudette&#39;: 4.3529360553693465e-05,
 &#39;boatin&#39;: 4.3529360553693465e-05,
 &#39;linerental&#39;: 0.00021764680276846734,
 &#39;etlp&#39;: 8.705872110738693e-05,
 &#39;mitsake&#39;: 4.3529360553693465e-05,
 &#39;concerned&#39;: 4.3529360553693465e-05,
 &#39;action&#39;: 0.00021764680276846734,
 &#39;dot&#39;: 0.0001305880816610804,
 &#39;vodafone&#39;: 0.0002611761633221608,
 &#39;replied&#39;: 8.705872110738693e-05,
 &#39;cramps&#39;: 4.3529360553693465e-05,
 &#39;prakasam&#39;: 4.3529360553693465e-05,
 &#39;sleepingwith&#39;: 8.705872110738693e-05,
 &#39;easy&#39;: 0.00047882296609062813,
 &#39;ill&#39;: 8.705872110738693e-05,
 &#39;holy&#39;: 4.3529360553693465e-05,
 &#39;polyphonic&#39;: 0.0002611761633221608,
 &#39;discussed&#39;: 4.3529360553693465e-05,
 &#39;gautham&#39;: 4.3529360553693465e-05,
 &#39;lv&#39;: 4.3529360553693465e-05,
 &#39;appointment&#39;: 4.3529360553693465e-05,
 &#39;gals&#39;: 4.3529360553693465e-05,
 &#39;txt43&#39;: 8.705872110738693e-05,
 &#39;impressed&#39;: 4.3529360553693465e-05,
 &#39;salesman&#39;: 4.3529360553693465e-05,
 &#39;patients&#39;: 4.3529360553693465e-05,
 &#39;amore&#39;: 4.3529360553693465e-05,
 &#39;leo&#39;: 4.3529360553693465e-05,
 &#39;xxsp&#39;: 8.705872110738693e-05,
 &#39;attention&#39;: 4.3529360553693465e-05,
 &#39;sleeps&#39;: 4.3529360553693465e-05,
 &#39;nigro&#39;: 4.3529360553693465e-05,
 &#39;2nights&#39;: 8.705872110738693e-05,
 &#39;thurs&#39;: 0.0001305880816610804,
 &#39;psychiatrist&#39;: 4.3529360553693465e-05,
 &#39;exposed&#39;: 4.3529360553693465e-05,
 &#39;stalking&#39;: 4.3529360553693465e-05,
 &#39;24th&#39;: 4.3529360553693465e-05,
 &#39;cinema&#39;: 0.00017411744221477386,
 &#39;settings&#39;: 0.0001305880816610804,
 &#39;concentration&#39;: 4.3529360553693465e-05,
 &#39;research&#39;: 4.3529360553693465e-05,
 &#39;fast&#39;: 8.705872110738693e-05,
 &#39;walks&#39;: 4.3529360553693465e-05,
 &#39;smsservices&#39;: 8.705872110738693e-05,
 &#39;coat&#39;: 4.3529360553693465e-05,
 &#39;jocks&#39;: 8.705872110738693e-05,
 &#39;yaxx&#39;: 4.3529360553693465e-05,
 &#39;fixed&#39;: 8.705872110738693e-05,
 &#39;daaaaa&#39;: 4.3529360553693465e-05,
 &#39;sugar&#39;: 4.3529360553693465e-05,
 &#39;lul&#39;: 4.3529360553693465e-05,
 &#39;shop&#39;: 0.00030470552387585427,
 &#39;rental&#39;: 0.00047882296609062813,
 &#39;outsider&#39;: 4.3529360553693465e-05,
 &#39;finishd&#39;: 4.3529360553693465e-05,
 &#39;condition&#39;: 8.705872110738693e-05,
 &#39;mind&#39;: 8.705872110738693e-05,
 &#39;doubt&#39;: 4.3529360553693465e-05,
 &#39;feet&#39;: 4.3529360553693465e-05,
 &#39;notebook&#39;: 4.3529360553693465e-05,
 &#39;barred&#39;: 4.3529360553693465e-05,
 &#39;restaurant&#39;: 4.3529360553693465e-05,
 &#39;birth&#39;: 4.3529360553693465e-05,
 &#39;yummy&#39;: 4.3529360553693465e-05,
 &#39;day&#39;: 0.0008270578505201758,
 &#39;inviting&#39;: 0.00021764680276846734,
 &#39;these&#39;: 0.00021764680276846734,
 &#39;only1more&#39;: 4.3529360553693465e-05,
 &#39;smiled&#39;: 4.3529360553693465e-05,
 &#39;omg&#39;: 4.3529360553693465e-05,
 &#39;didn&#39;: 4.3529360553693465e-05,
 &#39;stopsms&#39;: 0.0001305880816610804,
 &#39;0871750&#39;: 0.0001305880816610804,
 &#39;15&#39;: 4.3529360553693465e-05,
 &#39;irulinae&#39;: 4.3529360553693465e-05,
 &#39;hopeso&#39;: 4.3529360553693465e-05,
 &#39;firefox&#39;: 4.3529360553693465e-05,
 &#39;09099726395&#39;: 8.705872110738693e-05,
 &#39;w&#39;: 0.00017411744221477386,
 &#39;senor&#39;: 4.3529360553693465e-05,
 &#39;lvblefrnd&#39;: 4.3529360553693465e-05,
 &#39;country&#39;: 0.00017411744221477386,
 &#39;celebration&#39;: 4.3529360553693465e-05,
 &#39;musicnews&#39;: 8.705872110738693e-05,
 &#39;sight&#39;: 4.3529360553693465e-05,
 &#39;monoc&#39;: 8.705872110738693e-05,
 &#39;shracomorsglsuplt&#39;: 8.705872110738693e-05,
 &#39;remember&#39;: 4.3529360553693465e-05,
 &#39;chachi&#39;: 4.3529360553693465e-05,
 &#39;champlaxigating&#39;: 4.3529360553693465e-05,
 &#39;wocay&#39;: 4.3529360553693465e-05,
 &#39;btw&#39;: 4.3529360553693465e-05,
 &#39;ls15hb&#39;: 0.0001305880816610804,
 &#39;payback&#39;: 4.3529360553693465e-05,
 &#39;den&#39;: 4.3529360553693465e-05,
 &#39;gud&#39;: 4.3529360553693465e-05,
 &#39;hont&#39;: 4.3529360553693465e-05,
 &#39;okors&#39;: 4.3529360553693465e-05,
 &#39;quick&#39;: 4.3529360553693465e-05,
 &#39;wishing&#39;: 4.3529360553693465e-05,
 &#39;wld&#39;: 4.3529360553693465e-05,
 &#39;repeating&#39;: 4.3529360553693465e-05,
 &#39;heard&#39;: 0.0001305880816610804,
 &#39;minmobsmorelkpobox177hp51fl&#39;: 0.00017411744221477386,
 &#39;chatlines&#39;: 8.705872110738693e-05,
 &#39;imma&#39;: 4.3529360553693465e-05,
 &#39;vday&#39;: 4.3529360553693465e-05,
 &#39;canada&#39;: 4.3529360553693465e-05,
 &#39;gentle&#39;: 4.3529360553693465e-05,
 &#39;coccooning&#39;: 4.3529360553693465e-05,
 &#39;smiles&#39;: 4.3529360553693465e-05,
 &#39;paid&#39;: 8.705872110738693e-05,
 &#39;suppose&#39;: 4.3529360553693465e-05,
 &#39;fake&#39;: 4.3529360553693465e-05,
 &#39;vijay&#39;: 4.3529360553693465e-05,
 &#39;approaches&#39;: 4.3529360553693465e-05,
 &#39;650&#39;: 4.3529360553693465e-05,
 &#39;seeing&#39;: 4.3529360553693465e-05,
 &#39;increase&#39;: 4.3529360553693465e-05,
 &#39;messaged&#39;: 4.3529360553693465e-05,
 &#39;theater&#39;: 4.3529360553693465e-05,
 &#39;behind&#39;: 4.3529360553693465e-05,
 &#39;08714712412&#39;: 8.705872110738693e-05,
 &#39;broke&#39;: 4.3529360553693465e-05,
 &#39;expensive&#39;: 4.3529360553693465e-05,
 &#39;axis&#39;: 4.3529360553693465e-05,
 &#39;murder&#39;: 4.3529360553693465e-05,
 &#39;today&#39;: 0.0008270578505201758,
 &#39;positive&#39;: 4.3529360553693465e-05,
 &#39;begin&#39;: 8.705872110738693e-05,
 &#39;call09050000327&#39;: 0.0001305880816610804,
 &#39;08718711108&#39;: 8.705872110738693e-05,
 &#39;treacle&#39;: 4.3529360553693465e-05,
 &#39;shivratri&#39;: 4.3529360553693465e-05,
 &#39;subscriptn3gbp&#39;: 8.705872110738693e-05,
 &#39;canal&#39;: 4.3529360553693465e-05,
 &#39;walked&#39;: 4.3529360553693465e-05,
 &#39;shirts&#39;: 4.3529360553693465e-05,
 &#39;ibiza&#39;: 0.00017411744221477386,
 &#39;passable&#39;: 4.3529360553693465e-05,
 &#39;shows&#39;: 0.0010011752927349498,
 &#39;clos1&#39;: 4.3529360553693465e-05,
 &#39;eshxxxxxxxxxxx&#39;: 4.3529360553693465e-05,
 &#39;kuch&#39;: 4.3529360553693465e-05,
 &#39;textbook&#39;: 4.3529360553693465e-05,
 &#39;handset&#39;: 0.00030470552387585427,
 &#39;legitimat&#39;: 8.705872110738693e-05,
 &#39;reverse&#39;: 4.3529360553693465e-05,
 &#39;ts&#39;: 0.0004352936055369347,
 &#39;soz&#39;: 4.3529360553693465e-05,
 &#39;keris&#39;: 4.3529360553693465e-05,
 &#39;miserable&#39;: 4.3529360553693465e-05,
 &#39;jump&#39;: 4.3529360553693465e-05,
 &#39;beth&#39;: 4.3529360553693465e-05,
 &#39;winning&#39;: 4.3529360553693465e-05,
 &#39;april&#39;: 4.3529360553693465e-05,
 &#39;badass&#39;: 8.705872110738693e-05,
 &#39;project&#39;: 4.3529360553693465e-05,
 &#39;byatch&#39;: 4.3529360553693465e-05,
 &#39;self&#39;: 0.0001305880816610804,
 &#39;08081263000&#39;: 8.705872110738693e-05,
 &#39;telugu&#39;: 4.3529360553693465e-05,
 &#39;weekly&#39;: 0.0007835284899664823,
 &#39;polo&#39;: 0.0001305880816610804,
 &#39;painful&#39;: 4.3529360553693465e-05,
 &#39;begging&#39;: 4.3529360553693465e-05,
 &#39;heater&#39;: 4.3529360553693465e-05,
 &#39;mathe&#39;: 4.3529360553693465e-05,
 &#39;asleep&#39;: 4.3529360553693465e-05,
 &#39;theirs&#39;: 8.705872110738693e-05,
 &#39;ttyl&#39;: 4.3529360553693465e-05,
 &#39;advice&#39;: 4.3529360553693465e-05,
 &#39;lipo&#39;: 4.3529360553693465e-05,
 &#39;mum&#39;: 4.3529360553693465e-05,
 &#39;kiefer&#39;: 8.705872110738693e-05,
 &#39;com1win150ppmx3age16subscription&#39;: 8.705872110738693e-05,
 &#39;cbe&#39;: 4.3529360553693465e-05,
 &#39;123&#39;: 8.705872110738693e-05,
 &#39;spiritual&#39;: 4.3529360553693465e-05,
 &#39;items&#39;: 8.705872110738693e-05,
 &#39;spontaneously&#39;: 4.3529360553693465e-05,
 &#39;respond&#39;: 8.705872110738693e-05,
 &#39;white&#39;: 4.3529360553693465e-05,
 &#39;freek&#39;: 4.3529360553693465e-05,
 &#39;shoppin&#39;: 4.3529360553693465e-05,
 &#39;horo&#39;: 0.0001305880816610804,
 &#39;bugis&#39;: 4.3529360553693465e-05,
 &#39;83021&#39;: 8.705872110738693e-05,
 &#39;ffffuuuuuuu&#39;: 4.3529360553693465e-05,
 &#39;callon&#39;: 4.3529360553693465e-05,
 &#39;girl&#39;: 0.00017411744221477386,
 &#39;olage&#39;: 4.3529360553693465e-05,
 &#39;26th&#39;: 8.705872110738693e-05,
 &#39;shot&#39;: 8.705872110738693e-05,
 &#39;tahan&#39;: 4.3529360553693465e-05,
 &#39;heehee&#39;: 4.3529360553693465e-05,
 &#39;warning&#39;: 4.3529360553693465e-05,
 &#39;boundaries&#39;: 4.3529360553693465e-05,
 &#39;08709501522&#39;: 8.705872110738693e-05,
 &#39;0089&#39;: 8.705872110738693e-05,
 &#39;itna&#39;: 4.3529360553693465e-05,
 &#39;warner&#39;: 0.0001305880816610804,
 &#39;atrocious&#39;: 4.3529360553693465e-05,
 &#39;gt&#39;: 4.3529360553693465e-05,
 &#39;necessary&#39;: 4.3529360553693465e-05,
 &#39;thousands&#39;: 8.705872110738693e-05,
 &#39;9280114&#39;: 8.705872110738693e-05,
 &#39;jul&#39;: 8.705872110738693e-05,
 &#39;joking&#39;: 4.3529360553693465e-05,
 &#39;determine&#39;: 4.3529360553693465e-05,
 &#39;08000776320&#39;: 0.0001305880816610804,
 &#39;margaret&#39;: 4.3529360553693465e-05,
 &#39;praises&#39;: 4.3529360553693465e-05,
 &#39;reboot&#39;: 4.3529360553693465e-05,
 &#39;420&#39;: 4.3529360553693465e-05,
 &#39;poured&#39;: 4.3529360553693465e-05,
 &#39;skills&#39;: 8.705872110738693e-05,
 &#39;mob&#39;: 0.0009141165716275627,
 &#39;trains&#39;: 4.3529360553693465e-05,
 &#39;throat&#39;: 4.3529360553693465e-05,
 &#39;channel&#39;: 8.705872110738693e-05,
 &#39;4few&#39;: 4.3529360553693465e-05,
 &#39;08718723815&#39;: 8.705872110738693e-05,
 &#39;request&#39;: 4.3529360553693465e-05,
 &#39;spook&#39;: 0.0002611761633221608,
 &#39;put&#39;: 4.3529360553693465e-05,
 &#39;20p&#39;: 0.0004352936055369347,
 &#39;epi&#39;: 4.3529360553693465e-05,
 &#39;drunken&#39;: 4.3529360553693465e-05,
 &#39;games&#39;: 0.000652940408305402,
 &#39;140ppm&#39;: 8.705872110738693e-05,
 &#39;08452810073&#39;: 0.0001305880816610804,
 &#39;08701417012150p&#39;: 0.0001305880816610804,
 &#39;market&#39;: 4.3529360553693465e-05,
 &#39;08718730555&#39;: 8.705872110738693e-05,
 &#39;ishtamayoo&#39;: 4.3529360553693465e-05,
 &#39;regarding&#39;: 4.3529360553693465e-05,
 &#39;teams&#39;: 4.3529360553693465e-05,
 &#39;ripped&#39;: 8.705872110738693e-05,
 &#39;entirely&#39;: 4.3529360553693465e-05,
 &#39;like&#39;: 0.00047882296609062813,
 &#39;esplanade&#39;: 4.3529360553693465e-05,
 &#39;mates&#39;: 0.00047882296609062813,
 &#39;amused&#39;: 4.3529360553693465e-05,
 &#39;lifetime&#39;: 0.0001305880816610804,
 &#39;merely&#39;: 4.3529360553693465e-05,
 &#39;quizzes&#39;: 4.3529360553693465e-05,
 &#39;accidant&#39;: 4.3529360553693465e-05,
 &#39;hr&#39;: 4.3529360553693465e-05,
 &#39;comedy&#39;: 4.3529360553693465e-05,
 &#39;achan&#39;: 4.3529360553693465e-05,
 &#39;tues&#39;: 4.3529360553693465e-05,
 &#39;69669&#39;: 8.705872110738693e-05,
 &#39;sensible&#39;: 4.3529360553693465e-05,
 &#39;mfl&#39;: 8.705872110738693e-05,
 &#39;como&#39;: 4.3529360553693465e-05,
 &#39;chad&#39;: 4.3529360553693465e-05,
 &#39;language&#39;: 4.3529360553693465e-05,
 &#39;lover&#39;: 0.0001305880816610804,
 &#39;jane&#39;: 8.705872110738693e-05,
 &#39;22&#39;: 8.705872110738693e-05,
 &#39;220cm2&#39;: 8.705872110738693e-05,
 &#39;clean&#39;: 4.3529360553693465e-05,
 &#39;number&#39;: 0.0011752927349497236,
 &#39;princes&#39;: 4.3529360553693465e-05,
 &#39;slept&#39;: 4.3529360553693465e-05,
 &#39;bishan&#39;: 4.3529360553693465e-05,
 &#39;treasure&#39;: 4.3529360553693465e-05,
 &#39;1er&#39;: 8.705872110738693e-05,
 &#39;perfume&#39;: 4.3529360553693465e-05,
 &#39;erutupalam&#39;: 4.3529360553693465e-05,
 &#39;propsd&#39;: 4.3529360553693465e-05,
 &#39;exciting&#39;: 0.00021764680276846734,
 &#39;kidding&#39;: 4.3529360553693465e-05,
 &#39;lodge&#39;: 4.3529360553693465e-05,
 &#39;sculpture&#39;: 4.3529360553693465e-05,
 &#39;half&#39;: 0.0005223523266443216,
 &#39;fastest&#39;: 0.0001305880816610804,
 &#39;suitemates&#39;: 4.3529360553693465e-05,
 &#39;mrt&#39;: 4.3529360553693465e-05,
 &#39;camp&#39;: 4.3529360553693465e-05,
 &#39;amount&#39;: 4.3529360553693465e-05,
 &#39;grief&#39;: 4.3529360553693465e-05,
 &#39;lousy&#39;: 4.3529360553693465e-05,
 &#39;may&#39;: 0.0002611761633221608,
 &#39;unni&#39;: 4.3529360553693465e-05,
 &#39;funky&#39;: 8.705872110738693e-05,
 &#39;melnite&#39;: 4.3529360553693465e-05,
 &#39;ava&#39;: 4.3529360553693465e-05,
 &#39;start&#39;: 0.00030470552387585427,
 &#39;privacy&#39;: 8.705872110738693e-05,
 &#39;spring&#39;: 4.3529360553693465e-05,
 &#39;honey&#39;: 4.3529360553693465e-05,
 &#39;08081560665&#39;: 8.705872110738693e-05,
 &#39;habit&#39;: 4.3529360553693465e-05,
 &#39;term&#39;: 8.705872110738693e-05,
 &#39;ceiling&#39;: 4.3529360553693465e-05,
 &#39;rcb&#39;: 4.3529360553693465e-05,
 &#39;f&#39;: 0.0004352936055369347,
 &#39;tocall&#39;: 4.3529360553693465e-05,
 &#39;ke&#39;: 4.3529360553693465e-05,
 &#39;darren&#39;: 4.3529360553693465e-05,
 &#39;were&#39;: 0.00021764680276846734,
 &#39;blah&#39;: 4.3529360553693465e-05,
 &#39;phne&#39;: 4.3529360553693465e-05,
 &#39;6th&#39;: 4.3529360553693465e-05,
 &#39;shes&#39;: 4.3529360553693465e-05,
 &#39;leave&#39;: 8.705872110738693e-05,
 &#39;sun0819&#39;: 8.705872110738693e-05,
 &#39;out&#39;: 0.002176468027684673,
 &#39;finds&#39;: 4.3529360553693465e-05,
 &#39;fools&#39;: 4.3529360553693465e-05,
 &#39;whens&#39;: 4.3529360553693465e-05,
 &#39;vivek&#39;: 4.3529360553693465e-05,
 &#39;sos&#39;: 4.3529360553693465e-05,
 &#39;shitinnit&#39;: 4.3529360553693465e-05,
 &#39;orchard&#39;: 4.3529360553693465e-05,
 &#39;faber&#39;: 4.3529360553693465e-05,
 &#39;browse&#39;: 8.705872110738693e-05,
 &#39;one&#39;: 0.00030470552387585427,
 &#39;sentiment&#39;: 4.3529360553693465e-05,
 &#39;treatin&#39;: 4.3529360553693465e-05,
 &#39;preferably&#39;: 4.3529360553693465e-05,
 &#39;boys&#39;: 0.0001305880816610804,
 &#39;idps&#39;: 4.3529360553693465e-05,
 &#39;matched&#39;: 8.705872110738693e-05,
 &#39;gayle&#39;: 4.3529360553693465e-05,
 &#39;daddy&#39;: 4.3529360553693465e-05,
 &#39;piss&#39;: 4.3529360553693465e-05,
 &#39;onwards&#39;: 4.3529360553693465e-05,
 &#39;okmail&#39;: 8.705872110738693e-05,
 &#39;burnt&#39;: 4.3529360553693465e-05,
 &#39;crave&#39;: 4.3529360553693465e-05,
 &#39;wither&#39;: 8.705872110738693e-05,
 &#39;bslvyl&#39;: 4.3529360553693465e-05,
 &#39;chocolate&#39;: 4.3529360553693465e-05,
 &#39;0578&#39;: 0.0001305880816610804,
 &#39;tue&#39;: 4.3529360553693465e-05,
 &#39;would&#39;: 0.00021764680276846734,
 &#39;weiyi&#39;: 4.3529360553693465e-05,
 &#39;087123002209am&#39;: 8.705872110738693e-05,
 &#39;president&#39;: 8.705872110738693e-05,
 &#39;prin&#39;: 4.3529360553693465e-05,
 &#39;24&#39;: 0.00021764680276846734,
 &#39;need&#39;: 0.00030470552387585427,
 &#39;raglan&#39;: 4.3529360553693465e-05,
 &#39;covers&#39;: 4.3529360553693465e-05,
 &#39;boo&#39;: 4.3529360553693465e-05,
 &#39;lick&#39;: 4.3529360553693465e-05,
 &#39;08714712388&#39;: 8.705872110738693e-05,
 &#39;mm&#39;: 4.3529360553693465e-05,
 &#39;steyn&#39;: 4.3529360553693465e-05,
 &#39;41782&#39;: 8.705872110738693e-05,
 &#39;decision&#39;: 4.3529360553693465e-05,
 &#39;tag&#39;: 4.3529360553693465e-05,
 &#39;harish&#39;: 4.3529360553693465e-05,
 &#39;cc100p&#39;: 8.705872110738693e-05,
 &#39;1thing&#39;: 4.3529360553693465e-05,
 &#39;200&#39;: 0.0004352936055369347,
 &#39;less&#39;: 4.3529360553693465e-05,
 &#39;simply&#39;: 0.0001305880816610804,
 &#39;honest&#39;: 4.3529360553693465e-05,
 &#39;amma&#39;: 4.3529360553693465e-05,
 &#39;com1win150ppmx3age16&#39;: 0.00017411744221477386,
 &#39;lot&#39;: 4.3529360553693465e-05,
 &#39;fainting&#39;: 4.3529360553693465e-05,
 &#39;accident&#39;: 0.0001305880816610804,
 &#39;mtmsg&#39;: 8.705872110738693e-05,
 &#39;reasonable&#39;: 4.3529360553693465e-05,
 &#39;avenge&#39;: 4.3529360553693465e-05,
 &#39;wikipedia&#39;: 4.3529360553693465e-05,
 &#39;priscilla&#39;: 4.3529360553693465e-05,
 &#39;perumbavoor&#39;: 4.3529360553693465e-05,
 &#39;liked&#39;: 4.3529360553693465e-05,
 &#39;members&#39;: 0.0001305880816610804,
 &#39;lac&#39;: 4.3529360553693465e-05,
 &#39;unable&#39;: 0.0001305880816610804,
 &#39;1225&#39;: 8.705872110738693e-05,
 &#39;sack&#39;: 4.3529360553693465e-05,
 &#39;prices&#39;: 4.3529360553693465e-05,
 &#39;harry&#39;: 0.0001305880816610804,
 &#39;sure&#39;: 4.3529360553693465e-05,
 &#39;ignore&#39;: 8.705872110738693e-05,
 &#39;report&#39;: 4.3529360553693465e-05,
 &#39;hurricanes&#39;: 4.3529360553693465e-05,
 &#39;prepared&#39;: 4.3529360553693465e-05,
 &#39;howu&#39;: 4.3529360553693465e-05,
 &#39;bedbut&#39;: 4.3529360553693465e-05,
 &#39;electricity&#39;: 4.3529360553693465e-05,
 &#39;lttrs&#39;: 4.3529360553693465e-05,
 &#39;izzit&#39;: 4.3529360553693465e-05,
 &#39;beerage&#39;: 4.3529360553693465e-05,
 &#39;ovulate&#39;: 4.3529360553693465e-05,
 &#39;bless&#39;: 4.3529360553693465e-05,
 &#39;jas&#39;: 4.3529360553693465e-05,
 &#39;accommodation&#39;: 8.705872110738693e-05,
 &#39;apples&#39;: 4.3529360553693465e-05,
 &#39;token&#39;: 4.3529360553693465e-05,
 &#39;150&#39;: 0.0006094110477517085,
 &#39;wk&#39;: 0.0011752927349497236,
 &#39;woodland&#39;: 4.3529360553693465e-05,
 &#39;edrunk&#39;: 4.3529360553693465e-05,
 &#39;skateboarding&#39;: 4.3529360553693465e-05,
 &#39;sisters&#39;: 4.3529360553693465e-05,
 &#39;dinner&#39;: 4.3529360553693465e-05,
 &#39;argentina&#39;: 4.3529360553693465e-05,
 &#39;yifeng&#39;: 4.3529360553693465e-05,
 &#39;i&#39;: 0.002219997388238367,
 &#39;buying&#39;: 4.3529360553693465e-05,
 &#39;bunkers&#39;: 4.3529360553693465e-05,
 &#39;lets&#39;: 8.705872110738693e-05,
 &#39;0870241182716&#39;: 8.705872110738693e-05,
 &#39;myself&#39;: 4.3529360553693465e-05,
 &#39;fab&#39;: 4.3529360553693465e-05,
 &#39;ayn&#39;: 4.3529360553693465e-05,
 &#39;thesedays&#39;: 4.3529360553693465e-05,
 &#39;every&#39;: 0.0011752927349497236,
 &#39;cnl&#39;: 8.705872110738693e-05,
 &#39;shag&#39;: 8.705872110738693e-05,
 &#39;pizza&#39;: 4.3529360553693465e-05,
 &#39;grand&#39;: 4.3529360553693465e-05,
 &#39;08712300220&#39;: 0.0002611761633221608,
 &#39;sullivan&#39;: 8.705872110738693e-05,
 &#39;62468&#39;: 0.0002611761633221608,
 &#39;web2mobile&#39;: 8.705872110738693e-05,
 &#39;373&#39;: 0.0001305880816610804,
 &#39;08719181503&#39;: 8.705872110738693e-05,
 &#39;presents&#39;: 4.3529360553693465e-05,
 &#39;aom&#39;: 0.0001305880816610804,
 &#39;darlin&#39;: 4.3529360553693465e-05,
 &#39;100percent&#39;: 0.0001305880816610804,
 &#39;forgotten&#39;: 4.3529360553693465e-05,
 &#39;449050000301&#39;: 8.705872110738693e-05,
 &#39;college&#39;: 4.3529360553693465e-05,
 &#39;weasels&#39;: 4.3529360553693465e-05,
 &#39;tsandcs&#39;: 0.0001305880816610804,
 &#39;skins&#39;: 8.705872110738693e-05,
 &#39;next&#39;: 0.000565881687198015,
 &#39;mac&#39;: 4.3529360553693465e-05,
 &#39;dat&#39;: 4.3529360553693465e-05,
 &#39;die&#39;: 4.3529360553693465e-05,
 &#39;allowed&#39;: 4.3529360553693465e-05,
 &#39;use&#39;: 0.00030470552387585427,
 &#39;02073162414&#39;: 0.0001305880816610804,
 &#39;breaking&#39;: 4.3529360553693465e-05,
 &#39;hi&#39;: 0.0006964697688590954,
 &#39;eh74rr&#39;: 8.705872110738693e-05,
 &#39;pure&#39;: 4.3529360553693465e-05,
 &#39;08708800282&#39;: 8.705872110738693e-05,
 &#39;bought&#39;: 8.705872110738693e-05,
 &#39;much&#39;: 8.705872110738693e-05,
 &#39;japanese&#39;: 4.3529360553693465e-05,
 &#39;auntie&#39;: 4.3529360553693465e-05,
 &#39;categories&#39;: 4.3529360553693465e-05,
 &#39;decimal&#39;: 4.3529360553693465e-05,
 &#39;trivia&#39;: 8.705872110738693e-05,
 &#39;sathy&#39;: 4.3529360553693465e-05,
 &#39;30th&#39;: 8.705872110738693e-05,
 &#39;foley&#39;: 0.0001305880816610804,
 &#39;smokes&#39;: 4.3529360553693465e-05,
 &#39;name&#39;: 0.00047882296609062813,
 &#39;kip&#39;: 4.3529360553693465e-05,
 &#39;nauseous&#39;: 4.3529360553693465e-05,
 &#39;bang&#39;: 4.3529360553693465e-05,
 &#39;ooooooh&#39;: 4.3529360553693465e-05,
 &#39;hypotheticalhuagauahahuagahyuhagga&#39;: 4.3529360553693465e-05,
 &#39;bristol&#39;: 4.3529360553693465e-05,
 &#39;adventuring&#39;: 4.3529360553693465e-05,
 &#39;old&#39;: 0.0001305880816610804,
 &#39;deepak&#39;: 4.3529360553693465e-05,
 &#39;bar&#39;: 4.3529360553693465e-05,
 &#39;ctagg&#39;: 4.3529360553693465e-05,
 &#39;for&#39;: 0.006703521525268794,
 &#39;09050001295&#39;: 8.705872110738693e-05,
 &#39;inst&#39;: 4.3529360553693465e-05,
 &#39;craziest&#39;: 4.3529360553693465e-05,
 &#39;useful&#39;: 4.3529360553693465e-05,
 &#39;message&#39;: 0.001305880816610804,
 &#39;they&#39;: 0.000565881687198015,
 &#39;beers&#39;: 4.3529360553693465e-05,
 &#39;program&#39;: 4.3529360553693465e-05,
 &#39;dubsack&#39;: 4.3529360553693465e-05,
 &#39;barrel&#39;: 4.3529360553693465e-05,
 &#39;panasonic&#39;: 8.705872110738693e-05,
 &#39;box&#39;: 0.001218822095503417,
 &#39;starwars3&#39;: 0.00017411744221477386,
 &#39;hopefully&#39;: 4.3529360553693465e-05,
 &#39;dialogue&#39;: 4.3529360553693465e-05,
 &#39;yuo&#39;: 4.3529360553693465e-05,
 &#39;captain&#39;: 4.3529360553693465e-05,
 &#39;diwali&#39;: 4.3529360553693465e-05,
 &#39;fromwrk&#39;: 4.3529360553693465e-05,
 &#39;sound&#39;: 4.3529360553693465e-05,
 &#39;pix&#39;: 0.00017411744221477386,
 &#39;amongst&#39;: 4.3529360553693465e-05,
 &#39;blimey&#39;: 4.3529360553693465e-05,
 &#39;lifted&#39;: 4.3529360553693465e-05,
 &#39;hu&#39;: 4.3529360553693465e-05,
 &#39;unless&#39;: 4.3529360553693465e-05,
 &#39;hf8&#39;: 8.705872110738693e-05,
 &#39;til&#39;: 4.3529360553693465e-05,
 &#39;wc1n&#39;: 8.705872110738693e-05,
 &#39;msging&#39;: 4.3529360553693465e-05,
 &#39;grinder&#39;: 4.3529360553693465e-05,
 &#39;starshine&#39;: 4.3529360553693465e-05,
 &#39;scraped&#39;: 4.3529360553693465e-05,
 &#39;6230&#39;: 8.705872110738693e-05,
 &#39;drive&#39;: 4.3529360553693465e-05,
 &#39;remind&#39;: 4.3529360553693465e-05,
 &#39;sick&#39;: 4.3529360553693465e-05,
 &#39;yetty&#39;: 4.3529360553693465e-05,
 &#39;pay&#39;: 4.3529360553693465e-05,
 &#39;swalpa&#39;: 4.3529360553693465e-05,
 &#39;refused&#39;: 0.00017411744221477386,
 &#39;applebees&#39;: 4.3529360553693465e-05,
 &#39;50ea&#39;: 8.705872110738693e-05,
 &#39;recorder&#39;: 8.705872110738693e-05,
 &#39;missionary&#39;: 4.3529360553693465e-05,
 &#39;elaborating&#39;: 4.3529360553693465e-05,
 &#39;code&#39;: 0.0010447046532886433,
 &#39;waiting&#39;: 0.000652940408305402,
 &#39;09050000460&#39;: 8.705872110738693e-05,
 &#39;m8&#39;: 8.705872110738693e-05,
 &#39;smoke&#39;: 4.3529360553693465e-05,
 &#39;laughing&#39;: 4.3529360553693465e-05,
 &#39;08000839402&#39;: 0.000565881687198015,
 &#39;booking&#39;: 4.3529360553693465e-05,
 &#39;superior&#39;: 4.3529360553693465e-05,
 &#39;sez&#39;: 4.3529360553693465e-05,
 &#39;operator&#39;: 0.0005223523266443216,
 &#39;pobox36504w45wq&#39;: 0.0002611761633221608,
 &#39;wedlunch&#39;: 4.3529360553693465e-05,
 &#39;wait&#39;: 0.0001305880816610804,
 &#39;9am&#39;: 0.00017411744221477386,
 &#39;dawns&#39;: 4.3529360553693465e-05,
 &#39;lightly&#39;: 4.3529360553693465e-05,
 &#39;ext&#39;: 4.3529360553693465e-05,
 &#39;hanger&#39;: 4.3529360553693465e-05,
 &#39;21870000&#39;: 0.0001305880816610804,
 &#39;kinda&#39;: 4.3529360553693465e-05,
 &#39;exmpel&#39;: 4.3529360553693465e-05,
 &#39;magic&#39;: 4.3529360553693465e-05,
 &#39;pt2&#39;: 0.0001305880816610804,
 &#39;5th&#39;: 4.3529360553693465e-05,
 &#39;s89&#39;: 8.705872110738693e-05,
 &#39;unsub&#39;: 0.00030470552387585427,
 &#39;do&#39;: 0.0010447046532886433,
 &#39;themed&#39;: 4.3529360553693465e-05,
 &#39;coughing&#39;: 4.3529360553693465e-05,
 &#39;dontcha&#39;: 8.705872110738693e-05,
 &#39;owe&#39;: 4.3529360553693465e-05,
 &#39;howard&#39;: 4.3529360553693465e-05,
 &#39;300603t&#39;: 8.705872110738693e-05,
 &#39;yep&#39;: 4.3529360553693465e-05,
 &#39;stuffing&#39;: 4.3529360553693465e-05,
 &#39;been&#39;: 0.0015670569799329647,
 &#39;readiness&#39;: 4.3529360553693465e-05,
 &#39;bcz&#39;: 4.3529360553693465e-05,
 &#39;speed&#39;: 8.705872110738693e-05,
 &#39;manual&#39;: 4.3529360553693465e-05,
 &#39;2i&#39;: 4.3529360553693465e-05,
 &#39;taka&#39;: 4.3529360553693465e-05,
 &#39;bffs&#39;: 4.3529360553693465e-05,
 &#39;loko&#39;: 4.3529360553693465e-05,
 &#39;afew&#39;: 4.3529360553693465e-05,
 &#39;moon&#39;: 0.0001305880816610804,
 &#39;nigeria&#39;: 4.3529360553693465e-05,
 &#39;important&#39;: 0.00047882296609062813,
 &#39;inclusive&#39;: 0.0002611761633221608,
 &#39;09064018838&#39;: 8.705872110738693e-05,
 &#39;suits&#39;: 4.3529360553693465e-05,
 &#39;nytho&#39;: 4.3529360553693465e-05,
 &#39;re&#39;: 0.000652940408305402,
 &#39;09061790125&#39;: 8.705872110738693e-05,
 &#39;30pm&#39;: 4.3529360553693465e-05,
 &#39;careabout&#39;: 4.3529360553693465e-05,
 &#39;08712400603&#39;: 8.705872110738693e-05,
 &#39;sariyag&#39;: 4.3529360553693465e-05,
 &#39;pretend&#39;: 4.3529360553693465e-05,
 &#39;went&#39;: 4.3529360553693465e-05,
 &#39;destiny&#39;: 4.3529360553693465e-05,
 &#39;week&#39;: 0.002045879946023593,
 &#39;09061701851&#39;: 8.705872110738693e-05,
 &#39;box61&#39;: 8.705872110738693e-05,
 &#39;4thnov&#39;: 4.3529360553693465e-05,
 &#39;mack&#39;: 4.3529360553693465e-05,
 &#39;sed&#39;: 8.705872110738693e-05,
 &#39;dependents&#39;: 4.3529360553693465e-05,
 &#39;cro1327&#39;: 8.705872110738693e-05,
 &#39;fine&#39;: 4.3529360553693465e-05,
 &#39;notifications&#39;: 8.705872110738693e-05,
 &#39;bedreal&#39;: 4.3529360553693465e-05,
 &#39;rock&#39;: 4.3529360553693465e-05,
 &#39;kegger&#39;: 4.3529360553693465e-05,
 &#39;via&#39;: 0.0001305880816610804,
 &#39;dave&#39;: 8.705872110738693e-05,
 &#39;40mph&#39;: 4.3529360553693465e-05,
 &#39;soup&#39;: 4.3529360553693465e-05,
 &#39;mahal&#39;: 4.3529360553693465e-05,
 &#39;87575&#39;: 0.00021764680276846734,
 &#39;practising&#39;: 4.3529360553693465e-05,
 &#39;872&#39;: 0.0001305880816610804,
 &#39;formal&#39;: 4.3529360553693465e-05,
 &#39;2&#39;: 0.007225873851913115,
 &#39;buttheres&#39;: 4.3529360553693465e-05,
 &#39;eachother&#39;: 4.3529360553693465e-05,
 &#39;hundred&#39;: 4.3529360553693465e-05,
 &#39;bb&#39;: 4.3529360553693465e-05,
 &#39;exchanged&#39;: 4.3529360553693465e-05,
 &#39;caps&#39;: 4.3529360553693465e-05,
 &#39;89555&#39;: 8.705872110738693e-05,
 &#39;hook&#39;: 4.3529360553693465e-05,
 &#39;truck&#39;: 4.3529360553693465e-05,
 &#39;m221bp&#39;: 0.0001305880816610804,
 &#39;andros&#39;: 4.3529360553693465e-05,
 &#39;massive&#39;: 4.3529360553693465e-05,
 &#39;tessy&#39;: 4.3529360553693465e-05,
 &#39;information&#39;: 0.00030470552387585427,
 &#39;responding&#39;: 8.705872110738693e-05,
 &#39;merry&#39;: 4.3529360553693465e-05,
 &#39;marketing&#39;: 8.705872110738693e-05,
 &#39;birthday&#39;: 8.705872110738693e-05,
 &#39;listener&#39;: 4.3529360553693465e-05,
 &#39;continued&#39;: 8.705872110738693e-05,
 &#39;07123456789&#39;: 0.0001305880816610804,
 &#39;breathing&#39;: 4.3529360553693465e-05,
 &#39;contains&#39;: 4.3529360553693465e-05,
 &#39;dramatic&#39;: 4.3529360553693465e-05,
 &#39;include&#39;: 8.705872110738693e-05,
 &#39;neighbors&#39;: 4.3529360553693465e-05,
 &#39;luckily&#39;: 4.3529360553693465e-05,
 &#39;occasion&#39;: 4.3529360553693465e-05,
 &#39;pleasant&#39;: 4.3529360553693465e-05,
 &#39;42478&#39;: 8.705872110738693e-05,
 &#39;px3748&#39;: 4.3529360553693465e-05,
 &#39;punish&#39;: 4.3529360553693465e-05,
 &#39;telephone&#39;: 8.705872110738693e-05,
 &#39;cer&#39;: 4.3529360553693465e-05,
 &#39;restrictions&#39;: 8.705872110738693e-05,
 &#39;j&#39;: 4.3529360553693465e-05,
 &#39;scrappy&#39;: 4.3529360553693465e-05,
 &#39;yorge&#39;: 4.3529360553693465e-05,
 &#39;caroline&#39;: 4.3529360553693465e-05,
 &#39;hype&#39;: 4.3529360553693465e-05,
 &#39;pudunga&#39;: 4.3529360553693465e-05,
 &#39;clarify&#39;: 4.3529360553693465e-05,
 &#39;professional&#39;: 8.705872110738693e-05,
 &#39;bailiff&#39;: 8.705872110738693e-05,
 &#39;thia&#39;: 4.3529360553693465e-05,
 &#39;any&#39;: 0.0010011752927349498,
 &#39;mei&#39;: 4.3529360553693465e-05,
 &#39;4got&#39;: 4.3529360553693465e-05,
 &#39;collection&#39;: 0.0009141165716275627,
 &#39;cappuccino&#39;: 4.3529360553693465e-05,
 &#39;scorable&#39;: 4.3529360553693465e-05,
 &#39;restrict&#39;: 4.3529360553693465e-05,
 &#39;tagged&#39;: 4.3529360553693465e-05,
 &#39;lmao&#39;: 4.3529360553693465e-05,
 &#39;swimsuit&#39;: 4.3529360553693465e-05,
 &#39;48&#39;: 4.3529360553693465e-05,
 &#39;asthma&#39;: 4.3529360553693465e-05,
 &#39;subpoly&#39;: 0.00017411744221477386,
 &#39;opinion&#39;: 4.3529360553693465e-05,
 &#39;please&#39;: 0.0019152918643625125,
 &#39;completely&#39;: 8.705872110738693e-05,
 &#39;cdgt&#39;: 0.0001305880816610804,
 &#39;suite342&#39;: 0.0006094110477517085,
 &#39;wildlife&#39;: 4.3529360553693465e-05,
 &#39;info&#39;: 0.0004352936055369347,
 &#39;mb&#39;: 4.3529360553693465e-05,
 &#39;detroit&#39;: 8.705872110738693e-05,
 &#39;pansy&#39;: 4.3529360553693465e-05,
 &#39;09064012160&#39;: 8.705872110738693e-05,
 &#39;beg&#39;: 4.3529360553693465e-05,
 &#39;box39822&#39;: 0.00021764680276846734,
 &#39;bitching&#39;: 4.3529360553693465e-05,
 &#39;mojibiola&#39;: 4.3529360553693465e-05,
 &#39;hip&#39;: 4.3529360553693465e-05,
 &#39;hw&#39;: 4.3529360553693465e-05,
 &#39;nursery&#39;: 4.3529360553693465e-05,
 &#39;squishy&#39;: 4.3529360553693465e-05,
 &#39;bids&#39;: 8.705872110738693e-05,
 &#39;folks&#39;: 8.705872110738693e-05,
 &#39;peaceful&#39;: 4.3529360553693465e-05,
 &#39;phews&#39;: 4.3529360553693465e-05,
 &#39;payee&#39;: 4.3529360553693465e-05,
 &#39;meanwhile&#39;: 4.3529360553693465e-05,
 &#39;afterwards&#39;: 4.3529360553693465e-05,
 &#39;buzz&#39;: 4.3529360553693465e-05,
 &#39;evr&#39;: 4.3529360553693465e-05,
 &#39;apart&#39;: 4.3529360553693465e-05,
 &#39;82468&#39;: 8.705872110738693e-05,
 &#39;per&#39;: 0.0017411744221477387,
 &#39;sachin&#39;: 4.3529360553693465e-05,
 &#39;pract&#39;: 4.3529360553693465e-05,
 &#39;show&#39;: 0.00017411744221477386,
 &#39;replys150&#39;: 8.705872110738693e-05,
 &#39;31&#39;: 0.0001305880816610804,
 &#39;goodies&#39;: 8.705872110738693e-05,
 &#39;hols&#39;: 0.0001305880816610804,
 &#39;watchin&#39;: 4.3529360553693465e-05,
 &#39;somebody&#39;: 8.705872110738693e-05,
 &#39;bad&#39;: 8.705872110738693e-05,
 &#39;08717205546&#39;: 8.705872110738693e-05,
 &#39;sweetheart&#39;: 4.3529360553693465e-05,
 &#39;ifink&#39;: 4.3529360553693465e-05,
 &#39;engagement&#39;: 4.3529360553693465e-05,
 &#39;digi&#39;: 4.3529360553693465e-05,
 &#39;competition&#39;: 0.0001305880816610804,
 &#39;brothers&#39;: 4.3529360553693465e-05,
 &#39;location&#39;: 4.3529360553693465e-05,
 &#39;pain&#39;: 4.3529360553693465e-05,
 &#39;mint&#39;: 4.3529360553693465e-05,
 &#39;mwahs&#39;: 4.3529360553693465e-05,
 &#39;dropped&#39;: 4.3529360553693465e-05,
 &#39;real&#39;: 0.0005223523266443216,
 &#39;land&#39;: 0.0006964697688590954,
 &#39;faggy&#39;: 4.3529360553693465e-05,
 &#39;innocent&#39;: 4.3529360553693465e-05,
 &#39;4brekkie&#39;: 4.3529360553693465e-05,
 &#39;gloucesterroad&#39;: 4.3529360553693465e-05,
 &#39;bowa&#39;: 4.3529360553693465e-05,
 &#39;reserved&#39;: 4.3529360553693465e-05,
 &#39;plan&#39;: 4.3529360553693465e-05,
 &#39;choice&#39;: 0.00017411744221477386,
 &#39;49557&#39;: 8.705872110738693e-05,
 &#39;doggy&#39;: 4.3529360553693465e-05,
 &#39;fond&#39;: 4.3529360553693465e-05,
 &#39;cheap&#39;: 0.00021764680276846734,
 &#39;5free&#39;: 0.0001305880816610804,
 &#39;acting&#39;: 4.3529360553693465e-05,
 &#39;possessiveness&#39;: 4.3529360553693465e-05,
 &#39;lab&#39;: 4.3529360553693465e-05,
 &#39;complexities&#39;: 4.3529360553693465e-05,
 &#39;costumes&#39;: 4.3529360553693465e-05,
 &#39;foot&#39;: 4.3529360553693465e-05,
 &#39;watchng&#39;: 4.3529360553693465e-05,
 &#39;newsletter&#39;: 8.705872110738693e-05,
 &#39;credited&#39;: 4.3529360553693465e-05,
 &#39;fucks&#39;: 4.3529360553693465e-05,
 &#39;happenin&#39;: 4.3529360553693465e-05,
 &#39;goals&#39;: 0.0001305880816610804,
 &#39;hooked&#39;: 4.3529360553693465e-05,
 &#39;page&#39;: 8.705872110738693e-05,
 &#39;haunt&#39;: 4.3529360553693465e-05,
 &#39;reaching&#39;: 4.3529360553693465e-05,
 &#39;pert&#39;: 4.3529360553693465e-05,
 &#39;into&#39;: 0.00021764680276846734,
 &#39;snake&#39;: 4.3529360553693465e-05,
 &#39;cnn&#39;: 4.3529360553693465e-05,
 &#39;robs&#39;: 4.3529360553693465e-05,
 &#39;woould&#39;: 4.3529360553693465e-05,
 &#39;lik&#39;: 4.3529360553693465e-05,
 &#39;prakasamanu&#39;: 4.3529360553693465e-05,
 &#39;making&#39;: 4.3529360553693465e-05,
 &#39;09066358152&#39;: 0.0001305880816610804,
 &#39;2morro&#39;: 8.705872110738693e-05,
 &#39;garden&#39;: 8.705872110738693e-05,
 &#39;pete&#39;: 8.705872110738693e-05,
 &#39;eastenders&#39;: 0.0001305880816610804,
 &#39;triple&#39;: 8.705872110738693e-05,
 &#39;days&#39;: 0.00047882296609062813,
 &#39;regards&#39;: 4.3529360553693465e-05,
 &#39;colleagues&#39;: 4.3529360553693465e-05,
 &#39;hamster&#39;: 4.3529360553693465e-05,
 &#39;valid12hrs&#39;: 0.0001305880816610804,
 &#39;8am&#39;: 4.3529360553693465e-05,
 &#39;sayhey&#39;: 4.3529360553693465e-05,
 &#39;2go&#39;: 4.3529360553693465e-05,
 &#39;c&#39;: 0.0017847037827014322,
 &#39;entertain&#39;: 4.3529360553693465e-05,
 &#39;touch&#39;: 8.705872110738693e-05,
 &#39;09058099801&#39;: 8.705872110738693e-05,
 &#39;sexy&#39;: 0.0006094110477517085,
 &#39;catch&#39;: 4.3529360553693465e-05,
 &#39;sliding&#39;: 4.3529360553693465e-05,
 &#39;huiming&#39;: 4.3529360553693465e-05,
 &#39;quite&#39;: 4.3529360553693465e-05,
 &#39;nange&#39;: 4.3529360553693465e-05,
 &#39;chgs&#39;: 8.705872110738693e-05,
 &#39;tight&#39;: 4.3529360553693465e-05,
 &#39;cha&#39;: 0.0001305880816610804,
 &#39;dec&#39;: 4.3529360553693465e-05,
 &#39;jaykwon&#39;: 4.3529360553693465e-05,
 &#39;basically&#39;: 4.3529360553693465e-05,
 &#39;75&#39;: 0.0001305880816610804,
 &#39;piggy&#39;: 4.3529360553693465e-05,
 &#39;weeks&#39;: 0.00030470552387585427,
 &#39;é&#39;: 4.3529360553693465e-05,
 &#39;aunt&#39;: 4.3529360553693465e-05,
 &#39;aids&#39;: 4.3529360553693465e-05,
 &#39;okies&#39;: 4.3529360553693465e-05,
 &#39;granted&#39;: 4.3529360553693465e-05,
 &#39;09061701444&#39;: 8.705872110738693e-05,
 &#39;children&#39;: 0.0001305880816610804,
 &#39;w8in&#39;: 8.705872110738693e-05,
 &#39;natalie2k9&#39;: 8.705872110738693e-05,
 &#39;hiding&#39;: 4.3529360553693465e-05,
 &#39;seriously&#39;: 4.3529360553693465e-05,
 &#39;slo&#39;: 0.0001305880816610804,
 &#39;0870753331018&#39;: 8.705872110738693e-05,
 &#39;invite&#39;: 4.3529360553693465e-05,
 &#39;toclaim&#39;: 0.00030470552387585427,
 &#39;eppolum&#39;: 4.3529360553693465e-05,
 &#39;personal&#39;: 0.0001305880816610804,
 &#39;newport&#39;: 4.3529360553693465e-05,
 &#39;holiday&#39;: 0.0010447046532886433,
 &#39;settling&#39;: 4.3529360553693465e-05,
 &#39;wise&#39;: 4.3529360553693465e-05,
 &#39;silly&#39;: 4.3529360553693465e-05,
 &#39;singing&#39;: 4.3529360553693465e-05,
 &#39;queen&#39;: 4.3529360553693465e-05,
 &#39;delete&#39;: 4.3529360553693465e-05,
 &#39;kitty&#39;: 4.3529360553693465e-05,
 &#39;console&#39;: 8.705872110738693e-05,
 &#39;subscribe&#39;: 8.705872110738693e-05,
 &#39;spacebucks&#39;: 4.3529360553693465e-05,
 &#39;interflora&#39;: 0.0001305880816610804,
 &#39;workin&#39;: 4.3529360553693465e-05,
 &#39;defeat&#39;: 4.3529360553693465e-05,
 &#39;try&#39;: 0.00030470552387585427,
 &#39;caring&#39;: 4.3529360553693465e-05,
 &#39;edu&#39;: 4.3529360553693465e-05,
 &#39;xmas&#39;: 0.000652940408305402,
 &#39;vipclub4u&#39;: 8.705872110738693e-05,
 &#39;vijaykanth&#39;: 4.3529360553693465e-05,
 &#39;malarky&#39;: 4.3529360553693465e-05,
 &#39;dieting&#39;: 4.3529360553693465e-05,
 &#39;weird&#39;: 4.3529360553693465e-05,
 &#39;gnt&#39;: 4.3529360553693465e-05,
 &#39;g&#39;: 0.0003482348844295477,
 &#39;3days&#39;: 4.3529360553693465e-05,
 &#39;login&#39;: 0.0002611761633221608,
 &#39;dreams&#39;: 4.3529360553693465e-05,
 &#39;dirtiest&#39;: 8.705872110738693e-05,
 &#39;bear&#39;: 4.3529360553693465e-05,
 &#39;dont&#39;: 0.00039176424498324117,
 &#39;require&#39;: 4.3529360553693465e-05,
 &#39;voda&#39;: 0.00021764680276846734,
 &#39;compliments&#39;: 4.3529360553693465e-05,
 &#39;pears&#39;: 4.3529360553693465e-05,
 &#39;indeed&#39;: 4.3529360553693465e-05,
 &#39;licks&#39;: 4.3529360553693465e-05,
 &#39;wendy&#39;: 4.3529360553693465e-05,
 &#39;fm&#39;: 8.705872110738693e-05,
 &#39;machi&#39;: 4.3529360553693465e-05,
 &#39;evrydy&#39;: 4.3529360553693465e-05,
 &#39;prem&#39;: 8.705872110738693e-05,
 &#39;h&#39;: 4.3529360553693465e-05,
 ...}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to be used as spam filter</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>

    <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\W&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="n">p_spam_given_message</span> <span class="o">=</span> <span class="n">p_spam</span>
    <span class="n">p_ham_given_message</span> <span class="o">=</span> <span class="n">p_ham</span>
    
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_spam</span><span class="p">:</span>
            <span class="n">p_spam_given_message</span> <span class="o">*=</span> <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_ham</span><span class="p">:</span>
            <span class="n">p_ham_given_message</span> <span class="o">*=</span> <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(Spam|message):&#39;</span><span class="p">,</span> <span class="n">p_spam_given_message</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(Ham|message):&#39;</span><span class="p">,</span> <span class="n">p_ham_given_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_ham_given_message</span> <span class="o">&gt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Label: Ham&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">p_ham_given_message</span> <span class="o">&lt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Label: Spam&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Equal proabilities, have a human classify this!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classify</span><span class="p">(</span><span class="s1">&#39;WINNER!! This is the secret code to unlock the money: C3421.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(Spam|message): 1.3481290211300841e-25
P(Ham|message): 1.9368049028589875e-27
Label: Spam
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classify</span><span class="p">(</span><span class="s1">&#39;Sounds good, Tom, then see u there&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(Spam|message): 2.4372375665888117e-25
P(Ham|message): 3.687530435009238e-21
Label: Ham
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="test-accuracy">
<h2>Test accuracy<a class="headerlink" href="#test-accuracy" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test the accuracy of the algorithme</span>

<span class="k">def</span> <span class="nf">classify_test_set</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>

    <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\W&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="n">p_spam_given_message</span> <span class="o">=</span> <span class="n">p_spam</span>
    <span class="n">p_ham_given_message</span> <span class="o">=</span> <span class="n">p_ham</span>

    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_spam</span><span class="p">:</span>
            <span class="n">p_spam_given_message</span> <span class="o">*=</span> <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_ham</span><span class="p">:</span>
            <span class="n">p_ham_given_message</span> <span class="o">*=</span> <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">p_ham_given_message</span> <span class="o">&gt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;ham&#39;</span>
    <span class="k">elif</span> <span class="n">p_spam_given_message</span> <span class="o">&gt;</span> <span class="n">p_ham_given_message</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;spam&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;needs human classification&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">classify_test_set</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
      <th>predicted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Later i guess. I needa do mcat study too.</td>
      <td>ham</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>But i haf enuff space got like 4 mb...</td>
      <td>ham</td>
    </tr>
    <tr>
      <td>2</td>
      <td>spam</td>
      <td>Had your mobile 10 mths? Update to latest Oran...</td>
      <td>spam</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>All sounds good. Fingers . Makes it difficult ...</td>
      <td>ham</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>All done, all handed in. Don't know if mega sh...</td>
      <td>ham</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Accuracy of the spam filter</span>
<span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]:</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="mi">1</span>
        
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correct:&#39;</span><span class="p">,</span> <span class="n">correct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Incorrect:&#39;</span><span class="p">,</span> <span class="n">total</span> <span class="o">-</span> <span class="n">correct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy:&#39;</span><span class="p">,</span> <span class="n">correct</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Correct: 1100
Incorrect: 14
Accuracy: 0.9874326750448833
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>The accuracy is close to 98.74%, which is really good. Our spam filter looked at 1,114 messages that it hasn’t seen in training, and classified 1,100 correctly.</p>
<p>Next Steps
In this project, we managed to build a spam filter for SMS messages using the multinomial Naive Bayes algorithm. The filter had an accuracy of 98.74% on the test set we used, which is a pretty good result. Our initial goal was an accuracy of over 80%, and we managed to do way better than that.</p>
<p>Next steps include:</p>
<ul class="simple">
<li><p>Analyze the 14 messages that were classified incorrectly and try to figure out why the algorithm classified them incorrectly</p></li>
<li><p>Make the filtering process more complex by making the algorithm sensitive to letter case</p></li>
<li><p>Get the project portfolio-ready by using a few tips from our style guide for data science projects.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="HandwrittenDigitsClassifierUsingCrossValidation.html" title="previous page">Building A Handwritten Digits Classifier using Cross Validation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Arnoud Beerepoot<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>