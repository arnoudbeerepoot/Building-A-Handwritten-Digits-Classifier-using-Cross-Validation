
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Building a Spam Filter with Naive Bayes &#8212; My Jupyter books</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Building A Handwritten Digits Classifier using Cross Validation" href="HandwrittenDigitsClassifierUsingCrossValidation.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">My Jupyter books</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="landing-page.html">
   My Jupyter books
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="HandwrittenDigitsClassifierUsingCrossValidation.html">
   Building A Handwritten Digits Classifier using Cross Validation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Building a Spam Filter with Naive Bayes
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Building a Spam Filter with Naive Bayes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/arnoudbeerepoot/Building-A-Handwritten-Digits-Classifier-using-Cross-Validation"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/arnoudbeerepoot/Building-A-Handwritten-Digits-Classifier-using-Cross-Validation/issues/new?title=Issue%20on%20page%20%2FBuilding a Spam Filter with Naive Bayes.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/arnoudbeerepoot/Building-A-Handwritten-Digits-Classifier-using-Cross-Validation/master?urlpath=tree/Building a Spam Filter with Naive Bayes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-dataset-and-analyze-the-data">
   Import dataset and analyze the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-train-and-test-set">
   Create a train and test set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clean-the-dataset">
   Clean the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-accuracy">
   Test accuracy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="building-a-spam-filter-with-naive-bayes">
<h1>Building a Spam Filter with Naive Bayes<a class="headerlink" href="#building-a-spam-filter-with-naive-bayes" title="Permalink to this headline">¶</a></h1>
<p>In this project a spam filter is built based on the Naive Bayes algorithm. It will be used to classify SMS messages as spam or non-spam. The spam-filter is being trained with a dataset of 5572 SMS messages that are already classified by humans <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/sms+spam+collection">The UCI Machine Learning Repository</a>
See wikipedia for background information <a class="reference external" href="https://en.wikipedia.org/wiki/Naive_Bayes_classifier">Naive Bayes classifier</a></p>
<div class="section" id="import-dataset-and-analyze-the-data">
<h2>Import dataset and analyze the data<a class="headerlink" href="#import-dataset-and-analyze-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;SMSSpamCollection.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">,</span> <span class="s1">&#39;SMS&#39;</span><span class="p">])</span> 
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">7</span><span class="n">d3d6697c850</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;SMSSpamCollection.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">,</span> <span class="s1">&#39;SMS&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pandas&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show the first five rows</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Go until jurong point, crazy.. Available only ...</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>Ok lar... Joking wif u oni...</td>
    </tr>
    <tr>
      <td>2</td>
      <td>spam</td>
      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>U dun say so early hor... U c already then say...</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>Nah I don't think he goes to usf, he lives aro...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># how many spam vs non-spam messages are in the dataset?</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     4825
spam     747
Name: Label, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percentage_spam</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">747</span><span class="o">/</span><span class="p">(</span><span class="mi">4825</span><span class="o">+</span><span class="mi">747</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="s2">&quot;In the dataset </span><span class="si">{}</span><span class="s2"> </span><span class="si">% o</span><span class="s2">f the messages is spam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentage_spam</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;In the dataset 13.4 % of the messages is spam&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-a-train-and-test-set">
<h2>Create a train and test set<a class="headerlink" href="#create-a-train-and-test-set" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Randomize the entire dataset</span>
<span class="n">random</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the randomized dataset in a train and test set</span>
<span class="c1"># 80% is training that is 4458 records</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">random</span><span class="p">[:</span><span class="mi">4458</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">random</span><span class="p">[</span><span class="mi">4458</span><span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4458 entries, 0 to 4457
Data columns (total 2 columns):
Label    4458 non-null object
SMS      4458 non-null object
dtypes: object(2)
memory usage: 69.8+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of ham and spam messages in the train set</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     3858
spam     600
Name: Label, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percentage_spam_train</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">600</span><span class="o">/</span><span class="p">(</span><span class="mi">3858</span><span class="o">+</span><span class="mi">600</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="s2">&quot;In the training dataset </span><span class="si">{}</span><span class="s2"> </span><span class="si">% o</span><span class="s2">f the messages is spam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentage_spam_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;In the training dataset 13.5 % of the messages is spam&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of ham and spam messages in the test set</span>
<span class="n">test</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     967
spam    147
Name: Label, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percentage_spam_test</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">147</span><span class="o">/</span><span class="p">(</span><span class="mi">967</span><span class="o">+</span><span class="mi">147</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="s2">&quot;In the test dataset </span><span class="si">{}</span><span class="s2"> </span><span class="si">% o</span><span class="s2">f the messages is spam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentage_spam_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;In the test dataset 13.2 % of the messages is spam&#39;
</pre></div>
</div>
</div>
</div>
<p>Percentages of spam messages in train en test set are in the same range as the original dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Yep, by the pretty sculpture</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>Yes, princess. Are you going to make me moan?</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>Welp apparently he retired</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>Havent.</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>I forgot 2 ask ü all smth.. There's a card on ...</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ham</td>
      <td>Ok i thk i got it. Then u wan me 2 come now or...</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ham</td>
      <td>I want kfc its Tuesday. Only buy 2 meals ONLY ...</td>
    </tr>
    <tr>
      <td>7</td>
      <td>ham</td>
      <td>No dear i was sleeping :-P</td>
    </tr>
    <tr>
      <td>8</td>
      <td>ham</td>
      <td>Ok pa. Nothing problem:-)</td>
    </tr>
    <tr>
      <td>9</td>
      <td>ham</td>
      <td>Ill be there on  &amp;lt;#&amp;gt;  ok.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="clean-the-dataset">
<h2>Clean the dataset<a class="headerlink" href="#clean-the-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove punctuation</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;\W&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Yep  by the pretty sculpture</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>Yes  princess  Are you going to make me moan</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>Welp apparently he retired</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>Havent</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>I forgot 2 ask ü all smth   There s a card on ...</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ham</td>
      <td>Ok i thk i got it  Then u wan me 2 come now or...</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ham</td>
      <td>I want kfc its Tuesday  Only buy 2 meals ONLY ...</td>
    </tr>
    <tr>
      <td>7</td>
      <td>ham</td>
      <td>No dear i was sleeping   P</td>
    </tr>
    <tr>
      <td>8</td>
      <td>ham</td>
      <td>Ok pa  Nothing problem</td>
    </tr>
    <tr>
      <td>9</td>
      <td>ham</td>
      <td>Ill be there on   lt   gt   ok</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transform every letter in every word to lowercase</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>yep  by the pretty sculpture</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>yes  princess  are you going to make me moan</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>welp apparently he retired</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>havent</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>i forgot 2 ask ü all smth   there s a card on ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a vocabulary for the messages in the training set.</span>
<span class="c1"># The vocabulary should be a Python list containing all the unique words across all messages, </span>
<span class="c1"># where each word is represented as a string.</span>

<span class="c1"># Create a list of words</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">vocabulary</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
        <span class="n">vocabulary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="n">vocabulary</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">))</span>
<span class="n">vocabulary</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;rem&#39;,
 &#39;changed&#39;,
 &#39;expert&#39;,
 &#39;14thmarch&#39;,
 &#39;shouldn&#39;,
 &#39;delete&#39;,
 &#39;freely&#39;,
 &#39;womdarfull&#39;,
 &#39;charity&#39;,
 &#39;09050001808&#39;,
 &#39;winner&#39;,
 &#39;hme&#39;,
 &#39;found&#39;,
 &#39;egg&#39;,
 &#39;turkeys&#39;,
 &#39;jd&#39;,
 &#39;weed&#39;,
 &#39;dudette&#39;,
 &#39;25&#39;,
 &#39;fiting&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create dictionary with number of words in every SMS</span>
<span class="n">word_counts_per_sms</span> <span class="o">=</span> <span class="p">{</span><span class="n">unique_word</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">unique_word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">}</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">sms</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sms</span><span class="p">:</span>
        <span class="n">word_counts_per_sms</span><span class="p">[</span><span class="n">word</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">word_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">word_counts_per_sms</span><span class="p">)</span>
<span class="n">word_counts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rem</th>
      <th>changed</th>
      <th>expert</th>
      <th>14thmarch</th>
      <th>shouldn</th>
      <th>delete</th>
      <th>freely</th>
      <th>womdarfull</th>
      <th>charity</th>
      <th>09050001808</th>
      <th>...</th>
      <th>redeemed</th>
      <th>implications</th>
      <th>avoiding</th>
      <th>decide</th>
      <th>stressed</th>
      <th>breather</th>
      <th>habba</th>
      <th>dane</th>
      <th>x</th>
      <th>wana</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7783 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">training_set_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">word_counts</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">training_set_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
      <th>rem</th>
      <th>changed</th>
      <th>expert</th>
      <th>14thmarch</th>
      <th>shouldn</th>
      <th>delete</th>
      <th>freely</th>
      <th>womdarfull</th>
      <th>...</th>
      <th>redeemed</th>
      <th>implications</th>
      <th>avoiding</th>
      <th>decide</th>
      <th>stressed</th>
      <th>breather</th>
      <th>habba</th>
      <th>dane</th>
      <th>x</th>
      <th>wana</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>[yep, by, the, pretty, sculpture]</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>[yes, princess, are, you, going, to, make, me,...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>[welp, apparently, he, retired]</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>[havent]</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>[i, forgot, 2, ask, ü, all, smth, there, s, a,...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7785 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the probabilities P(Spam) and P(Ham)</span>

<span class="c1"># P(Spam) = Label(Spam)/Total </span>

<span class="n">p_spam</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;spam&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">)</span>
<span class="n">p_spam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13458950201884254
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># P(Ham) = Label(Ham)/Total</span>

<span class="n">p_ham</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ham&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">)</span>
<span class="n">p_ham</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8654104979811574
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate N_Spam; total number of words in all spam messages</span>

<span class="n">n_spam</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;spam&#39;</span><span class="p">][</span><span class="s1">&#39;SMS&#39;</span><span class="p">]:</span>
    <span class="n">n_spam</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="n">n_spam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15190
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate N_Ham; total number of words in all ham messages</span>

<span class="n">n_ham</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ham&#39;</span><span class="p">][</span><span class="s1">&#39;SMS&#39;</span><span class="p">]:</span>
    <span class="n">n_ham</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="n">n_ham</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57237
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate N_Vocabulary; Total number of unique words in all messages</span>

<span class="n">n_vocabulary</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">)</span>
<span class="n">n_vocabulary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7783
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In the calculations Laplace smoothing with a value of 1 is used</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the parameters P(wi|Spam) and P(wi|Ham)</span>

<span class="n">p_wi_spam</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">p_wi_ham</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">:</span>
    <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
<span class="n">spam</span> <span class="o">=</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;spam&#39;</span><span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ham&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">:</span>
    <span class="n">n_word_given_spam</span> <span class="o">=</span> <span class="n">spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">p_word_given_spam</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_word_given_spam</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_spam</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">n_vocabulary</span><span class="p">)</span>
    <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_word_given_spam</span>
    
    <span class="n">n_word_given_ham</span> <span class="o">=</span> <span class="n">ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">p_word_given_ham</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_word_given_ham</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_ham</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">n_vocabulary</span><span class="p">)</span>
    <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_word_given_ham</span>
    
<span class="n">p_wi_spam</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;rem&#39;: 4.3529360553693465e-05,
 &#39;changed&#39;: 8.705872110738693e-05,
 &#39;expert&#39;: 4.3529360553693465e-05,
 &#39;14thmarch&#39;: 8.705872110738693e-05,
 &#39;shouldn&#39;: 4.3529360553693465e-05,
 &#39;delete&#39;: 4.3529360553693465e-05,
 &#39;freely&#39;: 4.3529360553693465e-05,
 &#39;womdarfull&#39;: 4.3529360553693465e-05,
 &#39;charity&#39;: 0.00030470552387585427,
 &#39;09050001808&#39;: 8.705872110738693e-05,
 &#39;winner&#39;: 0.0006094110477517085,
 &#39;hme&#39;: 4.3529360553693465e-05,
 &#39;found&#39;: 4.3529360553693465e-05,
 &#39;egg&#39;: 4.3529360553693465e-05,
 &#39;turkeys&#39;: 4.3529360553693465e-05,
 &#39;jd&#39;: 4.3529360553693465e-05,
 &#39;weed&#39;: 4.3529360553693465e-05,
 &#39;dudette&#39;: 4.3529360553693465e-05,
 &#39;25&#39;: 0.00017411744221477386,
 &#39;fiting&#39;: 4.3529360553693465e-05,
 &#39;italian&#39;: 4.3529360553693465e-05,
 &#39;punish&#39;: 4.3529360553693465e-05,
 &#39;addie&#39;: 4.3529360553693465e-05,
 &#39;greece&#39;: 4.3529360553693465e-05,
 &#39;merememberin&#39;: 4.3529360553693465e-05,
 &#39;sw73ss&#39;: 0.0001305880816610804,
 &#39;discount&#39;: 0.00039176424498324117,
 &#39;m227xy&#39;: 0.0001305880816610804,
 &#39;networks&#39;: 0.0001305880816610804,
 &#39;cosign&#39;: 4.3529360553693465e-05,
 &#39;se&#39;: 4.3529360553693465e-05,
 &#39;spook&#39;: 0.0002611761633221608,
 &#39;087123002209am&#39;: 8.705872110738693e-05,
 &#39;latr&#39;: 4.3529360553693465e-05,
 &#39;top&#39;: 0.0006094110477517085,
 &#39;banned&#39;: 8.705872110738693e-05,
 &#39;age23&#39;: 0.0001305880816610804,
 &#39;rather&#39;: 4.3529360553693465e-05,
 &#39;operate&#39;: 4.3529360553693465e-05,
 &#39;deliveredtomorrow&#39;: 0.00017411744221477386,
 &#39;idps&#39;: 4.3529360553693465e-05,
 &#39;konw&#39;: 4.3529360553693465e-05,
 &#39;maruti&#39;: 4.3529360553693465e-05,
 &#39;who&#39;: 0.0017411744221477387,
 &#39;unfolds&#39;: 4.3529360553693465e-05,
 &#39;listed&#39;: 4.3529360553693465e-05,
 &#39;elaya&#39;: 4.3529360553693465e-05,
 &#39;8027&#39;: 8.705872110738693e-05,
 &#39;adventuring&#39;: 4.3529360553693465e-05,
 &#39;stylish&#39;: 4.3529360553693465e-05,
 &#39;3650&#39;: 0.0001305880816610804,
 &#39;gossip&#39;: 8.705872110738693e-05,
 &#39;liao&#39;: 4.3529360553693465e-05,
 &#39;pattern&#39;: 4.3529360553693465e-05,
 &#39;logged&#39;: 4.3529360553693465e-05,
 &#39;missy&#39;: 4.3529360553693465e-05,
 &#39;total&#39;: 8.705872110738693e-05,
 &#39;risks&#39;: 4.3529360553693465e-05,
 &#39;bt&#39;: 0.000652940408305402,
 &#39;dont&#39;: 0.00039176424498324117,
 &#39;drink&#39;: 4.3529360553693465e-05,
 &#39;ru&#39;: 4.3529360553693465e-05,
 &#39;real1&#39;: 8.705872110738693e-05,
 &#39;stores&#39;: 4.3529360553693465e-05,
 &#39;directors&#39;: 4.3529360553693465e-05,
 &#39;tiime&#39;: 4.3529360553693465e-05,
 &#39;youuuuu&#39;: 4.3529360553693465e-05,
 &#39;standard&#39;: 0.00021764680276846734,
 &#39;character&#39;: 4.3529360553693465e-05,
 &#39;tomorw&#39;: 4.3529360553693465e-05,
 &#39;planettalkinstant&#39;: 8.705872110738693e-05,
 &#39;fav&#39;: 8.705872110738693e-05,
 &#39;so&#39;: 0.0009576459321812563,
 &#39;jamz&#39;: 8.705872110738693e-05,
 &#39;l8rs&#39;: 4.3529360553693465e-05,
 &#39;slice&#39;: 4.3529360553693465e-05,
 &#39;girlfrnd&#39;: 4.3529360553693465e-05,
 &#39;edrunk&#39;: 4.3529360553693465e-05,
 &#39;cramps&#39;: 4.3529360553693465e-05,
 &#39;justbeen&#39;: 4.3529360553693465e-05,
 &#39;eerie&#39;: 0.0002611761633221608,
 &#39;roast&#39;: 4.3529360553693465e-05,
 &#39;mjzgroup&#39;: 8.705872110738693e-05,
 &#39;themes&#39;: 4.3529360553693465e-05,
 &#39;her&#39;: 0.0004352936055369347,
 &#39;careabout&#39;: 4.3529360553693465e-05,
 &#39;gimme&#39;: 4.3529360553693465e-05,
 &#39;85069&#39;: 8.705872110738693e-05,
 &#39;stuck&#39;: 4.3529360553693465e-05,
 &#39;moseley&#39;: 4.3529360553693465e-05,
 &#39;recd&#39;: 0.0001305880816610804,
 &#39;offense&#39;: 4.3529360553693465e-05,
 &#39;among&#39;: 8.705872110738693e-05,
 &#39;87239&#39;: 0.00021764680276846734,
 &#39;maintaining&#39;: 4.3529360553693465e-05,
 &#39;09064017305&#39;: 8.705872110738693e-05,
 &#39;called&#39;: 8.705872110738693e-05,
 &#39;andros&#39;: 4.3529360553693465e-05,
 &#39;secret&#39;: 0.0003482348844295477,
 &#39;share&#39;: 4.3529360553693465e-05,
 &#39;spoons&#39;: 4.3529360553693465e-05,
 &#39;compass&#39;: 4.3529360553693465e-05,
 &#39;response&#39;: 8.705872110738693e-05,
 &#39;truro&#39;: 4.3529360553693465e-05,
 &#39;walmart&#39;: 4.3529360553693465e-05,
 &#39;play&#39;: 0.0005223523266443216,
 &#39;his&#39;: 4.3529360553693465e-05,
 &#39;cheery&#39;: 4.3529360553693465e-05,
 &#39;qbank&#39;: 4.3529360553693465e-05,
 &#39;5we&#39;: 0.0003482348844295477,
 &#39;box326&#39;: 8.705872110738693e-05,
 &#39;hills&#39;: 4.3529360553693465e-05,
 &#39;skye&#39;: 4.3529360553693465e-05,
 &#39;turning&#39;: 4.3529360553693465e-05,
 &#39;330&#39;: 4.3529360553693465e-05,
 &#39;space&#39;: 8.705872110738693e-05,
 &#39;second&#39;: 4.3529360553693465e-05,
 &#39;chef&#39;: 4.3529360553693465e-05,
 &#39;4403ldnw1a7rw18&#39;: 8.705872110738693e-05,
 &#39;messed&#39;: 4.3529360553693465e-05,
 &#39;07781482378&#39;: 0.0001305880816610804,
 &#39;masked&#39;: 8.705872110738693e-05,
 &#39;gucci&#39;: 4.3529360553693465e-05,
 &#39;7ws&#39;: 8.705872110738693e-05,
 &#39;somewheresomeone&#39;: 4.3529360553693465e-05,
 &#39;ringtone&#39;: 0.0012623514560571106,
 &#39;community&#39;: 0.0001305880816610804,
 &#39;pack&#39;: 4.3529360553693465e-05,
 &#39;c&#39;: 0.0017847037827014322,
 &#39;waqt&#39;: 4.3529360553693465e-05,
 &#39;scrappy&#39;: 4.3529360553693465e-05,
 &#39;ended&#39;: 4.3529360553693465e-05,
 &#39;rush&#39;: 4.3529360553693465e-05,
 &#39;carefully&#39;: 4.3529360553693465e-05,
 &#39;eshxxxxxxxxxxx&#39;: 4.3529360553693465e-05,
 &#39;gr8prizes&#39;: 0.0001305880816610804,
 &#39;piece&#39;: 4.3529360553693465e-05,
 &#39;teach&#39;: 4.3529360553693465e-05,
 &#39;loyalty&#39;: 0.0002611761633221608,
 &#39;dressed&#39;: 4.3529360553693465e-05,
 &#39;bevies&#39;: 4.3529360553693465e-05,
 &#39;97n7qp&#39;: 8.705872110738693e-05,
 &#39;takecare&#39;: 4.3529360553693465e-05,
 &#39;mums&#39;: 4.3529360553693465e-05,
 &#39;noncomittal&#39;: 4.3529360553693465e-05,
 &#39;had&#39;: 0.00047882296609062813,
 &#39;wknd&#39;: 4.3529360553693465e-05,
 &#39;im&#39;: 0.0003482348844295477,
 &#39;rimac&#39;: 4.3529360553693465e-05,
 &#39;loosing&#39;: 4.3529360553693465e-05,
 &#39;astrology&#39;: 4.3529360553693465e-05,
 &#39;reflection&#39;: 4.3529360553693465e-05,
 &#39;tosend&#39;: 4.3529360553693465e-05,
 &#39;urgent&#39;: 0.0020894093065772865,
 &#39;impossible&#39;: 4.3529360553693465e-05,
 &#39;xxsp&#39;: 8.705872110738693e-05,
 &#39;related&#39;: 4.3529360553693465e-05,
 &#39;fixd&#39;: 4.3529360553693465e-05,
 &#39;folks&#39;: 8.705872110738693e-05,
 &#39;09041940223&#39;: 8.705872110738693e-05,
 &#39;supports&#39;: 4.3529360553693465e-05,
 &#39;slippers&#39;: 4.3529360553693465e-05,
 &#39;tonights&#39;: 0.0001305880816610804,
 &#39;sudn&#39;: 4.3529360553693465e-05,
 &#39;swimming&#39;: 4.3529360553693465e-05,
 &#39;ages&#39;: 8.705872110738693e-05,
 &#39;divorce&#39;: 8.705872110738693e-05,
 &#39;are&#39;: 0.0028294084359900755,
 &#39;travel&#39;: 0.0001305880816610804,
 &#39;comes&#39;: 0.0001305880816610804,
 &#39;teeth&#39;: 4.3529360553693465e-05,
 &#39;edward&#39;: 4.3529360553693465e-05,
 &#39;student&#39;: 4.3529360553693465e-05,
 &#39;creepy&#39;: 4.3529360553693465e-05,
 &#39;etc&#39;: 0.00030470552387585427,
 &#39;rupaul&#39;: 4.3529360553693465e-05,
 &#39;hmm&#39;: 4.3529360553693465e-05,
 &#39;09064018838&#39;: 8.705872110738693e-05,
 &#39;prabha&#39;: 4.3529360553693465e-05,
 &#39;stomps&#39;: 4.3529360553693465e-05,
 &#39;nap&#39;: 4.3529360553693465e-05,
 &#39;pshew&#39;: 4.3529360553693465e-05,
 &#39;5free&#39;: 0.0001305880816610804,
 &#39;08719839835&#39;: 8.705872110738693e-05,
 &#39;echo&#39;: 8.705872110738693e-05,
 &#39;4jx&#39;: 8.705872110738693e-05,
 &#39;budget&#39;: 4.3529360553693465e-05,
 &#39;cudnt&#39;: 4.3529360553693465e-05,
 &#39;coherently&#39;: 4.3529360553693465e-05,
 &#39;otherwise&#39;: 4.3529360553693465e-05,
 &#39;well&#39;: 0.0002611761633221608,
 &#39;customers&#39;: 0.0001305880816610804,
 &#39;knock&#39;: 0.0001305880816610804,
 &#39;8714714&#39;: 8.705872110738693e-05,
 &#39;replacing&#39;: 4.3529360553693465e-05,
 &#39;69696&#39;: 8.705872110738693e-05,
 &#39;traditions&#39;: 4.3529360553693465e-05,
 &#39;sweetheart&#39;: 4.3529360553693465e-05,
 &#39;msg&#39;: 0.0019152918643625125,
 &#39;doubletxt&#39;: 8.705872110738693e-05,
 &#39;nights&#39;: 8.705872110738693e-05,
 &#39;disaster&#39;: 8.705872110738693e-05,
 &#39;08709501522&#39;: 8.705872110738693e-05,
 &#39;answr&#39;: 4.3529360553693465e-05,
 &#39;sacrifice&#39;: 4.3529360553693465e-05,
 &#39;hides&#39;: 4.3529360553693465e-05,
 &#39;claim&#39;: 0.003961171810386106,
 &#39;den&#39;: 4.3529360553693465e-05,
 &#39;thia&#39;: 4.3529360553693465e-05,
 &#39;151&#39;: 8.705872110738693e-05,
 &#39;datebox1282essexcm61xn&#39;: 8.705872110738693e-05,
 &#39;management&#39;: 4.3529360553693465e-05,
 &#39;hardly&#39;: 4.3529360553693465e-05,
 &#39;eek&#39;: 4.3529360553693465e-05,
 &#39;5min&#39;: 4.3529360553693465e-05,
 &#39;crab&#39;: 4.3529360553693465e-05,
 &#39;female&#39;: 8.705872110738693e-05,
 &#39;pickle&#39;: 4.3529360553693465e-05,
 &#39;bedrm&#39;: 4.3529360553693465e-05,
 &#39;shake&#39;: 4.3529360553693465e-05,
 &#39;swat&#39;: 8.705872110738693e-05,
 &#39;slob&#39;: 4.3529360553693465e-05,
 &#39;algorithms&#39;: 4.3529360553693465e-05,
 &#39;payments&#39;: 4.3529360553693465e-05,
 &#39;jackson&#39;: 4.3529360553693465e-05,
 &#39;either&#39;: 0.00039176424498324117,
 &#39;randomly&#39;: 0.0001305880816610804,
 &#39;parts&#39;: 4.3529360553693465e-05,
 &#39;prasad&#39;: 4.3529360553693465e-05,
 &#39;before&#39;: 0.00021764680276846734,
 &#39;lotsly&#39;: 4.3529360553693465e-05,
 &#39;bro&#39;: 4.3529360553693465e-05,
 &#39;kettoda&#39;: 4.3529360553693465e-05,
 &#39;nìte&#39;: 4.3529360553693465e-05,
 &#39;087018728737&#39;: 8.705872110738693e-05,
 &#39;uworld&#39;: 4.3529360553693465e-05,
 &#39;vital&#39;: 4.3529360553693465e-05,
 &#39;proof&#39;: 4.3529360553693465e-05,
 &#39;tirunelvali&#39;: 4.3529360553693465e-05,
 &#39;pie&#39;: 4.3529360553693465e-05,
 &#39;break&#39;: 0.00021764680276846734,
 &#39;starting&#39;: 0.0001305880816610804,
 &#39;fixed&#39;: 8.705872110738693e-05,
 &#39;0207&#39;: 0.00017411744221477386,
 &#39;newport&#39;: 4.3529360553693465e-05,
 &#39;when&#39;: 0.00047882296609062813,
 &#39;registration&#39;: 4.3529360553693465e-05,
 &#39;kids&#39;: 4.3529360553693465e-05,
 &#39;workage&#39;: 4.3529360553693465e-05,
 &#39;tickets&#39;: 0.00017411744221477386,
 &#39;increase&#39;: 4.3529360553693465e-05,
 &#39;opposed&#39;: 4.3529360553693465e-05,
 &#39;soc&#39;: 4.3529360553693465e-05,
 &#39;yeah&#39;: 8.705872110738693e-05,
 &#39;nationwide&#39;: 4.3529360553693465e-05,
 &#39;steps&#39;: 4.3529360553693465e-05,
 &#39;sit&#39;: 4.3529360553693465e-05,
 &#39;cloth&#39;: 4.3529360553693465e-05,
 &#39;jod&#39;: 4.3529360553693465e-05,
 &#39;amla&#39;: 4.3529360553693465e-05,
 &#39;salad&#39;: 4.3529360553693465e-05,
 &#39;80122300p&#39;: 8.705872110738693e-05,
 &#39;madoke&#39;: 4.3529360553693465e-05,
 &#39;shuhui&#39;: 4.3529360553693465e-05,
 &#39;viva&#39;: 4.3529360553693465e-05,
 &#39;4give&#39;: 4.3529360553693465e-05,
 &#39;al&#39;: 4.3529360553693465e-05,
 &#39;gibe&#39;: 4.3529360553693465e-05,
 &#39;shining&#39;: 4.3529360553693465e-05,
 &#39;textbook&#39;: 4.3529360553693465e-05,
 &#39;hm&#39;: 4.3529360553693465e-05,
 &#39;method&#39;: 4.3529360553693465e-05,
 &#39;truly&#39;: 0.0001305880816610804,
 &#39;involved&#39;: 4.3529360553693465e-05,
 &#39;gauti&#39;: 4.3529360553693465e-05,
 &#39;noline&#39;: 0.00021764680276846734,
 &#39;atlanta&#39;: 4.3529360553693465e-05,
 &#39;uncles&#39;: 4.3529360553693465e-05,
 &#39;jokes&#39;: 4.3529360553693465e-05,
 &#39;frequently&#39;: 4.3529360553693465e-05,
 &#39;tsunamis&#39;: 4.3529360553693465e-05,
 &#39;yar&#39;: 4.3529360553693465e-05,
 &#39;espe&#39;: 4.3529360553693465e-05,
 &#39;daywith&#39;: 4.3529360553693465e-05,
 &#39;b4190604&#39;: 8.705872110738693e-05,
 &#39;crisis&#39;: 4.3529360553693465e-05,
 &#39;end&#39;: 0.0006094110477517085,
 &#39;plum&#39;: 4.3529360553693465e-05,
 &#39;hows&#39;: 4.3529360553693465e-05,
 &#39;texts&#39;: 0.0008270578505201758,
 &#39;08701237397&#39;: 8.705872110738693e-05,
 &#39;anyones&#39;: 4.3529360553693465e-05,
 &#39;09071512433&#39;: 0.0001305880816610804,
 &#39;gpu&#39;: 4.3529360553693465e-05,
 &#39;08081263000&#39;: 8.705872110738693e-05,
 &#39;jiu&#39;: 4.3529360553693465e-05,
 &#39;waliking&#39;: 4.3529360553693465e-05,
 &#39;edge&#39;: 4.3529360553693465e-05,
 &#39;birthdate&#39;: 4.3529360553693465e-05,
 &#39;grinule&#39;: 4.3529360553693465e-05,
 &#39;girls&#39;: 0.00021764680276846734,
 &#39;s3xy&#39;: 8.705872110738693e-05,
 &#39;whens&#39;: 4.3529360553693465e-05,
 &#39;btw&#39;: 4.3529360553693465e-05,
 &#39;suzy&#39;: 8.705872110738693e-05,
 &#39;woohoo&#39;: 4.3529360553693465e-05,
 &#39;liked&#39;: 4.3529360553693465e-05,
 &#39;contented&#39;: 4.3529360553693465e-05,
 &#39;changes&#39;: 4.3529360553693465e-05,
 &#39;85555&#39;: 8.705872110738693e-05,
 &#39;map&#39;: 4.3529360553693465e-05,
 &#39;nothing&#39;: 0.00021764680276846734,
 &#39;izzit&#39;: 4.3529360553693465e-05,
 &#39;billed&#39;: 0.00017411744221477386,
 &#39;references&#39;: 4.3529360553693465e-05,
 &#39;lst&#39;: 4.3529360553693465e-05,
 &#39;mentionned&#39;: 4.3529360553693465e-05,
 &#39;rocking&#39;: 4.3529360553693465e-05,
 &#39;mandara&#39;: 4.3529360553693465e-05,
 &#39;savamob&#39;: 0.000565881687198015,
 &#39;londn&#39;: 4.3529360553693465e-05,
 &#39;buzzzz&#39;: 4.3529360553693465e-05,
 &#39;lyfu&#39;: 4.3529360553693465e-05,
 &#39;keluviri&#39;: 4.3529360553693465e-05,
 &#39;reverse&#39;: 4.3529360553693465e-05,
 &#39;people&#39;: 0.0001305880816610804,
 &#39;thgt&#39;: 4.3529360553693465e-05,
 &#39;reserve&#39;: 4.3529360553693465e-05,
 &#39;thinl&#39;: 4.3529360553693465e-05,
 &#39;sentence&#39;: 4.3529360553693465e-05,
 &#39;2gthr&#39;: 4.3529360553693465e-05,
 &#39;flag&#39;: 0.00039176424498324117,
 &#39;ladies&#39;: 0.00017411744221477386,
 &#39;ticket&#39;: 8.705872110738693e-05,
 &#39;babysit&#39;: 4.3529360553693465e-05,
 &#39;hcl&#39;: 4.3529360553693465e-05,
 &#39;lands&#39;: 4.3529360553693465e-05,
 &#39;september&#39;: 4.3529360553693465e-05,
 &#39;score&#39;: 4.3529360553693465e-05,
 &#39;roller&#39;: 4.3529360553693465e-05,
 &#39;engin&#39;: 4.3529360553693465e-05,
 &#39;tom&#39;: 8.705872110738693e-05,
 &#39;sry&#39;: 4.3529360553693465e-05,
 &#39;xxxxx&#39;: 8.705872110738693e-05,
 &#39;noi&#39;: 4.3529360553693465e-05,
 &#39;toyota&#39;: 4.3529360553693465e-05,
 &#39;daddy&#39;: 4.3529360553693465e-05,
 &#39;she&#39;: 4.3529360553693465e-05,
 &#39;po&#39;: 0.001305880816610804,
 &#39;forms&#39;: 4.3529360553693465e-05,
 &#39;star&#39;: 0.0001305880816610804,
 &#39;pub&#39;: 8.705872110738693e-05,
 &#39;sponsors&#39;: 4.3529360553693465e-05,
 &#39;await&#39;: 0.000652940408305402,
 &#39;filled&#39;: 4.3529360553693465e-05,
 &#39;start&#39;: 0.00030470552387585427,
 &#39;sexual&#39;: 8.705872110738693e-05,
 &#39;eng&#39;: 0.00021764680276846734,
 &#39;edu&#39;: 4.3529360553693465e-05,
 &#39;hahaha&#39;: 4.3529360553693465e-05,
 &#39;handed&#39;: 4.3529360553693465e-05,
 &#39;st&#39;: 8.705872110738693e-05,
 &#39;ttyl&#39;: 4.3529360553693465e-05,
 &#39;gang&#39;: 4.3529360553693465e-05,
 &#39;lovejen&#39;: 4.3529360553693465e-05,
 &#39;late&#39;: 8.705872110738693e-05,
 &#39;ic&#39;: 4.3529360553693465e-05,
 &#39;hw&#39;: 4.3529360553693465e-05,
 &#39;jetton&#39;: 4.3529360553693465e-05,
 &#39;reserves&#39;: 4.3529360553693465e-05,
 &#39;4got&#39;: 4.3529360553693465e-05,
 &#39;pocy&#39;: 4.3529360553693465e-05,
 &#39;16&#39;: 0.0019152918643625125,
 &#39;enufcredeit&#39;: 4.3529360553693465e-05,
 &#39;juicy&#39;: 4.3529360553693465e-05,
 &#39;listen&#39;: 8.705872110738693e-05,
 &#39;firsg&#39;: 4.3529360553693465e-05,
 &#39;goodmorning&#39;: 4.3529360553693465e-05,
 &#39;thing&#39;: 8.705872110738693e-05,
 &#39;laptop&#39;: 4.3529360553693465e-05,
 &#39;box334sk38ch&#39;: 0.0001305880816610804,
 &#39;child&#39;: 8.705872110738693e-05,
 &#39;fault&#39;: 4.3529360553693465e-05,
 &#39;dosomething&#39;: 4.3529360553693465e-05,
 &#39;touched&#39;: 4.3529360553693465e-05,
 &#39;bangb&#39;: 8.705872110738693e-05,
 &#39;flowing&#39;: 4.3529360553693465e-05,
 &#39;piss&#39;: 4.3529360553693465e-05,
 &#39;accordin&#39;: 4.3529360553693465e-05,
 &#39;09058095107&#39;: 8.705872110738693e-05,
 &#39;yaxxx&#39;: 4.3529360553693465e-05,
 &#39;even&#39;: 0.0002611761633221608,
 &#39;49557&#39;: 8.705872110738693e-05,
 &#39;suffers&#39;: 4.3529360553693465e-05,
 &#39;troubleshooting&#39;: 4.3529360553693465e-05,
 &#39;like&#39;: 0.00047882296609062813,
 &#39;bettr&#39;: 4.3529360553693465e-05,
 &#39;little&#39;: 0.00017411744221477386,
 &#39;purse&#39;: 4.3529360553693465e-05,
 &#39;persevered&#39;: 4.3529360553693465e-05,
 &#39;occupied&#39;: 4.3529360553693465e-05,
 &#39;bank&#39;: 0.0001305880816610804,
 &#39;____&#39;: 4.3529360553693465e-05,
 &#39;offline&#39;: 4.3529360553693465e-05,
 &#39;real&#39;: 0.0005223523266443216,
 &#39;breakin&#39;: 4.3529360553693465e-05,
 &#39;roger&#39;: 4.3529360553693465e-05,
 &#39;merry&#39;: 4.3529360553693465e-05,
 &#39;lol&#39;: 4.3529360553693465e-05,
 &#39;buttheres&#39;: 4.3529360553693465e-05,
 &#39;quit&#39;: 4.3529360553693465e-05,
 &#39;quiteamuzing&#39;: 4.3529360553693465e-05,
 &#39;2rcv&#39;: 8.705872110738693e-05,
 &#39;09094646631&#39;: 8.705872110738693e-05,
 &#39;realizes&#39;: 4.3529360553693465e-05,
 &#39;voucher&#39;: 0.0005223523266443216,
 &#39;gent&#39;: 8.705872110738693e-05,
 &#39;intend&#39;: 4.3529360553693465e-05,
 &#39;guai&#39;: 4.3529360553693465e-05,
 &#39;unfortunately&#39;: 4.3529360553693465e-05,
 &#39;valued&#39;: 0.00047882296609062813,
 &#39;geoenvironmental&#39;: 4.3529360553693465e-05,
 &#39;jacket&#39;: 4.3529360553693465e-05,
 &#39;tuition&#39;: 4.3529360553693465e-05,
 &#39;jack&#39;: 4.3529360553693465e-05,
 &#39;archive&#39;: 4.3529360553693465e-05,
 &#39;philosophical&#39;: 4.3529360553693465e-05,
 &#39;aiyah&#39;: 4.3529360553693465e-05,
 &#39;humanities&#39;: 4.3529360553693465e-05,
 &#39;orchard&#39;: 4.3529360553693465e-05,
 &#39;fated&#39;: 4.3529360553693465e-05,
 &#39;tayseer&#39;: 4.3529360553693465e-05,
 &#39;toilet&#39;: 8.705872110738693e-05,
 &#39;starring&#39;: 4.3529360553693465e-05,
 &#39;packing&#39;: 4.3529360553693465e-05,
 &#39;warm&#39;: 0.0001305880816610804,
 &#39;pale&#39;: 4.3529360553693465e-05,
 &#39;fml&#39;: 8.705872110738693e-05,
 &#39;cover&#39;: 4.3529360553693465e-05,
 &#39;dom&#39;: 4.3529360553693465e-05,
 &#39;wahay&#39;: 4.3529360553693465e-05,
 &#39;breakfast&#39;: 4.3529360553693465e-05,
 &#39;bc&#39;: 4.3529360553693465e-05,
 &#39;supplies&#39;: 4.3529360553693465e-05,
 &#39;bath&#39;: 4.3529360553693465e-05,
 &#39;hon&#39;: 4.3529360553693465e-05,
 &#39;3030&#39;: 0.0003482348844295477,
 &#39;bare&#39;: 4.3529360553693465e-05,
 &#39;pierre&#39;: 4.3529360553693465e-05,
 &#39;shitstorm&#39;: 4.3529360553693465e-05,
 &#39;theres&#39;: 4.3529360553693465e-05,
 &#39;replied&#39;: 8.705872110738693e-05,
 &#39;swing&#39;: 4.3529360553693465e-05,
 &#39;penis&#39;: 4.3529360553693465e-05,
 &#39;exmpel&#39;: 4.3529360553693465e-05,
 &#39;eve&#39;: 0.0002611761633221608,
 &#39;goto&#39;: 0.00030470552387585427,
 &#39;baig&#39;: 4.3529360553693465e-05,
 &#39;cliffs&#39;: 4.3529360553693465e-05,
 &#39;weirdy&#39;: 4.3529360553693465e-05,
 &#39;parkin&#39;: 4.3529360553693465e-05,
 &#39;alert&#39;: 0.00021764680276846734,
 &#39;yahoo&#39;: 0.0001305880816610804,
 &#39;decorating&#39;: 4.3529360553693465e-05,
 &#39;okors&#39;: 4.3529360553693465e-05,
 &#39;7th&#39;: 4.3529360553693465e-05,
 &#39;pleasant&#39;: 4.3529360553693465e-05,
 &#39;panren&#39;: 4.3529360553693465e-05,
 &#39;recorder&#39;: 8.705872110738693e-05,
 &#39;row&#39;: 0.000652940408305402,
 &#39;furniture&#39;: 4.3529360553693465e-05,
 &#39;140ppm&#39;: 8.705872110738693e-05,
 &#39;r&#39;: 0.0009576459321812563,
 &#39;salon&#39;: 4.3529360553693465e-05,
 &#39;9t&#39;: 4.3529360553693465e-05,
 &#39;itwhichturnedinto&#39;: 4.3529360553693465e-05,
 &#39;needle&#39;: 4.3529360553693465e-05,
 &#39;hooch&#39;: 4.3529360553693465e-05,
 &#39;anal&#39;: 4.3529360553693465e-05,
 &#39;option&#39;: 4.3529360553693465e-05,
 &#39;flatter&#39;: 4.3529360553693465e-05,
 &#39;muz&#39;: 4.3529360553693465e-05,
 &#39;caller&#39;: 0.0005223523266443216,
 &#39;sarcastic&#39;: 4.3529360553693465e-05,
 &#39;traffic&#39;: 4.3529360553693465e-05,
 &#39;opening&#39;: 4.3529360553693465e-05,
 &#39;wml&#39;: 0.0001305880816610804,
 &#39;ugh&#39;: 4.3529360553693465e-05,
 &#39;urawinner&#39;: 0.0002611761633221608,
 &#39;future&#39;: 0.00021764680276846734,
 &#39;ps&#39;: 4.3529360553693465e-05,
 &#39;grief&#39;: 4.3529360553693465e-05,
 &#39;january&#39;: 8.705872110738693e-05,
 &#39;youdoing&#39;: 4.3529360553693465e-05,
 &#39;bajarangabali&#39;: 4.3529360553693465e-05,
 &#39;complimentary&#39;: 0.0003482348844295477,
 &#39;superb&#39;: 8.705872110738693e-05,
 &#39;possessiveness&#39;: 4.3529360553693465e-05,
 &#39;midnight&#39;: 8.705872110738693e-05,
 &#39;cm&#39;: 8.705872110738693e-05,
 &#39;crore&#39;: 4.3529360553693465e-05,
 &#39;ghost&#39;: 0.0001305880816610804,
 &#39;improved&#39;: 8.705872110738693e-05,
 &#39;showr&#39;: 4.3529360553693465e-05,
 &#39;behave&#39;: 4.3529360553693465e-05,
 &#39;finished&#39;: 4.3529360553693465e-05,
 &#39;nitros&#39;: 4.3529360553693465e-05,
 &#39;enc&#39;: 4.3529360553693465e-05,
 &#39;tips&#39;: 8.705872110738693e-05,
 &#39;texas&#39;: 4.3529360553693465e-05,
 &#39;indians&#39;: 4.3529360553693465e-05,
 &#39;stubborn&#39;: 4.3529360553693465e-05,
 &#39;innings&#39;: 4.3529360553693465e-05,
 &#39;instructions&#39;: 8.705872110738693e-05,
 &#39;incident&#39;: 4.3529360553693465e-05,
 &#39;fps&#39;: 4.3529360553693465e-05,
 &#39;ouch&#39;: 4.3529360553693465e-05,
 &#39;resume&#39;: 4.3529360553693465e-05,
 &#39;deeraj&#39;: 4.3529360553693465e-05,
 &#39;declare&#39;: 4.3529360553693465e-05,
 &#39;everyboy&#39;: 4.3529360553693465e-05,
 &#39;k&#39;: 0.0001305880816610804,
 &#39;42810&#39;: 8.705872110738693e-05,
 &#39;situations&#39;: 4.3529360553693465e-05,
 &#39;disclose&#39;: 4.3529360553693465e-05,
 &#39;aka&#39;: 4.3529360553693465e-05,
 &#39;fone&#39;: 0.00021764680276846734,
 &#39;wen&#39;: 4.3529360553693465e-05,
 &#39;knowing&#39;: 4.3529360553693465e-05,
 &#39;wtc&#39;: 4.3529360553693465e-05,
 &#39;thread&#39;: 4.3529360553693465e-05,
 &#39;wt&#39;: 4.3529360553693465e-05,
 &#39;posted&#39;: 4.3529360553693465e-05,
 &#39;wa&#39;: 4.3529360553693465e-05,
 &#39;guesses&#39;: 4.3529360553693465e-05,
 &#39;spam&#39;: 8.705872110738693e-05,
 &#39;engaged&#39;: 4.3529360553693465e-05,
 &#39;dot&#39;: 0.0001305880816610804,
 &#39;obese&#39;: 4.3529360553693465e-05,
 &#39;speaking&#39;: 4.3529360553693465e-05,
 &#39;sathya&#39;: 4.3529360553693465e-05,
 &#39;09064019014&#39;: 0.0001305880816610804,
 &#39;usps&#39;: 4.3529360553693465e-05,
 &#39;stayed&#39;: 4.3529360553693465e-05,
 &#39;degree&#39;: 4.3529360553693465e-05,
 &#39;stream&#39;: 8.705872110738693e-05,
 &#39;yelow&#39;: 4.3529360553693465e-05,
 &#39;nearly&#39;: 8.705872110738693e-05,
 &#39;completed&#39;: 4.3529360553693465e-05,
 &#39;skateboarding&#39;: 4.3529360553693465e-05,
 &#39;housework&#39;: 4.3529360553693465e-05,
 &#39;madstini&#39;: 4.3529360553693465e-05,
 &#39;wating&#39;: 4.3529360553693465e-05,
 &#39;down&#39;: 4.3529360553693465e-05,
 &#39;scammers&#39;: 8.705872110738693e-05,
 &#39;bray&#39;: 0.0001305880816610804,
 &#39;charged&#39;: 0.0004352936055369347,
 &#39;150ppermesssubscription&#39;: 0.0001305880816610804,
 &#39;07815296484&#39;: 8.705872110738693e-05,
 &#39;took&#39;: 4.3529360553693465e-05,
 &#39;corporation&#39;: 4.3529360553693465e-05,
 &#39;overa&#39;: 4.3529360553693465e-05,
 &#39;sad&#39;: 4.3529360553693465e-05,
 &#39;woo&#39;: 4.3529360553693465e-05,
 &#39;sophas&#39;: 4.3529360553693465e-05,
 &#39;overtime&#39;: 4.3529360553693465e-05,
 &#39;08714712412&#39;: 8.705872110738693e-05,
 &#39;1win150ppmx3&#39;: 0.0001305880816610804,
 &#39;hockey&#39;: 8.705872110738693e-05,
 &#39;5pm&#39;: 4.3529360553693465e-05,
 &#39;sleep&#39;: 4.3529360553693465e-05,
 &#39;tx&#39;: 4.3529360553693465e-05,
 &#39;2morrow&#39;: 4.3529360553693465e-05,
 &#39;88800&#39;: 8.705872110738693e-05,
 &#39;stay&#39;: 0.00017411744221477386,
 &#39;wales&#39;: 8.705872110738693e-05,
 &#39;staff&#39;: 4.3529360553693465e-05,
 &#39;algebra&#39;: 4.3529360553693465e-05,
 &#39;tmorow&#39;: 4.3529360553693465e-05,
 &#39;minmoremobsemspobox45po139wa&#39;: 0.0001305880816610804,
 &#39;9755&#39;: 8.705872110738693e-05,
 &#39;place&#39;: 0.00021764680276846734,
 &#39;colourful&#39;: 4.3529360553693465e-05,
 &#39;subscribed&#39;: 0.0001305880816610804,
 &#39;guessing&#39;: 4.3529360553693465e-05,
 &#39;sehwag&#39;: 4.3529360553693465e-05,
 &#39;ws&#39;: 4.3529360553693465e-05,
 &#39;tiger&#39;: 8.705872110738693e-05,
 &#39;mental&#39;: 4.3529360553693465e-05,
 &#39;mei&#39;: 4.3529360553693465e-05,
 &#39;2price&#39;: 8.705872110738693e-05,
 &#39;hotmail&#39;: 4.3529360553693465e-05,
 &#39;mail&#39;: 4.3529360553693465e-05,
 &#39;reslove&#39;: 4.3529360553693465e-05,
 &#39;disk&#39;: 4.3529360553693465e-05,
 &#39;oli&#39;: 4.3529360553693465e-05,
 &#39;saw&#39;: 4.3529360553693465e-05,
 &#39;cancer&#39;: 4.3529360553693465e-05,
 &#39;dancin&#39;: 4.3529360553693465e-05,
 &#39;eggs&#39;: 4.3529360553693465e-05,
 &#39;stunning&#39;: 4.3529360553693465e-05,
 &#39;correction&#39;: 4.3529360553693465e-05,
 &#39;dict&#39;: 4.3529360553693465e-05,
 &#39;la3&#39;: 8.705872110738693e-05,
 &#39;easily&#39;: 4.3529360553693465e-05,
 &#39;bec&#39;: 4.3529360553693465e-05,
 &#39;china&#39;: 4.3529360553693465e-05,
 &#39;fuck&#39;: 4.3529360553693465e-05,
 &#39;styles&#39;: 4.3529360553693465e-05,
 &#39;poor&#39;: 4.3529360553693465e-05,
 &#39;befor&#39;: 4.3529360553693465e-05,
 &#39;luck&#39;: 0.0002611761633221608,
 &#39;red&#39;: 0.00017411744221477386,
 &#39;workand&#39;: 4.3529360553693465e-05,
 &#39;breathe&#39;: 4.3529360553693465e-05,
 &#39;anyplaces&#39;: 4.3529360553693465e-05,
 &#39;cps&#39;: 4.3529360553693465e-05,
 &#39;01223585334&#39;: 0.0001305880816610804,
 &#39;tkls&#39;: 8.705872110738693e-05,
 &#39;pdate_now&#39;: 8.705872110738693e-05,
 &#39;el&#39;: 4.3529360553693465e-05,
 &#39;psxtra&#39;: 4.3529360553693465e-05,
 &#39;gua&#39;: 4.3529360553693465e-05,
 &#39;epi&#39;: 4.3529360553693465e-05,
 &#39;shijutta&#39;: 4.3529360553693465e-05,
 &#39;wkend&#39;: 8.705872110738693e-05,
 &#39;2channel&#39;: 8.705872110738693e-05,
 &#39;velly&#39;: 4.3529360553693465e-05,
 &#39;visit&#39;: 0.00030470552387585427,
 &#39;because&#39;: 0.0001305880816610804,
 &#39;feb&#39;: 8.705872110738693e-05,
 &#39;rent&#39;: 4.3529360553693465e-05,
 &#39;load&#39;: 4.3529360553693465e-05,
 &#39;news&#39;: 0.00047882296609062813,
 &#39;icmb3cktz8r7&#39;: 8.705872110738693e-05,
 &#39;mom&#39;: 4.3529360553693465e-05,
 &#39;naughty&#39;: 4.3529360553693465e-05,
 &#39;mega&#39;: 8.705872110738693e-05,
 &#39;ig11&#39;: 8.705872110738693e-05,
 &#39;zaher&#39;: 4.3529360553693465e-05,
 &#39;presleys&#39;: 8.705872110738693e-05,
 &#39;odi&#39;: 4.3529360553693465e-05,
 &#39;sudden&#39;: 4.3529360553693465e-05,
 &#39;box420&#39;: 8.705872110738693e-05,
 &#39;sterm&#39;: 4.3529360553693465e-05,
 &#39;08708034412&#39;: 0.0001305880816610804,
 &#39;tming&#39;: 4.3529360553693465e-05,
 &#39;goal&#39;: 0.0001305880816610804,
 &#39;radiator&#39;: 4.3529360553693465e-05,
 &#39;4ward&#39;: 4.3529360553693465e-05,
 &#39;losing&#39;: 4.3529360553693465e-05,
 &#39;cereals&#39;: 4.3529360553693465e-05,
 &#39;nope&#39;: 4.3529360553693465e-05,
 &#39;prolly&#39;: 4.3529360553693465e-05,
 &#39;pre&#39;: 8.705872110738693e-05,
 &#39;claims&#39;: 0.0001305880816610804,
 &#39;here&#39;: 0.00021764680276846734,
 &#39;lux&#39;: 0.0001305880816610804,
 &#39;nigpun&#39;: 4.3529360553693465e-05,
 &#39;snake&#39;: 4.3529360553693465e-05,
 &#39;winning&#39;: 4.3529360553693465e-05,
 &#39;18&#39;: 0.0015235276193792714,
 &#39;chart&#39;: 0.0001305880816610804,
 &#39;matches&#39;: 0.00039176424498324117,
 &#39;repeat&#39;: 8.705872110738693e-05,
 &#39;priya&#39;: 4.3529360553693465e-05,
 &#39;department&#39;: 4.3529360553693465e-05,
 &#39;numbers&#39;: 0.00039176424498324117,
 &#39;lk&#39;: 4.3529360553693465e-05,
 &#39;ordinator&#39;: 4.3529360553693465e-05,
 &#39;gonna&#39;: 4.3529360553693465e-05,
 &#39;slow&#39;: 8.705872110738693e-05,
 &#39;havn&#39;: 4.3529360553693465e-05,
 &#39;unrecognized&#39;: 4.3529360553693465e-05,
 &#39;suganya&#39;: 4.3529360553693465e-05,
 &#39;rise&#39;: 4.3529360553693465e-05,
 &#39;sweetie&#39;: 4.3529360553693465e-05,
 &#39;minnaminunginte&#39;: 4.3529360553693465e-05,
 &#39;addamsfa&#39;: 0.0001305880816610804,
 &#39;35p&#39;: 8.705872110738693e-05,
 &#39;measure&#39;: 4.3529360553693465e-05,
 &#39;bowl&#39;: 4.3529360553693465e-05,
 &#39;nimya&#39;: 4.3529360553693465e-05,
 &#39;jen&#39;: 4.3529360553693465e-05,
 &#39;mistake&#39;: 8.705872110738693e-05,
 &#39;731&#39;: 8.705872110738693e-05,
 &#39;urself&#39;: 4.3529360553693465e-05,
 &#39;tessy&#39;: 4.3529360553693465e-05,
 &#39;ab&#39;: 8.705872110738693e-05,
 &#39;ubandu&#39;: 4.3529360553693465e-05,
 &#39;150pw&#39;: 8.705872110738693e-05,
 &#39;band&#39;: 8.705872110738693e-05,
 &#39;natural&#39;: 4.3529360553693465e-05,
 &#39;crammed&#39;: 4.3529360553693465e-05,
 &#39;coccooning&#39;: 4.3529360553693465e-05,
 &#39;153&#39;: 0.0001305880816610804,
 &#39;sch&#39;: 4.3529360553693465e-05,
 &#39;galileo&#39;: 4.3529360553693465e-05,
 &#39;500&#39;: 0.0016541157010403517,
 &#39;price&#39;: 0.000652940408305402,
 &#39;08712317606&#39;: 8.705872110738693e-05,
 &#39;settle&#39;: 4.3529360553693465e-05,
 &#39;amused&#39;: 4.3529360553693465e-05,
 &#39;picsfree1&#39;: 0.0001305880816610804,
 &#39;yah&#39;: 4.3529360553693465e-05,
 &#39;skins&#39;: 8.705872110738693e-05,
 &#39;quickly&#39;: 4.3529360553693465e-05,
 &#39;08006344447&#39;: 0.0001305880816610804,
 &#39;09099725823&#39;: 8.705872110738693e-05,
 &#39;already&#39;: 8.705872110738693e-05,
 &#39;killing&#39;: 4.3529360553693465e-05,
 &#39;chat80155&#39;: 8.705872110738693e-05,
 &#39;payed2day&#39;: 4.3529360553693465e-05,
 &#39;abdomen&#39;: 4.3529360553693465e-05,
 &#39;rcd&#39;: 8.705872110738693e-05,
 &#39;otbox&#39;: 8.705872110738693e-05,
 &#39;treasure&#39;: 4.3529360553693465e-05,
 &#39;fgkslpo&#39;: 8.705872110738693e-05,
 &#39;theoretically&#39;: 4.3529360553693465e-05,
 &#39;freek&#39;: 4.3529360553693465e-05,
 &#39;allday&#39;: 4.3529360553693465e-05,
 &#39;starts&#39;: 0.00021764680276846734,
 &#39;hmv1&#39;: 8.705872110738693e-05,
 &#39;vry&#39;: 4.3529360553693465e-05,
 &#39;licks&#39;: 4.3529360553693465e-05,
 &#39;owns&#39;: 4.3529360553693465e-05,
 &#39;cross&#39;: 8.705872110738693e-05,
 &#39;xmas&#39;: 0.000652940408305402,
 &#39;decking&#39;: 4.3529360553693465e-05,
 &#39;system&#39;: 4.3529360553693465e-05,
 &#39;husband&#39;: 4.3529360553693465e-05,
 &#39;150&#39;: 0.0006094110477517085,
 &#39;deep&#39;: 4.3529360553693465e-05,
 &#39;vegas&#39;: 4.3529360553693465e-05,
 &#39;beauty&#39;: 4.3529360553693465e-05,
 &#39;why&#39;: 0.00047882296609062813,
 &#39;sherawat&#39;: 4.3529360553693465e-05,
 &#39;verified&#39;: 4.3529360553693465e-05,
 &#39;along&#39;: 8.705872110738693e-05,
 &#39;rajitha&#39;: 4.3529360553693465e-05,
 &#39;gray&#39;: 4.3529360553693465e-05,
 &#39;dozens&#39;: 8.705872110738693e-05,
 &#39;initiate&#39;: 4.3529360553693465e-05,
 &#39;waiting&#39;: 0.000652940408305402,
 &#39;tp&#39;: 4.3529360553693465e-05,
 &#39;tim&#39;: 4.3529360553693465e-05,
 &#39;swayze&#39;: 4.3529360553693465e-05,
 &#39;bx526&#39;: 8.705872110738693e-05,
 &#39;oh&#39;: 4.3529360553693465e-05,
 &#39;joking&#39;: 4.3529360553693465e-05,
 &#39;celeb&#39;: 0.0001305880816610804,
 &#39;jersey&#39;: 8.705872110738693e-05,
 &#39;qet&#39;: 4.3529360553693465e-05,
 &#39;occasion&#39;: 4.3529360553693465e-05,
 &#39;txt43&#39;: 8.705872110738693e-05,
 &#39;shaping&#39;: 4.3529360553693465e-05,
 &#39;profiles&#39;: 4.3529360553693465e-05,
 &#39;130&#39;: 4.3529360553693465e-05,
 &#39;beneficiary&#39;: 4.3529360553693465e-05,
 &#39;videochat&#39;: 0.00021764680276846734,
 &#39;earning&#39;: 4.3529360553693465e-05,
 &#39;spending&#39;: 4.3529360553693465e-05,
 &#39;http&#39;: 0.0007835284899664823,
 &#39;bend&#39;: 4.3529360553693465e-05,
 &#39;computerless&#39;: 4.3529360553693465e-05,
 &#39;gr8&#39;: 0.00021764680276846734,
 &#39;family&#39;: 4.3529360553693465e-05,
 &#39;babygoodbye&#39;: 8.705872110738693e-05,
 &#39;08719181513&#39;: 0.0001305880816610804,
 &#39;loooooool&#39;: 4.3529360553693465e-05,
 &#39;vegetables&#39;: 4.3529360553693465e-05,
 &#39;ringtoneking&#39;: 0.0001305880816610804,
 &#39;favour&#39;: 4.3529360553693465e-05,
 &#39;age&#39;: 0.00030470552387585427,
 &#39;treat&#39;: 4.3529360553693465e-05,
 &#39;deer&#39;: 4.3529360553693465e-05,
 &#39;heads&#39;: 4.3529360553693465e-05,
 &#39;onam&#39;: 4.3529360553693465e-05,
 &#39;hesitate&#39;: 4.3529360553693465e-05,
 &#39;citizen&#39;: 4.3529360553693465e-05,
 &#39;somebody&#39;: 8.705872110738693e-05,
 &#39;mahal&#39;: 4.3529360553693465e-05,
 &#39;unbreakable&#39;: 8.705872110738693e-05,
 &#39;wrld&#39;: 4.3529360553693465e-05,
 &#39;15&#39;: 4.3529360553693465e-05,
 &#39;moments&#39;: 4.3529360553693465e-05,
 &#39;citylink&#39;: 4.3529360553693465e-05,
 &#39;4eva&#39;: 4.3529360553693465e-05,
 &#39;lead&#39;: 4.3529360553693465e-05,
 &#39;canceled&#39;: 4.3529360553693465e-05,
 &#39;duo&#39;: 4.3529360553693465e-05,
 &#39;annie&#39;: 4.3529360553693465e-05,
 &#39;co&#39;: 0.0016541157010403517,
 &#39;nigro&#39;: 4.3529360553693465e-05,
 &#39;blind&#39;: 0.0001305880816610804,
 &#39;cysts&#39;: 4.3529360553693465e-05,
 &#39;juz&#39;: 4.3529360553693465e-05,
 &#39;l8r&#39;: 4.3529360553693465e-05,
 &#39;doc&#39;: 4.3529360553693465e-05,
 &#39;kid&#39;: 4.3529360553693465e-05,
 &#39;freshers&#39;: 4.3529360553693465e-05,
 &#39;gymnastics&#39;: 4.3529360553693465e-05,
 &#39;lacs&#39;: 4.3529360553693465e-05,
 &#39;test&#39;: 4.3529360553693465e-05,
 &#39;studentfinancial&#39;: 4.3529360553693465e-05,
 &#39;ternal&#39;: 4.3529360553693465e-05,
 &#39;mobsi&#39;: 8.705872110738693e-05,
 &#39;gifts&#39;: 4.3529360553693465e-05,
 &#39;accenture&#39;: 4.3529360553693465e-05,
 &#39;u2moro&#39;: 4.3529360553693465e-05,
 &#39;wkly&#39;: 0.0004352936055369347,
 &#39;logging&#39;: 4.3529360553693465e-05,
 &#39;exterminator&#39;: 4.3529360553693465e-05,
 &#39;lido&#39;: 4.3529360553693465e-05,
 &#39;tired&#39;: 4.3529360553693465e-05,
 &#39;89693&#39;: 0.0001305880816610804,
 &#39;bluetoothhdset&#39;: 8.705872110738693e-05,
 &#39;hudgi&#39;: 4.3529360553693465e-05,
 &#39;sextextuk&#39;: 8.705872110738693e-05,
 &#39;full&#39;: 4.3529360553693465e-05,
 &#39;5wb&#39;: 0.0003482348844295477,
 &#39;urination&#39;: 4.3529360553693465e-05,
 &#39;24th&#39;: 4.3529360553693465e-05,
 &#39;offers&#39;: 0.000565881687198015,
 &#39;guaranteed&#39;: 0.0018282331432551255,
 &#39;for&#39;: 0.006703521525268794,
 &#39;08712402902&#39;: 8.705872110738693e-05,
 &#39;conform&#39;: 4.3529360553693465e-05,
 &#39;adsense&#39;: 4.3529360553693465e-05,
 &#39;t4get2text&#39;: 4.3529360553693465e-05,
 &#39;5th&#39;: 4.3529360553693465e-05,
 &#39;satisfy&#39;: 8.705872110738693e-05,
 &#39;campus&#39;: 4.3529360553693465e-05,
 &#39;uwant&#39;: 4.3529360553693465e-05,
 &#39;torture&#39;: 4.3529360553693465e-05,
 &#39;wearing&#39;: 4.3529360553693465e-05,
 &#39;usually&#39;: 4.3529360553693465e-05,
 &#39;4years&#39;: 4.3529360553693465e-05,
 &#39;sorted&#39;: 4.3529360553693465e-05,
 &#39;profit&#39;: 0.0001305880816610804,
 &#39;locations&#39;: 0.00017411744221477386,
 &#39;touch&#39;: 8.705872110738693e-05,
 &#39;trackmarque&#39;: 8.705872110738693e-05,
 &#39;safely&#39;: 4.3529360553693465e-05,
 &#39;begging&#39;: 4.3529360553693465e-05,
 &#39;broad&#39;: 4.3529360553693465e-05,
 &#39;gaps&#39;: 4.3529360553693465e-05,
 &#39;wrote&#39;: 8.705872110738693e-05,
 &#39;loses&#39;: 4.3529360553693465e-05,
 &#39;asjesus&#39;: 8.705872110738693e-05,
 &#39;grocers&#39;: 4.3529360553693465e-05,
 &#39;pay&#39;: 4.3529360553693465e-05,
 &#39;09099726481&#39;: 8.705872110738693e-05,
 &#39;costa&#39;: 0.0003482348844295477,
 &#39;huiming&#39;: 4.3529360553693465e-05,
 &#39;15pm&#39;: 4.3529360553693465e-05,
 &#39;am&#39;: 0.0005223523266443216,
 &#39;vday&#39;: 4.3529360553693465e-05,
 &#39;upset&#39;: 4.3529360553693465e-05,
 &#39;vibrate&#39;: 4.3529360553693465e-05,
 &#39;manege&#39;: 4.3529360553693465e-05,
 &#39;mailbox&#39;: 0.0001305880816610804,
 &#39;filling&#39;: 4.3529360553693465e-05,
 &#39;endowed&#39;: 4.3529360553693465e-05,
 &#39;83021&#39;: 8.705872110738693e-05,
 &#39;privacy&#39;: 8.705872110738693e-05,
 &#39;rebooting&#39;: 4.3529360553693465e-05,
 &#39;points&#39;: 0.0005223523266443216,
 &#39;busetop&#39;: 4.3529360553693465e-05,
 &#39;romantic&#39;: 8.705872110738693e-05,
 &#39;stories&#39;: 8.705872110738693e-05,
 &#39;preponed&#39;: 4.3529360553693465e-05,
 &#39;itz&#39;: 4.3529360553693465e-05,
 &#39;yup&#39;: 4.3529360553693465e-05,
 &#39;carlin&#39;: 4.3529360553693465e-05,
 &#39;lodging&#39;: 4.3529360553693465e-05,
 &#39;attach&#39;: 4.3529360553693465e-05,
 &#39;mmm&#39;: 4.3529360553693465e-05,
 &#39;dena&#39;: 8.705872110738693e-05,
 &#39;140&#39;: 4.3529360553693465e-05,
 &#39;fear&#39;: 4.3529360553693465e-05,
 &#39;promoting&#39;: 4.3529360553693465e-05,
 &#39;seem&#39;: 8.705872110738693e-05,
 &#39;at&#39;: 0.0010447046532886433,
 &#39;hopeing&#39;: 4.3529360553693465e-05,
 &#39;tron&#39;: 4.3529360553693465e-05,
 &#39;far&#39;: 4.3529360553693465e-05,
 &#39;read&#39;: 8.705872110738693e-05,
 &#39;fifth&#39;: 4.3529360553693465e-05,
 &#39;aren&#39;: 4.3529360553693465e-05,
 &#39;crying&#39;: 4.3529360553693465e-05,
 &#39;shaved&#39;: 4.3529360553693465e-05,
 &#39;thot&#39;: 4.3529360553693465e-05,
 &#39;award&#39;: 0.0010882340138423366,
 &#39;til&#39;: 4.3529360553693465e-05,
 &#39;ar&#39;: 4.3529360553693465e-05,
 &#39;countin&#39;: 4.3529360553693465e-05,
 &#39;jjc&#39;: 4.3529360553693465e-05,
 &#39;hang&#39;: 4.3529360553693465e-05,
 &#39;lengths&#39;: 4.3529360553693465e-05,
 &#39;made&#39;: 8.705872110738693e-05,
 &#39;stoptxtstop&#39;: 8.705872110738693e-05,
 &#39;freaking&#39;: 4.3529360553693465e-05,
 &#39;season&#39;: 8.705872110738693e-05,
 &#39;stopcost&#39;: 8.705872110738693e-05,
 &#39;miles&#39;: 4.3529360553693465e-05,
 &#39;ntwk&#39;: 8.705872110738693e-05,
 &#39;florida&#39;: 4.3529360553693465e-05,
 &#39;unredeemed&#39;: 0.00021764680276846734,
 &#39;downstem&#39;: 4.3529360553693465e-05,
 &#39;key&#39;: 8.705872110738693e-05,
 &#39;08712460324&#39;: 0.00039176424498324117,
 &#39;84128&#39;: 8.705872110738693e-05,
 &#39;anythingtomorrow&#39;: 4.3529360553693465e-05,
 &#39;jacuzzi&#39;: 4.3529360553693465e-05,
 &#39;fifa&#39;: 8.705872110738693e-05,
 &#39;sliding&#39;: 4.3529360553693465e-05,
 &#39;per&#39;: 0.0017411744221477387,
 &#39;600&#39;: 8.705872110738693e-05,
 &#39;beware&#39;: 8.705872110738693e-05,
 &#39;visiting&#39;: 4.3529360553693465e-05,
 &#39;hitter&#39;: 4.3529360553693465e-05,
 &#39;board&#39;: 4.3529360553693465e-05,
 &#39;chicken&#39;: 4.3529360553693465e-05,
 &#39;lucy&#39;: 0.0001305880816610804,
 &#39;08715203677&#39;: 8.705872110738693e-05,
 &#39;thesis&#39;: 4.3529360553693465e-05,
 &#39;gravy&#39;: 4.3529360553693465e-05,
 &#39;lover&#39;: 0.0001305880816610804,
 &#39;nelson&#39;: 4.3529360553693465e-05,
 &#39;burning&#39;: 4.3529360553693465e-05,
 &#39;pataistha&#39;: 4.3529360553693465e-05,
 &#39;many&#39;: 0.0001305880816610804,
 &#39;cake&#39;: 4.3529360553693465e-05,
 &#39;complaining&#39;: 4.3529360553693465e-05,
 &#39;cl&#39;: 4.3529360553693465e-05,
 &#39;appreciated&#39;: 4.3529360553693465e-05,
 &#39;apparently&#39;: 4.3529360553693465e-05,
 &#39;terrible&#39;: 4.3529360553693465e-05,
 &#39;dd&#39;: 4.3529360553693465e-05,
 &#39;february&#39;: 4.3529360553693465e-05,
 &#39;09050002311&#39;: 8.705872110738693e-05,
 &#39;oxygen&#39;: 4.3529360553693465e-05,
 &#39;scallies&#39;: 8.705872110738693e-05,
 &#39;faster&#39;: 8.705872110738693e-05,
 &#39;180&#39;: 4.3529360553693465e-05,
 &#39;leadership&#39;: 8.705872110738693e-05,
 &#39;hurry&#39;: 8.705872110738693e-05,
 &#39;pull&#39;: 4.3529360553693465e-05,
 &#39;movie&#39;: 8.705872110738693e-05,
 &#39;tscs&#39;: 0.0001305880816610804,
 &#39;rd&#39;: 4.3529360553693465e-05,
 &#39;87121&#39;: 0.0001305880816610804,
 &#39;knackered&#39;: 4.3529360553693465e-05,
 &#39;occurs&#39;: 4.3529360553693465e-05,
 &#39;teju&#39;: 4.3529360553693465e-05,
 &#39;profile&#39;: 4.3529360553693465e-05,
 &#39;cloud&#39;: 4.3529360553693465e-05,
 &#39;newest&#39;: 0.0001305880816610804,
 &#39;sugababes&#39;: 8.705872110738693e-05,
 &#39;650&#39;: 4.3529360553693465e-05,
 &#39;chop&#39;: 4.3529360553693465e-05,
 &#39;surprise&#39;: 0.00021764680276846734,
 &#39;eightish&#39;: 4.3529360553693465e-05,
 &#39;voice&#39;: 4.3529360553693465e-05,
 &#39;natalja&#39;: 0.0001305880816610804,
 &#39;7876150ppm&#39;: 8.705872110738693e-05,
 &#39;fighting&#39;: 4.3529360553693465e-05,
 &#39;secretly&#39;: 8.705872110738693e-05,
 &#39;09050005321&#39;: 8.705872110738693e-05,
 &#39;difficulties&#39;: 4.3529360553693465e-05,
 &#39;neekunna&#39;: 4.3529360553693465e-05,
 &#39;l8er&#39;: 8.705872110738693e-05,
 &#39;jos&#39;: 4.3529360553693465e-05,
 &#39;html&#39;: 8.705872110738693e-05,
 &#39;unsub&#39;: 0.00030470552387585427,
 &#39;youwanna&#39;: 4.3529360553693465e-05,
 &#39;ahmad&#39;: 4.3529360553693465e-05,
 &#39;upgrade&#39;: 0.0001305880816610804,
 &#39;millers&#39;: 4.3529360553693465e-05,
 &#39;log&#39;: 0.00030470552387585427,
 &#39;caught&#39;: 4.3529360553693465e-05,
 &#39;nytho&#39;: 4.3529360553693465e-05,
 &#39;ivatte&#39;: 4.3529360553693465e-05,
 &#39;challenge&#39;: 8.705872110738693e-05,
 &#39;14tcr&#39;: 8.705872110738693e-05,
 &#39;saeed&#39;: 4.3529360553693465e-05,
 &#39;ideas&#39;: 4.3529360553693465e-05,
 &#39;aletter&#39;: 4.3529360553693465e-05,
 &#39;global&#39;: 8.705872110738693e-05,
 &#39;once&#39;: 4.3529360553693465e-05,
 &#39;port&#39;: 4.3529360553693465e-05,
 &#39;wheel&#39;: 4.3529360553693465e-05,
 &#39;attend&#39;: 4.3529360553693465e-05,
 &#39;appy&#39;: 4.3529360553693465e-05,
 &#39;yogasana&#39;: 4.3529360553693465e-05,
 &#39;rajas&#39;: 4.3529360553693465e-05,
 &#39;bless&#39;: 4.3529360553693465e-05,
 &#39;rdy&#39;: 4.3529360553693465e-05,
 &#39;cutest&#39;: 4.3529360553693465e-05,
 ...}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to be used as spam filter</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>

    <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\W&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="n">p_spam_given_message</span> <span class="o">=</span> <span class="n">p_spam</span>
    <span class="n">p_ham_given_message</span> <span class="o">=</span> <span class="n">p_ham</span>
    
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_spam</span><span class="p">:</span>
            <span class="n">p_spam_given_message</span> <span class="o">*=</span> <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_ham</span><span class="p">:</span>
            <span class="n">p_ham_given_message</span> <span class="o">*=</span> <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(Spam|message):&#39;</span><span class="p">,</span> <span class="n">p_spam_given_message</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(Ham|message):&#39;</span><span class="p">,</span> <span class="n">p_ham_given_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_ham_given_message</span> <span class="o">&gt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Label: Ham&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">p_ham_given_message</span> <span class="o">&lt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Label: Spam&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Equal proabilities, have a human classify this!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classify</span><span class="p">(</span><span class="s1">&#39;WINNER!! This is the secret code to unlock the money: C3421.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(Spam|message): 1.3481290211300841e-25
P(Ham|message): 1.9368049028589875e-27
Label: Spam
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classify</span><span class="p">(</span><span class="s1">&#39;Sounds good, Tom, then see u there&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(Spam|message): 2.4372375665888117e-25
P(Ham|message): 3.687530435009238e-21
Label: Ham
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="test-accuracy">
<h2>Test accuracy<a class="headerlink" href="#test-accuracy" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test the accuracy of the algorithme</span>

<span class="k">def</span> <span class="nf">classify_test_set</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>

    <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\W&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="n">p_spam_given_message</span> <span class="o">=</span> <span class="n">p_spam</span>
    <span class="n">p_ham_given_message</span> <span class="o">=</span> <span class="n">p_ham</span>

    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_spam</span><span class="p">:</span>
            <span class="n">p_spam_given_message</span> <span class="o">*=</span> <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_ham</span><span class="p">:</span>
            <span class="n">p_ham_given_message</span> <span class="o">*=</span> <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">p_ham_given_message</span> <span class="o">&gt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;ham&#39;</span>
    <span class="k">elif</span> <span class="n">p_spam_given_message</span> <span class="o">&gt;</span> <span class="n">p_ham_given_message</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;spam&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;needs human classification&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">classify_test_set</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
      <th>predicted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Later i guess. I needa do mcat study too.</td>
      <td>ham</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>But i haf enuff space got like 4 mb...</td>
      <td>ham</td>
    </tr>
    <tr>
      <td>2</td>
      <td>spam</td>
      <td>Had your mobile 10 mths? Update to latest Oran...</td>
      <td>spam</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>All sounds good. Fingers . Makes it difficult ...</td>
      <td>ham</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>All done, all handed in. Don't know if mega sh...</td>
      <td>ham</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Accuracy of the spam filter</span>
<span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]:</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="mi">1</span>
        
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correct:&#39;</span><span class="p">,</span> <span class="n">correct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Incorrect:&#39;</span><span class="p">,</span> <span class="n">total</span> <span class="o">-</span> <span class="n">correct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy:&#39;</span><span class="p">,</span> <span class="n">correct</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Correct: 1100
Incorrect: 14
Accuracy: 0.9874326750448833
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>The accuracy is close to 98.74%, which is really good. Our spam filter looked at 1,114 messages that it hasn’t seen in training, and classified 1,100 correctly.</p>
<p>Next Steps
In this project, we managed to build a spam filter for SMS messages using the multinomial Naive Bayes algorithm. The filter had an accuracy of 98.74% on the test set we used, which is a pretty good result. Our initial goal was an accuracy of over 80%, and we managed to do way better than that.</p>
<p>Next steps include:</p>
<ul class="simple">
<li><p>Analyze the 14 messages that were classified incorrectly and try to figure out why the algorithm classified them incorrectly</p></li>
<li><p>Make the filtering process more complex by making the algorithm sensitive to letter case</p></li>
<li><p>Get the project portfolio-ready by using a few tips from our style guide for data science projects.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="HandwrittenDigitsClassifierUsingCrossValidation.html" title="previous page">Building A Handwritten Digits Classifier using Cross Validation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Arnoud Beerepoot<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>