
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Building a Spam Filter with Naive Bayes &#8212; My Jupyter books</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/togglebutton.js"></script>
    <script type="text/javascript" src="_static/clipboard.min.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript">var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script type="text/javascript" src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" type="text/javascript" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script type="text/javascript">
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" type="text/javascript" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Building A Handwritten Digits Classifier using Cross Validation" href="HandwrittenDigitsClassifierUsingCrossValidation.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">My Jupyter books</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="landing-page.html">
   My Jupyter books
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="HandwrittenDigitsClassifierUsingCrossValidation.html">
   Building A Handwritten Digits Classifier using Cross Validation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Building a Spam Filter with Naive Bayes
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Building a Spam Filter with Naive Bayes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/arnoudbeerepoot/Building-A-Handwritten-Digits-Classifier-using-Cross-Validation"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/arnoudbeerepoot/Building-A-Handwritten-Digits-Classifier-using-Cross-Validation/issues/new?title=Issue%20on%20page%20%2FBuilding a Spam Filter with Naive Bayes.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/arnoudbeerepoot/Building-A-Handwritten-Digits-Classifier-using-Cross-Validation/master?urlpath=tree/Building a Spam Filter with Naive Bayes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-dataset-and-analyze-the-data">
   Import dataset and analyze the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-train-and-test-set">
   Create a train and test set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clean-the-dataset">
   Clean the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-accuracy">
   Test accuracy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="building-a-spam-filter-with-naive-bayes">
<h1>Building a Spam Filter with Naive Bayes<a class="headerlink" href="#building-a-spam-filter-with-naive-bayes" title="Permalink to this headline">¶</a></h1>
<p>In this project a spam filter is built based on the Naive Bayes algorithm. It will be used to classify SMS messages as spam or non-spam. The spam-filter is being trained with a dataset of 5572 SMS messages that are already classified by humans <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/sms+spam+collection">The UCI Machine Learning Repository</a>
See wikipedia for background information <a class="reference external" href="https://en.wikipedia.org/wiki/Naive_Bayes_classifier">Naive Bayes classifier</a></p>
<div class="section" id="import-dataset-and-analyze-the-data">
<h2>Import dataset and analyze the data<a class="headerlink" href="#import-dataset-and-analyze-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;SMSSpamCollection.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">,</span> <span class="s1">&#39;SMS&#39;</span><span class="p">])</span> 
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5572 entries, 0 to 5571
Data columns (total 2 columns):
Label    5572 non-null object
SMS      5572 non-null object
dtypes: object(2)
memory usage: 87.2+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show the first five rows</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Go until jurong point, crazy.. Available only ...</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>Ok lar... Joking wif u oni...</td>
    </tr>
    <tr>
      <td>2</td>
      <td>spam</td>
      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>U dun say so early hor... U c already then say...</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>Nah I don't think he goes to usf, he lives aro...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># how many spam vs non-spam messages are in the dataset?</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     4825
spam     747
Name: Label, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percentage_spam</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">747</span><span class="o">/</span><span class="p">(</span><span class="mi">4825</span><span class="o">+</span><span class="mi">747</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="s2">&quot;In the dataset </span><span class="si">{}</span><span class="s2"> </span><span class="si">% o</span><span class="s2">f the messages is spam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentage_spam</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;In the dataset 13.4 % of the messages is spam&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-a-train-and-test-set">
<h2>Create a train and test set<a class="headerlink" href="#create-a-train-and-test-set" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Randomize the entire dataset</span>
<span class="n">random</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the randomized dataset in a train and test set</span>
<span class="c1"># 80% is training that is 4458 records</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">random</span><span class="p">[:</span><span class="mi">4458</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">random</span><span class="p">[</span><span class="mi">4458</span><span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4458 entries, 0 to 4457
Data columns (total 2 columns):
Label    4458 non-null object
SMS      4458 non-null object
dtypes: object(2)
memory usage: 69.8+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of ham and spam messages in the train set</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     3858
spam     600
Name: Label, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percentage_spam_train</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">600</span><span class="o">/</span><span class="p">(</span><span class="mi">3858</span><span class="o">+</span><span class="mi">600</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="s2">&quot;In the training dataset </span><span class="si">{}</span><span class="s2"> </span><span class="si">% o</span><span class="s2">f the messages is spam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentage_spam_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;In the training dataset 13.5 % of the messages is spam&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of ham and spam messages in the test set</span>
<span class="n">test</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ham     967
spam    147
Name: Label, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percentage_spam_test</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">147</span><span class="o">/</span><span class="p">(</span><span class="mi">967</span><span class="o">+</span><span class="mi">147</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="s2">&quot;In the test dataset </span><span class="si">{}</span><span class="s2"> </span><span class="si">% o</span><span class="s2">f the messages is spam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentage_spam_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;In the test dataset 13.2 % of the messages is spam&#39;
</pre></div>
</div>
</div>
</div>
<p>Percentages of spam messages in train en test set are in the same range as the original dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Yep, by the pretty sculpture</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>Yes, princess. Are you going to make me moan?</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>Welp apparently he retired</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>Havent.</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>I forgot 2 ask ü all smth.. There's a card on ...</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ham</td>
      <td>Ok i thk i got it. Then u wan me 2 come now or...</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ham</td>
      <td>I want kfc its Tuesday. Only buy 2 meals ONLY ...</td>
    </tr>
    <tr>
      <td>7</td>
      <td>ham</td>
      <td>No dear i was sleeping :-P</td>
    </tr>
    <tr>
      <td>8</td>
      <td>ham</td>
      <td>Ok pa. Nothing problem:-)</td>
    </tr>
    <tr>
      <td>9</td>
      <td>ham</td>
      <td>Ill be there on  &amp;lt;#&amp;gt;  ok.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="clean-the-dataset">
<h2>Clean the dataset<a class="headerlink" href="#clean-the-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove punctuation</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;\W&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Yep  by the pretty sculpture</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>Yes  princess  Are you going to make me moan</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>Welp apparently he retired</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>Havent</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>I forgot 2 ask ü all smth   There s a card on ...</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ham</td>
      <td>Ok i thk i got it  Then u wan me 2 come now or...</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ham</td>
      <td>I want kfc its Tuesday  Only buy 2 meals ONLY ...</td>
    </tr>
    <tr>
      <td>7</td>
      <td>ham</td>
      <td>No dear i was sleeping   P</td>
    </tr>
    <tr>
      <td>8</td>
      <td>ham</td>
      <td>Ok pa  Nothing problem</td>
    </tr>
    <tr>
      <td>9</td>
      <td>ham</td>
      <td>Ill be there on   lt   gt   ok</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transform every letter in every word to lowercase</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>yep  by the pretty sculpture</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>yes  princess  are you going to make me moan</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>welp apparently he retired</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>havent</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>i forgot 2 ask ü all smth   there s a card on ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a vocabulary for the messages in the training set.</span>
<span class="c1"># The vocabulary should be a Python list containing all the unique words across all messages, </span>
<span class="c1"># where each word is represented as a string.</span>

<span class="c1"># Create a list of words</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">vocabulary</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
        <span class="n">vocabulary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="n">vocabulary</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">))</span>
<span class="n">vocabulary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;loads&#39;,
 &#39;lies&#39;,
 &#39;41782&#39;,
 &#39;want&#39;,
 &#39;werethe&#39;,
 &#39;37819&#39;,
 &#39;24&#39;,
 &#39;min&#39;,
 &#39;arabian&#39;,
 &#39;ugadi&#39;,
 &#39;came&#39;,
 &#39;tke&#39;,
 &#39;chit&#39;,
 &#39;able&#39;,
 &#39;lotsof&#39;,
 &#39;invitation&#39;,
 &#39;deserve&#39;,
 &#39;active&#39;,
 &#39;thirunelvali&#39;,
 &#39;spoon&#39;,
 &#39;behalf&#39;,
 &#39;pretend&#39;,
 &#39;rob&#39;,
 &#39;unconvinced&#39;,
 &#39;sextextuk&#39;,
 &#39;〨ud&#39;,
 &#39;raping&#39;,
 &#39;opt&#39;,
 &#39;file&#39;,
 &#39;man&#39;,
 &#39;pan&#39;,
 &#39;suply&#39;,
 &#39;invest&#39;,
 &#39;student&#39;,
 &#39;pick&#39;,
 &#39;tor&#39;,
 &#39;processed&#39;,
 &#39;is&#39;,
 &#39;lennon&#39;,
 &#39;astoundingly&#39;,
 &#39;ummifying&#39;,
 &#39;body&#39;,
 &#39;2morow&#39;,
 &#39;laptop&#39;,
 &#39;zyada&#39;,
 &#39;church&#39;,
 &#39;hype&#39;,
 &#39;goodnight&#39;,
 &#39;intro&#39;,
 &#39;netcollex&#39;,
 &#39;limping&#39;,
 &#39;pleasure&#39;,
 &#39;shipping&#39;,
 &#39;permission&#39;,
 &#39;general&#39;,
 &#39;mileage&#39;,
 &#39;aldrine&#39;,
 &#39;enough&#39;,
 &#39;plane&#39;,
 &#39;ppm&#39;,
 &#39;frosty&#39;,
 &#39;snow&#39;,
 &#39;outside&#39;,
 &#39;beerage&#39;,
 &#39;jones&#39;,
 &#39;thursday&#39;,
 &#39;science&#39;,
 &#39;3uz&#39;,
 &#39;lower&#39;,
 &#39;crowd&#39;,
 &#39;defeat&#39;,
 &#39;staring&#39;,
 &#39;087104711148&#39;,
 &#39;here&#39;,
 &#39;bothering&#39;,
 &#39;patrick&#39;,
 &#39;watching&#39;,
 &#39;woken&#39;,
 &#39;2004&#39;,
 &#39;nothin&#39;,
 &#39;prey&#39;,
 &#39;crab&#39;,
 &#39;p&#39;,
 &#39;ru&#39;,
 &#39;inconsiderate&#39;,
 &#39;excuses&#39;,
 &#39;slo&#39;,
 &#39;10&#39;,
 &#39;possible&#39;,
 &#39;karo&#39;,
 &#39;auto&#39;,
 &#39;othrwise&#39;,
 &#39;dinner&#39;,
 &#39;cm&#39;,
 &#39;jane&#39;,
 &#39;asusual&#39;,
 &#39;aiyar&#39;,
 &#39;09061790125&#39;,
 &#39;currently&#39;,
 &#39;apt&#39;,
 &#39;marriage&#39;,
 &#39;biatch&#39;,
 &#39;spacebucks&#39;,
 &#39;braindance&#39;,
 &#39;hol&#39;,
 &#39;ki&#39;,
 &#39;treatin&#39;,
 &#39;affectionate&#39;,
 &#39;ink&#39;,
 &#39;waqt&#39;,
 &#39;blue&#39;,
 &#39;vip&#39;,
 &#39;tmrw&#39;,
 &#39;issue&#39;,
 &#39;fonin&#39;,
 &#39;tactful&#39;,
 &#39;08718727870&#39;,
 &#39;returns&#39;,
 &#39;heavy&#39;,
 &#39;damn&#39;,
 &#39;zealand&#39;,
 &#39;med&#39;,
 &#39;hopeing&#39;,
 &#39;messenger&#39;,
 &#39;way2sms&#39;,
 &#39;nighters&#39;,
 &#39;refreshed&#39;,
 &#39;4&#39;,
 &#39;clear&#39;,
 &#39;usual&#39;,
 &#39;evng&#39;,
 &#39;entry41&#39;,
 &#39;listened2the&#39;,
 &#39;bro&#39;,
 &#39;drive&#39;,
 &#39;yet&#39;,
 &#39;kip&#39;,
 &#39;calling&#39;,
 &#39;ntimate&#39;,
 &#39;display&#39;,
 &#39;09064011000&#39;,
 &#39;percentages&#39;,
 &#39;1pm&#39;,
 &#39;rencontre&#39;,
 &#39;row&#39;,
 &#39;frank&#39;,
 &#39;wrking&#39;,
 &#39;thy&#39;,
 &#39;area&#39;,
 &#39;remembered&#39;,
 &#39;web2mobile&#39;,
 &#39;vry&#39;,
 &#39;islands&#39;,
 &#39;barkleys&#39;,
 &#39;steak&#39;,
 &#39;rightio&#39;,
 &#39;all&#39;,
 &#39;86688&#39;,
 &#39;bash&#39;,
 &#39;mgs&#39;,
 &#39;must&#39;,
 &#39;complain&#39;,
 &#39;think&#39;,
 &#39;unintentionally&#39;,
 &#39;09058099801&#39;,
 &#39;parking&#39;,
 &#39;kalstiya&#39;,
 &#39;phd&#39;,
 &#39;kisi&#39;,
 &#39;ability&#39;,
 &#39;unlike&#39;,
 &#39;virgins&#39;,
 &#39;gap&#39;,
 &#39;08715203649&#39;,
 &#39;d3wv&#39;,
 &#39;londn&#39;,
 &#39;dha&#39;,
 &#39;gr8prizes&#39;,
 &#39;clothes&#39;,
 &#39;searching&#39;,
 &#39;ava&#39;,
 &#39;delivered&#39;,
 &#39;numbers&#39;,
 &#39;parkin&#39;,
 &#39;slowing&#39;,
 &#39;ros&#39;,
 &#39;supervisor&#39;,
 &#39;finish&#39;,
 &#39;she&#39;,
 &#39;definitly&#39;,
 &#39;chef&#39;,
 &#39;400mins&#39;,
 &#39;ages&#39;,
 &#39;pudunga&#39;,
 &#39;listener&#39;,
 &#39;ran&#39;,
 &#39;cheyyamo&#39;,
 &#39;renewal&#39;,
 &#39;s89&#39;,
 &#39;sth&#39;,
 &#39;rejected&#39;,
 &#39;studentfinancial&#39;,
 &#39;joined&#39;,
 &#39;facilities&#39;,
 &#39;cooped&#39;,
 &#39;offers&#39;,
 &#39;these&#39;,
 &#39;wml&#39;,
 &#39;nosy&#39;,
 &#39;dozens&#39;,
 &#39;eh74rr&#39;,
 &#39;profit&#39;,
 &#39;compulsory&#39;,
 &#39;lodging&#39;,
 &#39;cappuccino&#39;,
 &#39;dentists&#39;,
 &#39;cherthala&#39;,
 &#39;wotu&#39;,
 &#39;california&#39;,
 &#39;dictionary&#39;,
 &#39;fold&#39;,
 &#39;caps&#39;,
 &#39;cud&#39;,
 &#39;qet&#39;,
 &#39;thinking&#39;,
 &#39;530&#39;,
 &#39;mystery&#39;,
 &#39;semester&#39;,
 &#39;darkest&#39;,
 &#39;gua&#39;,
 &#39;hostel&#39;,
 &#39;83118&#39;,
 &#39;consensus&#39;,
 &#39;times&#39;,
 &#39;ooooooh&#39;,
 &#39;jstfrnd&#39;,
 &#39;4my&#39;,
 &#39;less&#39;,
 &#39;63miles&#39;,
 &#39;model&#39;,
 &#39;09064019014&#39;,
 &#39;private&#39;,
 &#39;november&#39;,
 &#39;sed&#39;,
 &#39;redeemable&#39;,
 &#39;makes&#39;,
 &#39;stability&#39;,
 &#39;cr9&#39;,
 &#39;heaven&#39;,
 &#39;piggy&#39;,
 &#39;catches&#39;,
 &#39;norcorp&#39;,
 &#39;lighters&#39;,
 &#39;674&#39;,
 &#39;galileo&#39;,
 &#39;checking&#39;,
 &#39;positive&#39;,
 &#39;chikku&#39;,
 &#39;literally&#39;,
 &#39;irritated&#39;,
 &#39;sex&#39;,
 &#39;smoked&#39;,
 &#39;seen&#39;,
 &#39;slightly&#39;,
 &#39;recount&#39;,
 &#39;wind&#39;,
 &#39;seventeen&#39;,
 &#39;linerental&#39;,
 &#39;vivek&#39;,
 &#39;ta&#39;,
 &#39;buff&#39;,
 &#39;cafe&#39;,
 &#39;75&#39;,
 &#39;eggs&#39;,
 &#39;since&#39;,
 &#39;engagement&#39;,
 &#39;shite&#39;,
 &#39;vinobanagar&#39;,
 &#39;accident&#39;,
 &#39;goodnite&#39;,
 &#39;fret&#39;,
 &#39;rem&#39;,
 &#39;comprehensive&#39;,
 &#39;kegger&#39;,
 &#39;odi&#39;,
 &#39;forgotten&#39;,
 &#39;cry&#39;,
 &#39;retard&#39;,
 &#39;arab&#39;,
 &#39;021&#39;,
 &#39;worries&#39;,
 &#39;wkly&#39;,
 &#39;beneath&#39;,
 &#39;openin&#39;,
 &#39;statement&#39;,
 &#39;20&#39;,
 &#39;cakes&#39;,
 &#39;6months&#39;,
 &#39;shoppin&#39;,
 &#39;16&#39;,
 &#39;balls&#39;,
 &#39;canceled&#39;,
 &#39;gandhipuram&#39;,
 &#39;coat&#39;,
 &#39;unbelievable&#39;,
 &#39;wizzle&#39;,
 &#39;casualty&#39;,
 &#39;speak&#39;,
 &#39;phone750&#39;,
 &#39;babies&#39;,
 &#39;squeezed&#39;,
 &#39;quiteamuzing&#39;,
 &#39;lush&#39;,
 &#39;owe&#39;,
 &#39;selfish&#39;,
 &#39;harish&#39;,
 &#39;frontierville&#39;,
 &#39;telephone&#39;,
 &#39;shudvetold&#39;,
 &#39;i&#39;,
 &#39;mk17&#39;,
 &#39;wil&#39;,
 &#39;lf56&#39;,
 &#39;corporation&#39;,
 &#39;banks&#39;,
 &#39;panalam&#39;,
 &#39;flavour&#39;,
 &#39;honeymoon&#39;,
 &#39;dbuk&#39;,
 &#39;heal&#39;,
 &#39;posible&#39;,
 &#39;hurried&#39;,
 &#39;wth&#39;,
 &#39;be&#39;,
 &#39;blank&#39;,
 &#39;fiting&#39;,
 &#39;iq&#39;,
 &#39;members&#39;,
 &#39;swtheart&#39;,
 &#39;appear&#39;,
 &#39;mobno&#39;,
 &#39;craving&#39;,
 &#39;east&#39;,
 &#39;09050002311&#39;,
 &#39;warm&#39;,
 &#39;upgrdcentre&#39;,
 &#39;loooooool&#39;,
 &#39;mutai&#39;,
 &#39;cld&#39;,
 &#39;ba&#39;,
 &#39;suman&#39;,
 &#39;tiime&#39;,
 &#39;gave&#39;,
 &#39;html&#39;,
 &#39;weather&#39;,
 &#39;dry&#39;,
 &#39;ad&#39;,
 &#39;custcare&#39;,
 &#39;married&#39;,
 &#39;beg&#39;,
 &#39;09061701939&#39;,
 &#39;attack&#39;,
 &#39;msging&#39;,
 &#39;usher&#39;,
 &#39;shortcode&#39;,
 &#39;every1&#39;,
 &#39;prove&#39;,
 &#39;9755&#39;,
 &#39;replacement&#39;,
 &#39;m6&#39;,
 &#39;box403&#39;,
 &#39;08712405020&#39;,
 &#39;bangbabes&#39;,
 &#39;aunt&#39;,
 &#39;envelope&#39;,
 &#39;edwards&#39;,
 &#39;census&#39;,
 &#39;silence&#39;,
 &#39;100percent&#39;,
 &#39;top&#39;,
 &#39;sorted&#39;,
 &#39;control&#39;,
 &#39;innocent&#39;,
 &#39;sink&#39;,
 &#39;pobox12n146tf150p&#39;,
 &#39;herself&#39;,
 &#39;just&#39;,
 &#39;robs&#39;,
 &#39;sucks&#39;,
 &#39;intrude&#39;,
 &#39;smth&#39;,
 &#39;outdoors&#39;,
 &#39;puppy&#39;,
 &#39;completed&#39;,
 &#39;rates&#39;,
 &#39;cosign&#39;,
 &#39;tell&#39;,
 &#39;argument&#39;,
 &#39;sh&#39;,
 &#39;tsunami&#39;,
 &#39;____&#39;,
 &#39;yorge&#39;,
 &#39;colleg&#39;,
 &#39;accounting&#39;,
 &#39;violated&#39;,
 &#39;ebay&#39;,
 &#39;cyclists&#39;,
 &#39;guild&#39;,
 &#39;tunde&#39;,
 &#39;mahfuuz&#39;,
 &#39;live&#39;,
 &#39;cheery&#39;,
 &#39;implications&#39;,
 &#39;polyphonic&#39;,
 &#39;mess&#39;,
 &#39;watevr&#39;,
 &#39;either&#39;,
 &#39;missy&#39;,
 &#39;room&#39;,
 &#39;letters&#39;,
 &#39;muah&#39;,
 &#39;paper&#39;,
 &#39;share&#39;,
 &#39;wasted&#39;,
 &#39;greet&#39;,
 &#39;moan&#39;,
 &#39;smsservices&#39;,
 &#39;length&#39;,
 &#39;burger&#39;,
 &#39;ts&#39;,
 &#39;08000839402&#39;,
 &#39;completes&#39;,
 &#39;breath&#39;,
 &#39;9280114&#39;,
 &#39;hmmross&#39;,
 &#39;themed&#39;,
 &#39;thin&#39;,
 &#39;scared&#39;,
 &#39;mtmsgrcvd18&#39;,
 &#39;brainy&#39;,
 &#39;darlin&#39;,
 &#39;saturday&#39;,
 &#39;used&#39;,
 &#39;uv&#39;,
 &#39;witout&#39;,
 &#39;tee&#39;,
 &#39;logo&#39;,
 &#39;09061221066&#39;,
 &#39;08718730666&#39;,
 &#39;others&#39;,
 &#39;centre&#39;,
 &#39;snogs&#39;,
 &#39;dogg&#39;,
 &#39;empty&#39;,
 &#39;power&#39;,
 &#39;jsco&#39;,
 &#39;prompts&#39;,
 &#39;pictures&#39;,
 &#39;ben&#39;,
 &#39;hyde&#39;,
 &#39;6th&#39;,
 &#39;ed&#39;,
 &#39;fast&#39;,
 &#39;forgot&#39;,
 &#39;emailed&#39;,
 &#39;wifi&#39;,
 &#39;verifying&#39;,
 &#39;impressed&#39;,
 &#39;plans&#39;,
 &#39;aburo&#39;,
 &#39;atleast&#39;,
 &#39;shindig&#39;,
 &#39;mad&#39;,
 &#39;engin&#39;,
 &#39;lou&#39;,
 &#39;t91&#39;,
 &#39;stylish&#39;,
 &#39;attending&#39;,
 &#39;spontaneously&#39;,
 &#39;gravy&#39;,
 &#39;illspeak&#39;,
 &#39;coco&#39;,
 &#39;honestly&#39;,
 &#39;abbey&#39;,
 &#39;rentl&#39;,
 &#39;eh&#39;,
 &#39;aletter&#39;,
 &#39;copies&#39;,
 &#39;put&#39;,
 &#39;genus&#39;,
 &#39;understanding&#39;,
 &#39;upset&#39;,
 &#39;80182&#39;,
 &#39;pesky&#39;,
 &#39;disconnect&#39;,
 &#39;activate&#39;,
 &#39;passionate&#39;,
 &#39;cried&#39;,
 &#39;aco&#39;,
 &#39;paces&#39;,
 &#39;disturbing&#39;,
 &#39;1winaweek&#39;,
 &#39;523&#39;,
 &#39;j5q&#39;,
 &#39;bother&#39;,
 &#39;club4&#39;,
 &#39;make&#39;,
 &#39;07946746291&#39;,
 &#39;soc&#39;,
 &#39;donno&#39;,
 &#39;clocks&#39;,
 &#39;executive&#39;,
 &#39;skip&#39;,
 &#39;0&#39;,
 &#39;hate&#39;,
 &#39;rights&#39;,
 &#39;maths&#39;,
 &#39;laugh&#39;,
 &#39;games&#39;,
 &#39;terrific&#39;,
 &#39;lock&#39;,
 &#39;dat&#39;,
 &#39;sim&#39;,
 &#39;atm&#39;,
 &#39;xavier&#39;,
 &#39;den&#39;,
 &#39;81303&#39;,
 &#39;daddy&#39;,
 &#39;custom&#39;,
 &#39;steamboat&#39;,
 &#39;joining&#39;,
 &#39;worrying&#39;,
 &#39;theirs&#39;,
 &#39;mine&#39;,
 &#39;update_now&#39;,
 &#39;logged&#39;,
 &#39;2moro&#39;,
 &#39;exciting&#39;,
 &#39;push&#39;,
 &#39;headstart&#39;,
 &#39;gam&#39;,
 &#39;grumble&#39;,
 &#39;12hours&#39;,
 &#39;two&#39;,
 &#39;havnt&#39;,
 &#39;whom&#39;,
 &#39;anjie&#39;,
 &#39;pump&#39;,
 &#39;pub&#39;,
 &#39;disclose&#39;,
 &#39;musical&#39;,
 &#39;71&#39;,
 &#39;hugs&#39;,
 &#39;askin&#39;,
 &#39;twat&#39;,
 &#39;adore&#39;,
 &#39;innings&#39;,
 &#39;glorious&#39;,
 &#39;auction&#39;,
 &#39;eating&#39;,
 &#39;50ea&#39;,
 &#39;stunning&#39;,
 &#39;voicemail&#39;,
 &#39;09050280520&#39;,
 &#39;07753741225&#39;,
 &#39;cw25wx&#39;,
 &#39;gage&#39;,
 &#39;kay&#39;,
 &#39;cya&#39;,
 &#39;ll&#39;,
 &#39;ultimatum&#39;,
 &#39;downs&#39;,
 &#39;xxxxx&#39;,
 &#39;kothi&#39;,
 &#39;srsly&#39;,
 &#39;dom&#39;,
 &#39;n9dx&#39;,
 &#39;dick&#39;,
 &#39;swear&#39;,
 &#39;m26&#39;,
 &#39;08700621170150p&#39;,
 &#39;happened&#39;,
 &#39;82277&#39;,
 &#39;paid&#39;,
 &#39;lays&#39;,
 &#39;hasbro&#39;,
 &#39;dining&#39;,
 &#39;edrunk&#39;,
 &#39;abiola&#39;,
 &#39;sudn&#39;,
 &#39;toughest&#39;,
 &#39;09061744553&#39;,
 &#39;honesty&#39;,
 &#39;karaoke&#39;,
 &#39;69866&#39;,
 &#39;preferably&#39;,
 &#39;box434sk38wp150ppm18&#39;,
 &#39;tenerife&#39;,
 &#39;pieces&#39;,
 &#39;drpd&#39;,
 &#39;myparents&#39;,
 &#39;coaxing&#39;,
 &#39;62468&#39;,
 &#39;awaiting&#39;,
 &#39;matured&#39;,
 &#39;jordan&#39;,
 &#39;out&#39;,
 &#39;minute&#39;,
 &#39;answr&#39;,
 &#39;mr&#39;,
 &#39;shb&#39;,
 &#39;grins&#39;,
 &#39;bat&#39;,
 &#39;many&#39;,
 &#39;peeps&#39;,
 &#39;none&#39;,
 &#39;moms&#39;,
 &#39;08712466669&#39;,
 &#39;txtauction&#39;,
 &#39;5wb&#39;,
 &#39;generally&#39;,
 &#39;sections&#39;,
 &#39;middle&#39;,
 &#39;number&#39;,
 &#39;txttowin&#39;,
 &#39;experiencehttp&#39;,
 &#39;mac&#39;,
 &#39;mental&#39;,
 &#39;review&#39;,
 &#39;smaller&#39;,
 &#39;23g&#39;,
 &#39;50&#39;,
 &#39;payoh&#39;,
 &#39;someonone&#39;,
 &#39;09050000878&#39;,
 &#39;tonite&#39;,
 &#39;otherwise&#39;,
 &#39;listed&#39;,
 &#39;machan&#39;,
 &#39;sleeps&#39;,
 &#39;blu&#39;,
 &#39;weight&#39;,
 &#39;raiden&#39;,
 &#39;provider&#39;,
 &#39;relatives&#39;,
 &#39;entered&#39;,
 &#39;1x150p&#39;,
 &#39;friend&#39;,
 &#39;grab&#39;,
 &#39;deck&#39;,
 &#39;roommate&#39;,
 &#39;meatballs&#39;,
 &#39;1327&#39;,
 &#39;dieting&#39;,
 &#39;wihtuot&#39;,
 &#39;complimentary&#39;,
 &#39;ripped&#39;,
 &#39;throwing&#39;,
 &#39;c&#39;,
 &#39;age&#39;,
 &#39;working&#39;,
 &#39;melt&#39;,
 &#39;hop&#39;,
 &#39;campus&#39;,
 &#39;woke&#39;,
 &#39;words&#39;,
 &#39;beforehand&#39;,
 &#39;dobby&#39;,
 &#39;drunk&#39;,
 &#39;dificult&#39;,
 &#39;practicing&#39;,
 &#39;girlie&#39;,
 &#39;position&#39;,
 &#39;ranjith&#39;,
 &#39;respectful&#39;,
 &#39;steve&#39;,
 &#39;negative&#39;,
 &#39;gift&#39;,
 &#39;until&#39;,
 &#39;period&#39;,
 &#39;margin&#39;,
 &#39;usc&#39;,
 &#39;job&#39;,
 &#39;08704439680ts&#39;,
 &#39;08715203685&#39;,
 &#39;zeros&#39;,
 &#39;countin&#39;,
 &#39;squishy&#39;,
 &#39;shelf&#39;,
 &#39;driver&#39;,
 &#39;urgh&#39;,
 &#39;lovers&#39;,
 &#39;winterstone&#39;,
 &#39;did&#39;,
 &#39;b4&#39;,
 &#39;giving&#39;,
 &#39;domain&#39;,
 &#39;sleep&#39;,
 &#39;replying&#39;,
 &#39;announcement&#39;,
 &#39;improved&#39;,
 &#39;freaked&#39;,
 &#39;haventcn&#39;,
 &#39;ringing&#39;,
 &#39;cross&#39;,
 &#39;wouldn&#39;,
 &#39;7684&#39;,
 &#39;83222&#39;,
 &#39;recorder&#39;,
 &#39;blessed&#39;,
 &#39;paru&#39;,
 &#39;decided&#39;,
 &#39;ttyl&#39;,
 &#39;45239&#39;,
 &#39;goodo&#39;,
 &#39;monoc&#39;,
 &#39;won&#39;,
 &#39;terrible&#39;,
 &#39;jewelry&#39;,
 &#39;mys&#39;,
 &#39;dealing&#39;,
 &#39;deal&#39;,
 &#39;3optical&#39;,
 &#39;sittin&#39;,
 &#39;exposed&#39;,
 &#39;identifier&#39;,
 &#39;1120&#39;,
 &#39;é&#39;,
 &#39;mylife&#39;,
 &#39;4utxt&#39;,
 &#39;150pw&#39;,
 &#39;moment&#39;,
 &#39;inclusive&#39;,
 &#39;glands&#39;,
 &#39;dumb&#39;,
 &#39;6zf&#39;,
 &#39;hesitate&#39;,
 &#39;belly&#39;,
 &#39;keen&#39;,
 &#39;hands&#39;,
 &#39;promptly&#39;,
 &#39;commercial&#39;,
 &#39;invention&#39;,
 &#39;ghodbandar&#39;,
 &#39;sn&#39;,
 &#39;plumbing&#39;,
 &#39;tons&#39;,
 &#39;month&#39;,
 &#39;devils&#39;,
 &#39;hurt&#39;,
 &#39;tv&#39;,
 &#39;vikky&#39;,
 &#39;sterm&#39;,
 &#39;haiyoh&#39;,
 &#39;establish&#39;,
 &#39;sweet&#39;,
 &#39;morning&#39;,
 &#39;phews&#39;,
 &#39;ditto&#39;,
 &#39;50pm&#39;,
 &#39;weddin&#39;,
 &#39;bud&#39;,
 &#39;hell&#39;,
 &#39;easiest&#39;,
 &#39;eastenders&#39;,
 &#39;sneham&#39;,
 &#39;strain&#39;,
 &#39;practical&#39;,
 &#39;jason&#39;,
 &#39;97n7qp&#39;,
 &#39;magic&#39;,
 &#39;remains&#39;,
 &#39;08718720201&#39;,
 &#39;shared&#39;,
 &#39;cheap&#39;,
 &#39;tonight&#39;,
 &#39;cartoon&#39;,
 &#39;bullshit&#39;,
 &#39;08715205273&#39;,
 &#39;waht&#39;,
 &#39;timings&#39;,
 &#39;foreign&#39;,
 &#39;missunderstding&#39;,
 &#39;crying&#39;,
 &#39;tix&#39;,
 &#39;ithink&#39;,
 &#39;deltomorrow&#39;,
 &#39;ryder&#39;,
 &#39;sd&#39;,
 &#39;groovy&#39;,
 &#39;sounding&#39;,
 &#39;running&#39;,
 &#39;maga&#39;,
 &#39;tonexs&#39;,
 &#39;flowing&#39;,
 &#39;careers&#39;,
 &#39;camp&#39;,
 &#39;drinks&#39;,
 &#39;maneesha&#39;,
 &#39;mfl&#39;,
 &#39;youi&#39;,
 &#39;8027&#39;,
 &#39;adults&#39;,
 &#39;swhrt&#39;,
 &#39;texts&#39;,
 &#39;movie&#39;,
 &#39;downon&#39;,
 &#39;during&#39;,
 &#39;mom&#39;,
 &#39;cheesy&#39;,
 &#39;irulinae&#39;,
 &#39;ful&#39;,
 &#39;finding&#39;,
 &#39;darkness&#39;,
 &#39;chill&#39;,
 &#39;mymoby&#39;,
 &#39;got&#39;,
 &#39;helpline&#39;,
 &#39;shivratri&#39;,
 &#39;hilarious&#39;,
 &#39;2optout&#39;,
 &#39;braved&#39;,
 &#39;split&#39;,
 &#39;5pm&#39;,
 &#39;talent&#39;,
 &#39;asssssholeeee&#39;,
 &#39;pest&#39;,
 &#39;combine&#39;,
 &#39;customercare&#39;,
 &#39;teasing&#39;,
 &#39;gm&#39;,
 &#39;madoke&#39;,
 &#39;index&#39;,
 &#39;nike&#39;,
 &#39;an&#39;,
 &#39;solved&#39;,
 &#39;tears&#39;,
 &#39;spatula&#39;,
 &#39;idea&#39;,
 &#39;speaking&#39;,
 &#39;each&#39;,
 &#39;let&#39;,
 &#39;morrow&#39;,
 &#39;prize&#39;,
 &#39;pavanaputra&#39;,
 &#39;maintain&#39;,
 &#39;melnite&#39;,
 &#39;lip&#39;,
 &#39;above&#39;,
 &#39;der&#39;,
 &#39;stalk&#39;,
 &#39;ldew&#39;,
 &#39;olayiwola&#39;,
 &#39;cream&#39;,
 &#39;08&#39;,
 &#39;knackered&#39;,
 &#39;box385&#39;,
 &#39;resolution&#39;,
 &#39;semi&#39;,
 &#39;mall&#39;,
 &#39;financial&#39;,
 &#39;told&#39;,
 &#39;0870241182716&#39;,
 &#39;lucyxx&#39;,
 &#39;experiment&#39;,
 &#39;tissco&#39;,
 &#39;contented&#39;,
 &#39;clean&#39;,
 &#39;youuuuu&#39;,
 &#39;raksha&#39;,
 &#39;thread&#39;,
 &#39;w&#39;,
 &#39;trauma&#39;,
 &#39;puttin&#39;,
 &#39;intention&#39;,
 &#39;accent&#39;,
 &#39;forgiven&#39;,
 &#39;random&#39;,
 &#39;thing&#39;,
 &#39;pansy&#39;,
 &#39;handset&#39;,
 &#39;himso&#39;,
 &#39;864233&#39;,
 &#39;aight&#39;,
 &#39;delicious&#39;,
 &#39;taylor&#39;,
 &#39;realise&#39;,
 &#39;appt&#39;,
 &#39;6&#39;,
 &#39;j89&#39;,
 &#39;09061701444&#39;,
 &#39;muhommad&#39;,
 &#39;genes&#39;,
 &#39;images&#39;,
 &#39;8&#39;,
 &#39;va&#39;,
 &#39;tbs&#39;,
 &#39;loss&#39;,
 &#39;oso&#39;,
 &#39;goodies&#39;,
 &#39;pm&#39;,
 &#39;collected&#39;,
 &#39;fran&#39;,
 &#39;whether&#39;,
 &#39;hearts&#39;,
 &#39;liking&#39;,
 &#39;varunnathu&#39;,
 &#39;7ws&#39;,
 &#39;wotz&#39;,
 &#39;cer&#39;,
 &#39;moves&#39;,
 &#39;arrange&#39;,
 &#39;corrupt&#39;,
 &#39;09071517866&#39;,
 &#39;elephant&#39;,
 &#39;08701417012150p&#39;,
 &#39;placement&#39;,
 &#39;neglect&#39;,
 &#39;renewing&#39;,
 &#39;woo&#39;,
 &#39;bout&#39;,
 &#39;14tcr&#39;,
 &#39;gently&#39;,
 &#39;ads&#39;,
 &#39;carpark&#39;,
 &#39;short&#39;,
 &#39;w1j6hl&#39;,
 &#39;frnt&#39;,
 &#39;report&#39;,
 &#39;pehle&#39;,
 &#39;lie&#39;,
 &#39;syd&#39;,
 &#39;bribe&#39;,
 &#39;esplanade&#39;,
 &#39;2yr&#39;,
 &#39;south&#39;,
 &#39;cash&#39;,
 &#39;aft&#39;,
 &#39;jenxxx&#39;,
 &#39;community&#39;,
 &#39;cupboard&#39;,
 &#39;isaiah&#39;,
 &#39;pounds&#39;,
 &#39;oh&#39;,
 &#39;pig&#39;,
 &#39;cage&#39;,
 &#39;presnts&#39;,
 &#39;breathing&#39;,
 &#39;fridge&#39;,
 &#39;lasagna&#39;,
 &#39;parties&#39;,
 &#39;objection&#39;,
 &#39;4th&#39;,
 &#39;word&#39;,
 &#39;pocy&#39;,
 &#39;drugdealer&#39;,
 &#39;sheffield&#39;,
 &#39;hoops&#39;,
 &#39;200&#39;,
 &#39;89034&#39;,
 &#39;ctter&#39;,
 &#39;murderer&#39;,
 &#39;railway&#39;,
 &#39;cann&#39;,
 &#39;shitin&#39;,
 &#39;accomodations&#39;,
 &#39;organizer&#39;,
 &#39;shola&#39;,
 &#39;digital&#39;,
 &#39;draw&#39;,
 &#39;tacos&#39;,
 &#39;bunch&#39;,
 &#39;fantastic&#39;,
 &#39;w111wx&#39;,
 &#39;chop&#39;,
 &#39;gobi&#39;,
 &#39;chocolate&#39;,
 &#39;august&#39;,
 &#39;uhhhhrmm&#39;,
 &#39;fringe&#39;,
 &#39;cookies&#39;,
 &#39;fwiw&#39;,
 &#39;csbcm4235wc1n3xx&#39;,
 &#39;form&#39;,
 &#39;then&#39;,
 &#39;useful&#39;,
 &#39;lyk&#39;,
 &#39;strings&#39;,
 &#39;killed&#39;,
 &#39;shouldn&#39;,
 &#39;ctagg&#39;,
 &#39;uve&#39;,
 &#39;dressed&#39;,
 &#39;location&#39;,
 &#39;blimey&#39;,
 &#39;nope&#39;,
 &#39;flood&#39;,
 &#39;hear&#39;,
 &#39;fires&#39;,
 &#39;09071512432&#39;,
 ...]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create dictionary with number of words in every SMS</span>
<span class="n">word_counts_per_sms</span> <span class="o">=</span> <span class="p">{</span><span class="n">unique_word</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">unique_word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">}</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">sms</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sms</span><span class="p">:</span>
        <span class="n">word_counts_per_sms</span><span class="p">[</span><span class="n">word</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">word_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">word_counts_per_sms</span><span class="p">)</span>
<span class="n">word_counts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loads</th>
      <th>lies</th>
      <th>41782</th>
      <th>want</th>
      <th>werethe</th>
      <th>37819</th>
      <th>24</th>
      <th>min</th>
      <th>arabian</th>
      <th>ugadi</th>
      <th>...</th>
      <th>velusamy</th>
      <th>desires</th>
      <th>crucial</th>
      <th>nok</th>
      <th>youre</th>
      <th>guai</th>
      <th>warming</th>
      <th>orig</th>
      <th>verified</th>
      <th>situations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7783 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">training_set_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">word_counts</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">training_set_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
      <th>loads</th>
      <th>lies</th>
      <th>41782</th>
      <th>want</th>
      <th>werethe</th>
      <th>37819</th>
      <th>24</th>
      <th>min</th>
      <th>...</th>
      <th>velusamy</th>
      <th>desires</th>
      <th>crucial</th>
      <th>nok</th>
      <th>youre</th>
      <th>guai</th>
      <th>warming</th>
      <th>orig</th>
      <th>verified</th>
      <th>situations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>[yep, by, the, pretty, sculpture]</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>[yes, princess, are, you, going, to, make, me,...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ham</td>
      <td>[welp, apparently, he, retired]</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>[havent]</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>[i, forgot, 2, ask, ü, all, smth, there, s, a,...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7785 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the probabilities P(Spam) and P(Ham)</span>

<span class="c1"># P(Spam) = Label(Spam)/Total </span>

<span class="n">p_spam</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;spam&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">)</span>
<span class="n">p_spam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13458950201884254
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># P(Ham) = Label(Ham)/Total</span>

<span class="n">p_ham</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ham&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">training_set_clean</span><span class="p">)</span>
<span class="n">p_ham</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8654104979811574
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate N_Spam; total number of words in all spam messages</span>

<span class="n">n_spam</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;spam&#39;</span><span class="p">][</span><span class="s1">&#39;SMS&#39;</span><span class="p">]:</span>
    <span class="n">n_spam</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="n">n_spam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15190
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate N_Ham; total number of words in all ham messages</span>

<span class="n">n_ham</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ham&#39;</span><span class="p">][</span><span class="s1">&#39;SMS&#39;</span><span class="p">]:</span>
    <span class="n">n_ham</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="n">n_ham</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57237
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate N_Vocabulary; Total number of unique words in all messages</span>

<span class="n">n_vocabulary</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">)</span>
<span class="n">n_vocabulary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7783
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In the calculations Laplace smoothing with a value of 1 is used</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the parameters P(wi|Spam) and P(wi|Ham)</span>

<span class="n">p_wi_spam</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">p_wi_ham</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">:</span>
    <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
<span class="n">spam</span> <span class="o">=</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;spam&#39;</span><span class="p">]</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">training_set_clean</span><span class="p">[</span><span class="n">training_set_clean</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ham&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">:</span>
    <span class="n">n_word_given_spam</span> <span class="o">=</span> <span class="n">spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">p_word_given_spam</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_word_given_spam</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_spam</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">n_vocabulary</span><span class="p">)</span>
    <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_word_given_spam</span>
    
    <span class="n">n_word_given_ham</span> <span class="o">=</span> <span class="n">ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">p_word_given_ham</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_word_given_ham</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_ham</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">n_vocabulary</span><span class="p">)</span>
    <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_word_given_ham</span>
    
<span class="n">p_wi_spam</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;loads&#39;: 8.705872110738693e-05,
 &#39;lies&#39;: 4.3529360553693465e-05,
 &#39;41782&#39;: 8.705872110738693e-05,
 &#39;want&#39;: 0.00113176337439603,
 &#39;werethe&#39;: 4.3529360553693465e-05,
 &#39;37819&#39;: 8.705872110738693e-05,
 &#39;24&#39;: 0.00021764680276846734,
 &#39;min&#39;: 0.0016105863404866582,
 &#39;arabian&#39;: 4.3529360553693465e-05,
 &#39;ugadi&#39;: 4.3529360553693465e-05,
 &#39;came&#39;: 8.705872110738693e-05,
 &#39;tke&#39;: 4.3529360553693465e-05,
 &#39;chit&#39;: 8.705872110738693e-05,
 &#39;able&#39;: 4.3529360553693465e-05,
 &#39;lotsof&#39;: 4.3529360553693465e-05,
 &#39;invitation&#39;: 4.3529360553693465e-05,
 &#39;deserve&#39;: 4.3529360553693465e-05,
 &#39;active&#39;: 0.0001305880816610804,
 &#39;thirunelvali&#39;: 4.3529360553693465e-05,
 &#39;spoon&#39;: 4.3529360553693465e-05,
 &#39;behalf&#39;: 4.3529360553693465e-05,
 &#39;pretend&#39;: 4.3529360553693465e-05,
 &#39;rob&#39;: 4.3529360553693465e-05,
 &#39;unconvinced&#39;: 4.3529360553693465e-05,
 &#39;sextextuk&#39;: 8.705872110738693e-05,
 &#39;〨ud&#39;: 4.3529360553693465e-05,
 &#39;raping&#39;: 4.3529360553693465e-05,
 &#39;opt&#39;: 0.0006094110477517085,
 &#39;file&#39;: 4.3529360553693465e-05,
 &#39;man&#39;: 8.705872110738693e-05,
 &#39;pan&#39;: 4.3529360553693465e-05,
 &#39;suply&#39;: 4.3529360553693465e-05,
 &#39;invest&#39;: 4.3529360553693465e-05,
 &#39;student&#39;: 4.3529360553693465e-05,
 &#39;pick&#39;: 0.0001305880816610804,
 &#39;tor&#39;: 4.3529360553693465e-05,
 &#39;processed&#39;: 8.705872110738693e-05,
 &#39;is&#39;: 0.005963522395856005,
 &#39;lennon&#39;: 4.3529360553693465e-05,
 &#39;astoundingly&#39;: 4.3529360553693465e-05,
 &#39;ummifying&#39;: 4.3529360553693465e-05,
 &#39;body&#39;: 4.3529360553693465e-05,
 &#39;2morow&#39;: 8.705872110738693e-05,
 &#39;laptop&#39;: 4.3529360553693465e-05,
 &#39;zyada&#39;: 4.3529360553693465e-05,
 &#39;church&#39;: 4.3529360553693465e-05,
 &#39;hype&#39;: 4.3529360553693465e-05,
 &#39;goodnight&#39;: 4.3529360553693465e-05,
 &#39;intro&#39;: 4.3529360553693465e-05,
 &#39;netcollex&#39;: 0.00021764680276846734,
 &#39;limping&#39;: 4.3529360553693465e-05,
 &#39;pleasure&#39;: 4.3529360553693465e-05,
 &#39;shipping&#39;: 4.3529360553693465e-05,
 &#39;permission&#39;: 4.3529360553693465e-05,
 &#39;general&#39;: 4.3529360553693465e-05,
 &#39;mileage&#39;: 4.3529360553693465e-05,
 &#39;aldrine&#39;: 4.3529360553693465e-05,
 &#39;enough&#39;: 0.0001305880816610804,
 &#39;plane&#39;: 4.3529360553693465e-05,
 &#39;ppm&#39;: 0.0001305880816610804,
 &#39;frosty&#39;: 4.3529360553693465e-05,
 &#39;snow&#39;: 4.3529360553693465e-05,
 &#39;outside&#39;: 4.3529360553693465e-05,
 &#39;beerage&#39;: 4.3529360553693465e-05,
 &#39;jones&#39;: 4.3529360553693465e-05,
 &#39;thursday&#39;: 4.3529360553693465e-05,
 &#39;science&#39;: 4.3529360553693465e-05,
 &#39;3uz&#39;: 8.705872110738693e-05,
 &#39;lower&#39;: 4.3529360553693465e-05,
 &#39;crowd&#39;: 4.3529360553693465e-05,
 &#39;defeat&#39;: 4.3529360553693465e-05,
 &#39;staring&#39;: 4.3529360553693465e-05,
 &#39;087104711148&#39;: 8.705872110738693e-05,
 &#39;here&#39;: 0.00021764680276846734,
 &#39;bothering&#39;: 4.3529360553693465e-05,
 &#39;patrick&#39;: 4.3529360553693465e-05,
 &#39;watching&#39;: 4.3529360553693465e-05,
 &#39;woken&#39;: 4.3529360553693465e-05,
 &#39;2004&#39;: 0.0003482348844295477,
 &#39;nothin&#39;: 4.3529360553693465e-05,
 &#39;prey&#39;: 4.3529360553693465e-05,
 &#39;crab&#39;: 4.3529360553693465e-05,
 &#39;p&#39;: 0.00021764680276846734,
 &#39;ru&#39;: 4.3529360553693465e-05,
 &#39;inconsiderate&#39;: 4.3529360553693465e-05,
 &#39;excuses&#39;: 4.3529360553693465e-05,
 &#39;slo&#39;: 0.0001305880816610804,
 &#39;10&#39;: 0.0009576459321812563,
 &#39;possible&#39;: 4.3529360553693465e-05,
 &#39;karo&#39;: 4.3529360553693465e-05,
 &#39;auto&#39;: 4.3529360553693465e-05,
 &#39;othrwise&#39;: 4.3529360553693465e-05,
 &#39;dinner&#39;: 4.3529360553693465e-05,
 &#39;cm&#39;: 8.705872110738693e-05,
 &#39;jane&#39;: 8.705872110738693e-05,
 &#39;asusual&#39;: 4.3529360553693465e-05,
 &#39;aiyar&#39;: 4.3529360553693465e-05,
 &#39;09061790125&#39;: 8.705872110738693e-05,
 &#39;currently&#39;: 0.0004352936055369347,
 &#39;apt&#39;: 4.3529360553693465e-05,
 &#39;marriage&#39;: 4.3529360553693465e-05,
 &#39;biatch&#39;: 4.3529360553693465e-05,
 &#39;spacebucks&#39;: 4.3529360553693465e-05,
 &#39;braindance&#39;: 4.3529360553693465e-05,
 &#39;hol&#39;: 8.705872110738693e-05,
 &#39;ki&#39;: 4.3529360553693465e-05,
 &#39;treatin&#39;: 4.3529360553693465e-05,
 &#39;affectionate&#39;: 4.3529360553693465e-05,
 &#39;ink&#39;: 4.3529360553693465e-05,
 &#39;waqt&#39;: 4.3529360553693465e-05,
 &#39;blue&#39;: 8.705872110738693e-05,
 &#39;vip&#39;: 0.00021764680276846734,
 &#39;tmrw&#39;: 4.3529360553693465e-05,
 &#39;issue&#39;: 4.3529360553693465e-05,
 &#39;fonin&#39;: 4.3529360553693465e-05,
 &#39;tactful&#39;: 4.3529360553693465e-05,
 &#39;08718727870&#39;: 0.00017411744221477386,
 &#39;returns&#39;: 4.3529360553693465e-05,
 &#39;heavy&#39;: 4.3529360553693465e-05,
 &#39;damn&#39;: 4.3529360553693465e-05,
 &#39;zealand&#39;: 4.3529360553693465e-05,
 &#39;med&#39;: 0.00017411744221477386,
 &#39;hopeing&#39;: 4.3529360553693465e-05,
 &#39;messenger&#39;: 4.3529360553693465e-05,
 &#39;way2sms&#39;: 4.3529360553693465e-05,
 &#39;nighters&#39;: 4.3529360553693465e-05,
 &#39;refreshed&#39;: 4.3529360553693465e-05,
 &#39;4&#39;: 0.0045705828581378135,
 &#39;clear&#39;: 4.3529360553693465e-05,
 &#39;usual&#39;: 4.3529360553693465e-05,
 &#39;evng&#39;: 4.3529360553693465e-05,
 &#39;entry41&#39;: 8.705872110738693e-05,
 &#39;listened2the&#39;: 4.3529360553693465e-05,
 &#39;bro&#39;: 4.3529360553693465e-05,
 &#39;drive&#39;: 4.3529360553693465e-05,
 &#39;yet&#39;: 4.3529360553693465e-05,
 &#39;kip&#39;: 4.3529360553693465e-05,
 &#39;calling&#39;: 0.00030470552387585427,
 &#39;ntimate&#39;: 4.3529360553693465e-05,
 &#39;display&#39;: 4.3529360553693465e-05,
 &#39;09064011000&#39;: 0.0001305880816610804,
 &#39;percentages&#39;: 4.3529360553693465e-05,
 &#39;1pm&#39;: 4.3529360553693465e-05,
 &#39;rencontre&#39;: 4.3529360553693465e-05,
 &#39;row&#39;: 0.000652940408305402,
 &#39;frank&#39;: 4.3529360553693465e-05,
 &#39;wrking&#39;: 4.3529360553693465e-05,
 &#39;thy&#39;: 4.3529360553693465e-05,
 &#39;area&#39;: 0.00030470552387585427,
 &#39;remembered&#39;: 4.3529360553693465e-05,
 &#39;web2mobile&#39;: 8.705872110738693e-05,
 &#39;vry&#39;: 4.3529360553693465e-05,
 &#39;islands&#39;: 8.705872110738693e-05,
 &#39;barkleys&#39;: 8.705872110738693e-05,
 &#39;steak&#39;: 4.3529360553693465e-05,
 &#39;rightio&#39;: 4.3529360553693465e-05,
 &#39;all&#39;: 0.001218822095503417,
 &#39;86688&#39;: 0.0007399991294127889,
 &#39;bash&#39;: 4.3529360553693465e-05,
 &#39;mgs&#39;: 8.705872110738693e-05,
 &#39;must&#39;: 0.0002611761633221608,
 &#39;complain&#39;: 4.3529360553693465e-05,
 &#39;think&#39;: 0.00017411744221477386,
 &#39;unintentionally&#39;: 4.3529360553693465e-05,
 &#39;09058099801&#39;: 8.705872110738693e-05,
 &#39;parking&#39;: 4.3529360553693465e-05,
 &#39;kalstiya&#39;: 4.3529360553693465e-05,
 &#39;phd&#39;: 4.3529360553693465e-05,
 &#39;kisi&#39;: 4.3529360553693465e-05,
 &#39;ability&#39;: 4.3529360553693465e-05,
 &#39;unlike&#39;: 4.3529360553693465e-05,
 &#39;virgins&#39;: 8.705872110738693e-05,
 &#39;gap&#39;: 4.3529360553693465e-05,
 &#39;08715203649&#39;: 8.705872110738693e-05,
 &#39;d3wv&#39;: 8.705872110738693e-05,
 &#39;londn&#39;: 4.3529360553693465e-05,
 &#39;dha&#39;: 4.3529360553693465e-05,
 &#39;gr8prizes&#39;: 0.0001305880816610804,
 &#39;clothes&#39;: 4.3529360553693465e-05,
 &#39;searching&#39;: 4.3529360553693465e-05,
 &#39;ava&#39;: 4.3529360553693465e-05,
 &#39;delivered&#39;: 0.0001305880816610804,
 &#39;numbers&#39;: 0.00039176424498324117,
 &#39;parkin&#39;: 4.3529360553693465e-05,
 &#39;slowing&#39;: 4.3529360553693465e-05,
 &#39;ros&#39;: 4.3529360553693465e-05,
 &#39;supervisor&#39;: 4.3529360553693465e-05,
 &#39;finish&#39;: 4.3529360553693465e-05,
 &#39;she&#39;: 4.3529360553693465e-05,
 &#39;definitly&#39;: 4.3529360553693465e-05,
 &#39;chef&#39;: 4.3529360553693465e-05,
 &#39;400mins&#39;: 8.705872110738693e-05,
 &#39;ages&#39;: 8.705872110738693e-05,
 &#39;pudunga&#39;: 4.3529360553693465e-05,
 &#39;listener&#39;: 4.3529360553693465e-05,
 &#39;ran&#39;: 4.3529360553693465e-05,
 &#39;cheyyamo&#39;: 4.3529360553693465e-05,
 &#39;renewal&#39;: 8.705872110738693e-05,
 &#39;s89&#39;: 8.705872110738693e-05,
 &#39;sth&#39;: 4.3529360553693465e-05,
 &#39;rejected&#39;: 4.3529360553693465e-05,
 &#39;studentfinancial&#39;: 4.3529360553693465e-05,
 &#39;joined&#39;: 0.0001305880816610804,
 &#39;facilities&#39;: 4.3529360553693465e-05,
 &#39;cooped&#39;: 4.3529360553693465e-05,
 &#39;offers&#39;: 0.000565881687198015,
 &#39;these&#39;: 0.00021764680276846734,
 &#39;wml&#39;: 0.0001305880816610804,
 &#39;nosy&#39;: 4.3529360553693465e-05,
 &#39;dozens&#39;: 8.705872110738693e-05,
 &#39;eh74rr&#39;: 8.705872110738693e-05,
 &#39;profit&#39;: 0.0001305880816610804,
 &#39;compulsory&#39;: 4.3529360553693465e-05,
 &#39;lodging&#39;: 4.3529360553693465e-05,
 &#39;cappuccino&#39;: 4.3529360553693465e-05,
 &#39;dentists&#39;: 4.3529360553693465e-05,
 &#39;cherthala&#39;: 4.3529360553693465e-05,
 &#39;wotu&#39;: 4.3529360553693465e-05,
 &#39;california&#39;: 4.3529360553693465e-05,
 &#39;dictionary&#39;: 4.3529360553693465e-05,
 &#39;fold&#39;: 4.3529360553693465e-05,
 &#39;caps&#39;: 4.3529360553693465e-05,
 &#39;cud&#39;: 4.3529360553693465e-05,
 &#39;qet&#39;: 4.3529360553693465e-05,
 &#39;thinking&#39;: 4.3529360553693465e-05,
 &#39;530&#39;: 4.3529360553693465e-05,
 &#39;mystery&#39;: 8.705872110738693e-05,
 &#39;semester&#39;: 4.3529360553693465e-05,
 &#39;darkest&#39;: 8.705872110738693e-05,
 &#39;gua&#39;: 4.3529360553693465e-05,
 &#39;hostel&#39;: 4.3529360553693465e-05,
 &#39;83118&#39;: 8.705872110738693e-05,
 &#39;consensus&#39;: 4.3529360553693465e-05,
 &#39;times&#39;: 4.3529360553693465e-05,
 &#39;ooooooh&#39;: 4.3529360553693465e-05,
 &#39;jstfrnd&#39;: 4.3529360553693465e-05,
 &#39;4my&#39;: 4.3529360553693465e-05,
 &#39;less&#39;: 4.3529360553693465e-05,
 &#39;63miles&#39;: 4.3529360553693465e-05,
 &#39;model&#39;: 4.3529360553693465e-05,
 &#39;09064019014&#39;: 0.0001305880816610804,
 &#39;private&#39;: 0.0006094110477517085,
 &#39;november&#39;: 8.705872110738693e-05,
 &#39;sed&#39;: 8.705872110738693e-05,
 &#39;redeemable&#39;: 8.705872110738693e-05,
 &#39;makes&#39;: 4.3529360553693465e-05,
 &#39;stability&#39;: 4.3529360553693465e-05,
 &#39;cr9&#39;: 0.0003482348844295477,
 &#39;heaven&#39;: 4.3529360553693465e-05,
 &#39;piggy&#39;: 4.3529360553693465e-05,
 &#39;catches&#39;: 4.3529360553693465e-05,
 &#39;norcorp&#39;: 8.705872110738693e-05,
 &#39;lighters&#39;: 4.3529360553693465e-05,
 &#39;674&#39;: 8.705872110738693e-05,
 &#39;galileo&#39;: 4.3529360553693465e-05,
 &#39;checking&#39;: 4.3529360553693465e-05,
 &#39;positive&#39;: 4.3529360553693465e-05,
 &#39;chikku&#39;: 4.3529360553693465e-05,
 &#39;literally&#39;: 4.3529360553693465e-05,
 &#39;irritated&#39;: 4.3529360553693465e-05,
 &#39;sex&#39;: 0.0004352936055369347,
 &#39;smoked&#39;: 4.3529360553693465e-05,
 &#39;seen&#39;: 4.3529360553693465e-05,
 &#39;slightly&#39;: 4.3529360553693465e-05,
 &#39;recount&#39;: 4.3529360553693465e-05,
 &#39;wind&#39;: 4.3529360553693465e-05,
 &#39;seventeen&#39;: 4.3529360553693465e-05,
 &#39;linerental&#39;: 0.00021764680276846734,
 &#39;vivek&#39;: 4.3529360553693465e-05,
 &#39;ta&#39;: 4.3529360553693465e-05,
 &#39;buff&#39;: 4.3529360553693465e-05,
 &#39;cafe&#39;: 4.3529360553693465e-05,
 &#39;75&#39;: 0.0001305880816610804,
 &#39;eggs&#39;: 4.3529360553693465e-05,
 &#39;since&#39;: 0.0001305880816610804,
 &#39;engagement&#39;: 4.3529360553693465e-05,
 &#39;shite&#39;: 4.3529360553693465e-05,
 &#39;vinobanagar&#39;: 4.3529360553693465e-05,
 &#39;accident&#39;: 0.0001305880816610804,
 &#39;goodnite&#39;: 4.3529360553693465e-05,
 &#39;fret&#39;: 4.3529360553693465e-05,
 &#39;rem&#39;: 4.3529360553693465e-05,
 &#39;comprehensive&#39;: 4.3529360553693465e-05,
 &#39;kegger&#39;: 4.3529360553693465e-05,
 &#39;odi&#39;: 4.3529360553693465e-05,
 &#39;forgotten&#39;: 4.3529360553693465e-05,
 &#39;cry&#39;: 4.3529360553693465e-05,
 &#39;retard&#39;: 4.3529360553693465e-05,
 &#39;arab&#39;: 4.3529360553693465e-05,
 &#39;021&#39;: 8.705872110738693e-05,
 &#39;worries&#39;: 4.3529360553693465e-05,
 &#39;wkly&#39;: 0.0004352936055369347,
 &#39;beneath&#39;: 4.3529360553693465e-05,
 &#39;openin&#39;: 4.3529360553693465e-05,
 &#39;statement&#39;: 0.0005223523266443216,
 &#39;20&#39;: 0.00030470552387585427,
 &#39;cakes&#39;: 4.3529360553693465e-05,
 &#39;6months&#39;: 8.705872110738693e-05,
 &#39;shoppin&#39;: 4.3529360553693465e-05,
 &#39;16&#39;: 0.0019152918643625125,
 &#39;balls&#39;: 4.3529360553693465e-05,
 &#39;canceled&#39;: 4.3529360553693465e-05,
 &#39;gandhipuram&#39;: 4.3529360553693465e-05,
 &#39;coat&#39;: 4.3529360553693465e-05,
 &#39;unbelievable&#39;: 4.3529360553693465e-05,
 &#39;wizzle&#39;: 4.3529360553693465e-05,
 &#39;casualty&#39;: 4.3529360553693465e-05,
 &#39;speak&#39;: 0.0003482348844295477,
 &#39;phone750&#39;: 8.705872110738693e-05,
 &#39;babies&#39;: 4.3529360553693465e-05,
 &#39;squeezed&#39;: 4.3529360553693465e-05,
 &#39;quiteamuzing&#39;: 4.3529360553693465e-05,
 &#39;lush&#39;: 4.3529360553693465e-05,
 &#39;owe&#39;: 4.3529360553693465e-05,
 &#39;selfish&#39;: 4.3529360553693465e-05,
 &#39;harish&#39;: 4.3529360553693465e-05,
 &#39;frontierville&#39;: 4.3529360553693465e-05,
 &#39;telephone&#39;: 8.705872110738693e-05,
 &#39;shudvetold&#39;: 4.3529360553693465e-05,
 &#39;i&#39;: 0.002219997388238367,
 &#39;mk17&#39;: 8.705872110738693e-05,
 &#39;wil&#39;: 4.3529360553693465e-05,
 &#39;lf56&#39;: 0.0001305880816610804,
 &#39;corporation&#39;: 4.3529360553693465e-05,
 &#39;banks&#39;: 4.3529360553693465e-05,
 &#39;panalam&#39;: 4.3529360553693465e-05,
 &#39;flavour&#39;: 4.3529360553693465e-05,
 &#39;honeymoon&#39;: 4.3529360553693465e-05,
 &#39;dbuk&#39;: 8.705872110738693e-05,
 &#39;heal&#39;: 4.3529360553693465e-05,
 &#39;posible&#39;: 4.3529360553693465e-05,
 &#39;hurried&#39;: 4.3529360553693465e-05,
 &#39;wth&#39;: 4.3529360553693465e-05,
 &#39;be&#39;: 0.0018282331432551255,
 &#39;blank&#39;: 4.3529360553693465e-05,
 &#39;fiting&#39;: 4.3529360553693465e-05,
 &#39;iq&#39;: 4.3529360553693465e-05,
 &#39;members&#39;: 0.0001305880816610804,
 &#39;swtheart&#39;: 4.3529360553693465e-05,
 &#39;appear&#39;: 4.3529360553693465e-05,
 &#39;mobno&#39;: 0.0001305880816610804,
 &#39;craving&#39;: 4.3529360553693465e-05,
 &#39;east&#39;: 4.3529360553693465e-05,
 &#39;09050002311&#39;: 8.705872110738693e-05,
 &#39;warm&#39;: 0.0001305880816610804,
 &#39;upgrdcentre&#39;: 8.705872110738693e-05,
 &#39;loooooool&#39;: 4.3529360553693465e-05,
 &#39;mutai&#39;: 4.3529360553693465e-05,
 &#39;cld&#39;: 4.3529360553693465e-05,
 &#39;ba&#39;: 4.3529360553693465e-05,
 &#39;suman&#39;: 4.3529360553693465e-05,
 &#39;tiime&#39;: 4.3529360553693465e-05,
 &#39;gave&#39;: 4.3529360553693465e-05,
 &#39;html&#39;: 8.705872110738693e-05,
 &#39;weather&#39;: 4.3529360553693465e-05,
 &#39;dry&#39;: 4.3529360553693465e-05,
 &#39;ad&#39;: 4.3529360553693465e-05,
 &#39;custcare&#39;: 0.00039176424498324117,
 &#39;married&#39;: 0.0001305880816610804,
 &#39;beg&#39;: 4.3529360553693465e-05,
 &#39;09061701939&#39;: 8.705872110738693e-05,
 &#39;attack&#39;: 4.3529360553693465e-05,
 &#39;msging&#39;: 4.3529360553693465e-05,
 &#39;usher&#39;: 8.705872110738693e-05,
 &#39;shortcode&#39;: 8.705872110738693e-05,
 &#39;every1&#39;: 4.3529360553693465e-05,
 &#39;prove&#39;: 4.3529360553693465e-05,
 &#39;9755&#39;: 8.705872110738693e-05,
 &#39;replacement&#39;: 4.3529360553693465e-05,
 &#39;m6&#39;: 0.0001305880816610804,
 &#39;box403&#39;: 8.705872110738693e-05,
 &#39;08712405020&#39;: 0.0001305880816610804,
 &#39;bangbabes&#39;: 8.705872110738693e-05,
 &#39;aunt&#39;: 4.3529360553693465e-05,
 &#39;envelope&#39;: 0.0001305880816610804,
 &#39;edwards&#39;: 4.3529360553693465e-05,
 &#39;census&#39;: 4.3529360553693465e-05,
 &#39;silence&#39;: 4.3529360553693465e-05,
 &#39;100percent&#39;: 0.0001305880816610804,
 &#39;top&#39;: 0.0006094110477517085,
 &#39;sorted&#39;: 4.3529360553693465e-05,
 &#39;control&#39;: 4.3529360553693465e-05,
 &#39;innocent&#39;: 4.3529360553693465e-05,
 &#39;sink&#39;: 4.3529360553693465e-05,
 &#39;pobox12n146tf150p&#39;: 8.705872110738693e-05,
 &#39;herself&#39;: 0.0001305880816610804,
 &#39;just&#39;: 0.0027858790754363818,
 &#39;robs&#39;: 4.3529360553693465e-05,
 &#39;sucks&#39;: 4.3529360553693465e-05,
 &#39;intrude&#39;: 4.3529360553693465e-05,
 &#39;smth&#39;: 4.3529360553693465e-05,
 &#39;outdoors&#39;: 4.3529360553693465e-05,
 &#39;puppy&#39;: 4.3529360553693465e-05,
 &#39;completed&#39;: 4.3529360553693465e-05,
 &#39;rates&#39;: 0.0003482348844295477,
 &#39;cosign&#39;: 4.3529360553693465e-05,
 &#39;tell&#39;: 0.0006094110477517085,
 &#39;argument&#39;: 4.3529360553693465e-05,
 &#39;sh&#39;: 4.3529360553693465e-05,
 &#39;tsunami&#39;: 8.705872110738693e-05,
 &#39;____&#39;: 4.3529360553693465e-05,
 &#39;yorge&#39;: 4.3529360553693465e-05,
 &#39;colleg&#39;: 4.3529360553693465e-05,
 &#39;accounting&#39;: 4.3529360553693465e-05,
 &#39;violated&#39;: 4.3529360553693465e-05,
 &#39;ebay&#39;: 4.3529360553693465e-05,
 &#39;cyclists&#39;: 4.3529360553693465e-05,
 &#39;guild&#39;: 4.3529360553693465e-05,
 &#39;tunde&#39;: 4.3529360553693465e-05,
 &#39;mahfuuz&#39;: 4.3529360553693465e-05,
 &#39;live&#39;: 0.0011752927349497236,
 &#39;cheery&#39;: 4.3529360553693465e-05,
 &#39;implications&#39;: 4.3529360553693465e-05,
 &#39;polyphonic&#39;: 0.0002611761633221608,
 &#39;mess&#39;: 4.3529360553693465e-05,
 &#39;watevr&#39;: 4.3529360553693465e-05,
 &#39;either&#39;: 0.00039176424498324117,
 &#39;missy&#39;: 4.3529360553693465e-05,
 &#39;room&#39;: 4.3529360553693465e-05,
 &#39;letters&#39;: 4.3529360553693465e-05,
 &#39;muah&#39;: 4.3529360553693465e-05,
 &#39;paper&#39;: 4.3529360553693465e-05,
 &#39;share&#39;: 4.3529360553693465e-05,
 &#39;wasted&#39;: 4.3529360553693465e-05,
 &#39;greet&#39;: 8.705872110738693e-05,
 &#39;moan&#39;: 4.3529360553693465e-05,
 &#39;smsservices&#39;: 8.705872110738693e-05,
 &#39;length&#39;: 4.3529360553693465e-05,
 &#39;burger&#39;: 4.3529360553693465e-05,
 &#39;ts&#39;: 0.0004352936055369347,
 &#39;08000839402&#39;: 0.000565881687198015,
 &#39;completes&#39;: 4.3529360553693465e-05,
 &#39;breath&#39;: 8.705872110738693e-05,
 &#39;9280114&#39;: 8.705872110738693e-05,
 &#39;hmmross&#39;: 8.705872110738693e-05,
 &#39;themed&#39;: 4.3529360553693465e-05,
 &#39;thin&#39;: 4.3529360553693465e-05,
 &#39;scared&#39;: 4.3529360553693465e-05,
 &#39;mtmsgrcvd18&#39;: 0.00021764680276846734,
 &#39;brainy&#39;: 4.3529360553693465e-05,
 &#39;darlin&#39;: 4.3529360553693465e-05,
 &#39;saturday&#39;: 0.0002611761633221608,
 &#39;used&#39;: 8.705872110738693e-05,
 &#39;uv&#39;: 4.3529360553693465e-05,
 &#39;witout&#39;: 4.3529360553693465e-05,
 &#39;tee&#39;: 4.3529360553693465e-05,
 &#39;logo&#39;: 0.0003482348844295477,
 &#39;09061221066&#39;: 0.00017411744221477386,
 &#39;08718730666&#39;: 0.0001305880816610804,
 &#39;others&#39;: 4.3529360553693465e-05,
 &#39;centre&#39;: 4.3529360553693465e-05,
 &#39;snogs&#39;: 4.3529360553693465e-05,
 &#39;dogg&#39;: 4.3529360553693465e-05,
 &#39;empty&#39;: 4.3529360553693465e-05,
 &#39;power&#39;: 4.3529360553693465e-05,
 &#39;jsco&#39;: 0.0001305880816610804,
 &#39;prompts&#39;: 0.0001305880816610804,
 &#39;pictures&#39;: 4.3529360553693465e-05,
 &#39;ben&#39;: 4.3529360553693465e-05,
 &#39;hyde&#39;: 4.3529360553693465e-05,
 &#39;6th&#39;: 4.3529360553693465e-05,
 &#39;ed&#39;: 4.3529360553693465e-05,
 &#39;fast&#39;: 8.705872110738693e-05,
 &#39;forgot&#39;: 4.3529360553693465e-05,
 &#39;emailed&#39;: 4.3529360553693465e-05,
 &#39;wifi&#39;: 4.3529360553693465e-05,
 &#39;verifying&#39;: 4.3529360553693465e-05,
 &#39;impressed&#39;: 4.3529360553693465e-05,
 &#39;plans&#39;: 4.3529360553693465e-05,
 &#39;aburo&#39;: 4.3529360553693465e-05,
 &#39;atleast&#39;: 4.3529360553693465e-05,
 &#39;shindig&#39;: 4.3529360553693465e-05,
 &#39;mad&#39;: 4.3529360553693465e-05,
 &#39;engin&#39;: 4.3529360553693465e-05,
 &#39;lou&#39;: 4.3529360553693465e-05,
 &#39;t91&#39;: 8.705872110738693e-05,
 &#39;stylish&#39;: 4.3529360553693465e-05,
 &#39;attending&#39;: 4.3529360553693465e-05,
 &#39;spontaneously&#39;: 4.3529360553693465e-05,
 &#39;gravy&#39;: 4.3529360553693465e-05,
 &#39;illspeak&#39;: 4.3529360553693465e-05,
 &#39;coco&#39;: 4.3529360553693465e-05,
 &#39;honestly&#39;: 4.3529360553693465e-05,
 &#39;abbey&#39;: 4.3529360553693465e-05,
 &#39;rentl&#39;: 0.00021764680276846734,
 &#39;eh&#39;: 4.3529360553693465e-05,
 &#39;aletter&#39;: 4.3529360553693465e-05,
 &#39;copies&#39;: 4.3529360553693465e-05,
 &#39;put&#39;: 4.3529360553693465e-05,
 &#39;genus&#39;: 4.3529360553693465e-05,
 &#39;understanding&#39;: 4.3529360553693465e-05,
 &#39;upset&#39;: 4.3529360553693465e-05,
 &#39;80182&#39;: 0.0001305880816610804,
 &#39;pesky&#39;: 4.3529360553693465e-05,
 &#39;disconnect&#39;: 4.3529360553693465e-05,
 &#39;activate&#39;: 0.00017411744221477386,
 &#39;passionate&#39;: 4.3529360553693465e-05,
 &#39;cried&#39;: 4.3529360553693465e-05,
 &#39;aco&#39;: 8.705872110738693e-05,
 &#39;paces&#39;: 4.3529360553693465e-05,
 &#39;disturbing&#39;: 4.3529360553693465e-05,
 &#39;1winaweek&#39;: 0.0001305880816610804,
 &#39;523&#39;: 8.705872110738693e-05,
 &#39;j5q&#39;: 8.705872110738693e-05,
 &#39;bother&#39;: 4.3529360553693465e-05,
 &#39;club4&#39;: 8.705872110738693e-05,
 &#39;make&#39;: 0.00047882296609062813,
 &#39;07946746291&#39;: 8.705872110738693e-05,
 &#39;soc&#39;: 4.3529360553693465e-05,
 &#39;donno&#39;: 4.3529360553693465e-05,
 &#39;clocks&#39;: 4.3529360553693465e-05,
 &#39;executive&#39;: 4.3529360553693465e-05,
 &#39;skip&#39;: 8.705872110738693e-05,
 &#39;0&#39;: 0.00017411744221477386,
 &#39;hate&#39;: 4.3529360553693465e-05,
 &#39;rights&#39;: 4.3529360553693465e-05,
 &#39;maths&#39;: 4.3529360553693465e-05,
 &#39;laugh&#39;: 8.705872110738693e-05,
 &#39;games&#39;: 0.000652940408305402,
 &#39;terrific&#39;: 4.3529360553693465e-05,
 &#39;lock&#39;: 4.3529360553693465e-05,
 &#39;dat&#39;: 4.3529360553693465e-05,
 &#39;sim&#39;: 4.3529360553693465e-05,
 &#39;atm&#39;: 4.3529360553693465e-05,
 &#39;xavier&#39;: 4.3529360553693465e-05,
 &#39;den&#39;: 4.3529360553693465e-05,
 &#39;81303&#39;: 0.00017411744221477386,
 &#39;daddy&#39;: 4.3529360553693465e-05,
 &#39;custom&#39;: 4.3529360553693465e-05,
 &#39;steamboat&#39;: 4.3529360553693465e-05,
 &#39;joining&#39;: 4.3529360553693465e-05,
 &#39;worrying&#39;: 4.3529360553693465e-05,
 &#39;theirs&#39;: 8.705872110738693e-05,
 &#39;mine&#39;: 4.3529360553693465e-05,
 &#39;update_now&#39;: 0.0001305880816610804,
 &#39;logged&#39;: 4.3529360553693465e-05,
 &#39;2moro&#39;: 8.705872110738693e-05,
 &#39;exciting&#39;: 0.00021764680276846734,
 &#39;push&#39;: 4.3529360553693465e-05,
 &#39;headstart&#39;: 4.3529360553693465e-05,
 &#39;gam&#39;: 4.3529360553693465e-05,
 &#39;grumble&#39;: 4.3529360553693465e-05,
 &#39;12hours&#39;: 8.705872110738693e-05,
 &#39;two&#39;: 8.705872110738693e-05,
 &#39;havnt&#39;: 4.3529360553693465e-05,
 &#39;whom&#39;: 4.3529360553693465e-05,
 &#39;anjie&#39;: 4.3529360553693465e-05,
 &#39;pump&#39;: 4.3529360553693465e-05,
 &#39;pub&#39;: 8.705872110738693e-05,
 &#39;disclose&#39;: 4.3529360553693465e-05,
 &#39;musical&#39;: 4.3529360553693465e-05,
 &#39;71&#39;: 8.705872110738693e-05,
 &#39;hugs&#39;: 4.3529360553693465e-05,
 &#39;askin&#39;: 4.3529360553693465e-05,
 &#39;twat&#39;: 4.3529360553693465e-05,
 &#39;adore&#39;: 4.3529360553693465e-05,
 &#39;innings&#39;: 4.3529360553693465e-05,
 &#39;glorious&#39;: 4.3529360553693465e-05,
 &#39;auction&#39;: 0.0007399991294127889,
 &#39;eating&#39;: 4.3529360553693465e-05,
 &#39;50ea&#39;: 8.705872110738693e-05,
 &#39;stunning&#39;: 4.3529360553693465e-05,
 &#39;voicemail&#39;: 0.00017411744221477386,
 &#39;09050280520&#39;: 8.705872110738693e-05,
 &#39;07753741225&#39;: 8.705872110738693e-05,
 &#39;cw25wx&#39;: 8.705872110738693e-05,
 &#39;gage&#39;: 8.705872110738693e-05,
 &#39;kay&#39;: 4.3529360553693465e-05,
 &#39;cya&#39;: 4.3529360553693465e-05,
 &#39;ll&#39;: 0.00017411744221477386,
 &#39;ultimatum&#39;: 4.3529360553693465e-05,
 &#39;downs&#39;: 4.3529360553693465e-05,
 &#39;xxxxx&#39;: 8.705872110738693e-05,
 &#39;kothi&#39;: 4.3529360553693465e-05,
 &#39;srsly&#39;: 4.3529360553693465e-05,
 &#39;dom&#39;: 4.3529360553693465e-05,
 &#39;n9dx&#39;: 8.705872110738693e-05,
 &#39;dick&#39;: 8.705872110738693e-05,
 &#39;swear&#39;: 4.3529360553693465e-05,
 &#39;m26&#39;: 8.705872110738693e-05,
 &#39;08700621170150p&#39;: 0.0001305880816610804,
 &#39;happened&#39;: 4.3529360553693465e-05,
 &#39;82277&#39;: 0.0002611761633221608,
 &#39;paid&#39;: 8.705872110738693e-05,
 &#39;lays&#39;: 4.3529360553693465e-05,
 &#39;hasbro&#39;: 4.3529360553693465e-05,
 &#39;dining&#39;: 0.0001305880816610804,
 &#39;edrunk&#39;: 4.3529360553693465e-05,
 &#39;abiola&#39;: 4.3529360553693465e-05,
 &#39;sudn&#39;: 4.3529360553693465e-05,
 &#39;toughest&#39;: 4.3529360553693465e-05,
 &#39;09061744553&#39;: 0.0001305880816610804,
 &#39;honesty&#39;: 4.3529360553693465e-05,
 &#39;karaoke&#39;: 8.705872110738693e-05,
 &#39;69866&#39;: 0.0001305880816610804,
 &#39;preferably&#39;: 4.3529360553693465e-05,
 &#39;box434sk38wp150ppm18&#39;: 8.705872110738693e-05,
 &#39;tenerife&#39;: 0.00017411744221477386,
 &#39;pieces&#39;: 4.3529360553693465e-05,
 &#39;drpd&#39;: 4.3529360553693465e-05,
 &#39;myparents&#39;: 4.3529360553693465e-05,
 &#39;coaxing&#39;: 4.3529360553693465e-05,
 &#39;62468&#39;: 0.0002611761633221608,
 &#39;awaiting&#39;: 0.00030470552387585427,
 &#39;matured&#39;: 4.3529360553693465e-05,
 &#39;jordan&#39;: 0.00017411744221477386,
 &#39;out&#39;: 0.002176468027684673,
 &#39;minute&#39;: 0.00030470552387585427,
 &#39;answr&#39;: 4.3529360553693465e-05,
 &#39;mr&#39;: 0.0001305880816610804,
 &#39;shb&#39;: 4.3529360553693465e-05,
 &#39;grins&#39;: 4.3529360553693465e-05,
 &#39;bat&#39;: 4.3529360553693465e-05,
 &#39;many&#39;: 0.0001305880816610804,
 &#39;peeps&#39;: 4.3529360553693465e-05,
 &#39;none&#39;: 4.3529360553693465e-05,
 &#39;moms&#39;: 4.3529360553693465e-05,
 &#39;08712466669&#39;: 8.705872110738693e-05,
 &#39;txtauction&#39;: 0.0002611761633221608,
 &#39;5wb&#39;: 0.0003482348844295477,
 &#39;generally&#39;: 4.3529360553693465e-05,
 &#39;sections&#39;: 4.3529360553693465e-05,
 &#39;middle&#39;: 4.3529360553693465e-05,
 &#39;number&#39;: 0.0011752927349497236,
 &#39;txttowin&#39;: 0.0001305880816610804,
 &#39;experiencehttp&#39;: 8.705872110738693e-05,
 &#39;mac&#39;: 4.3529360553693465e-05,
 &#39;mental&#39;: 4.3529360553693465e-05,
 &#39;review&#39;: 0.00021764680276846734,
 &#39;smaller&#39;: 4.3529360553693465e-05,
 &#39;23g&#39;: 8.705872110738693e-05,
 &#39;50&#39;: 0.0017847037827014322,
 &#39;payoh&#39;: 4.3529360553693465e-05,
 &#39;someonone&#39;: 8.705872110738693e-05,
 &#39;09050000878&#39;: 8.705872110738693e-05,
 &#39;tonite&#39;: 4.3529360553693465e-05,
 &#39;otherwise&#39;: 4.3529360553693465e-05,
 &#39;listed&#39;: 4.3529360553693465e-05,
 &#39;machan&#39;: 4.3529360553693465e-05,
 &#39;sleeps&#39;: 4.3529360553693465e-05,
 &#39;blu&#39;: 0.0001305880816610804,
 &#39;weight&#39;: 4.3529360553693465e-05,
 &#39;raiden&#39;: 4.3529360553693465e-05,
 &#39;provider&#39;: 4.3529360553693465e-05,
 &#39;relatives&#39;: 4.3529360553693465e-05,
 &#39;entered&#39;: 0.00021764680276846734,
 &#39;1x150p&#39;: 0.00021764680276846734,
 &#39;friend&#39;: 0.00039176424498324117,
 &#39;grab&#39;: 4.3529360553693465e-05,
 &#39;deck&#39;: 8.705872110738693e-05,
 &#39;roommate&#39;: 4.3529360553693465e-05,
 &#39;meatballs&#39;: 4.3529360553693465e-05,
 &#39;1327&#39;: 0.0003482348844295477,
 &#39;dieting&#39;: 4.3529360553693465e-05,
 &#39;wihtuot&#39;: 4.3529360553693465e-05,
 &#39;complimentary&#39;: 0.0003482348844295477,
 &#39;ripped&#39;: 8.705872110738693e-05,
 &#39;throwing&#39;: 4.3529360553693465e-05,
 &#39;c&#39;: 0.0017847037827014322,
 &#39;age&#39;: 0.00030470552387585427,
 &#39;working&#39;: 4.3529360553693465e-05,
 &#39;melt&#39;: 4.3529360553693465e-05,
 &#39;hop&#39;: 4.3529360553693465e-05,
 &#39;campus&#39;: 4.3529360553693465e-05,
 &#39;woke&#39;: 4.3529360553693465e-05,
 &#39;words&#39;: 4.3529360553693465e-05,
 &#39;beforehand&#39;: 4.3529360553693465e-05,
 &#39;dobby&#39;: 4.3529360553693465e-05,
 &#39;drunk&#39;: 4.3529360553693465e-05,
 &#39;dificult&#39;: 4.3529360553693465e-05,
 &#39;practicing&#39;: 4.3529360553693465e-05,
 &#39;girlie&#39;: 4.3529360553693465e-05,
 &#39;position&#39;: 4.3529360553693465e-05,
 &#39;ranjith&#39;: 4.3529360553693465e-05,
 &#39;respectful&#39;: 4.3529360553693465e-05,
 &#39;steve&#39;: 4.3529360553693465e-05,
 &#39;negative&#39;: 4.3529360553693465e-05,
 &#39;gift&#39;: 0.000565881687198015,
 &#39;until&#39;: 0.0002611761633221608,
 &#39;period&#39;: 4.3529360553693465e-05,
 &#39;margin&#39;: 8.705872110738693e-05,
 &#39;usc&#39;: 4.3529360553693465e-05,
 &#39;job&#39;: 4.3529360553693465e-05,
 &#39;08704439680ts&#39;: 8.705872110738693e-05,
 &#39;08715203685&#39;: 8.705872110738693e-05,
 &#39;zeros&#39;: 4.3529360553693465e-05,
 &#39;countin&#39;: 4.3529360553693465e-05,
 &#39;squishy&#39;: 4.3529360553693465e-05,
 &#39;shelf&#39;: 4.3529360553693465e-05,
 &#39;driver&#39;: 4.3529360553693465e-05,
 &#39;urgh&#39;: 4.3529360553693465e-05,
 &#39;lovers&#39;: 4.3529360553693465e-05,
 &#39;winterstone&#39;: 4.3529360553693465e-05,
 &#39;did&#39;: 8.705872110738693e-05,
 &#39;b4&#39;: 0.0002611761633221608,
 &#39;giving&#39;: 8.705872110738693e-05,
 &#39;domain&#39;: 4.3529360553693465e-05,
 &#39;sleep&#39;: 4.3529360553693465e-05,
 &#39;replying&#39;: 0.0002611761633221608,
 &#39;announcement&#39;: 0.0002611761633221608,
 &#39;improved&#39;: 8.705872110738693e-05,
 &#39;freaked&#39;: 4.3529360553693465e-05,
 &#39;haventcn&#39;: 4.3529360553693465e-05,
 &#39;ringing&#39;: 4.3529360553693465e-05,
 &#39;cross&#39;: 8.705872110738693e-05,
 &#39;wouldn&#39;: 4.3529360553693465e-05,
 &#39;7684&#39;: 8.705872110738693e-05,
 &#39;83222&#39;: 0.00017411744221477386,
 &#39;recorder&#39;: 8.705872110738693e-05,
 &#39;blessed&#39;: 4.3529360553693465e-05,
 &#39;paru&#39;: 4.3529360553693465e-05,
 &#39;decided&#39;: 4.3529360553693465e-05,
 &#39;ttyl&#39;: 4.3529360553693465e-05,
 &#39;45239&#39;: 0.00017411744221477386,
 &#39;goodo&#39;: 4.3529360553693465e-05,
 &#39;monoc&#39;: 8.705872110738693e-05,
 &#39;won&#39;: 0.0026988203543289947,
 &#39;terrible&#39;: 4.3529360553693465e-05,
 &#39;jewelry&#39;: 4.3529360553693465e-05,
 &#39;mys&#39;: 4.3529360553693465e-05,
 &#39;dealing&#39;: 4.3529360553693465e-05,
 &#39;deal&#39;: 4.3529360553693465e-05,
 &#39;3optical&#39;: 4.3529360553693465e-05,
 &#39;sittin&#39;: 4.3529360553693465e-05,
 &#39;exposed&#39;: 4.3529360553693465e-05,
 &#39;identifier&#39;: 0.0005223523266443216,
 &#39;1120&#39;: 4.3529360553693465e-05,
 &#39;é&#39;: 4.3529360553693465e-05,
 &#39;mylife&#39;: 4.3529360553693465e-05,
 &#39;4utxt&#39;: 8.705872110738693e-05,
 &#39;150pw&#39;: 8.705872110738693e-05,
 &#39;moment&#39;: 4.3529360553693465e-05,
 &#39;inclusive&#39;: 0.0002611761633221608,
 &#39;glands&#39;: 4.3529360553693465e-05,
 &#39;dumb&#39;: 4.3529360553693465e-05,
 &#39;6zf&#39;: 8.705872110738693e-05,
 &#39;hesitate&#39;: 4.3529360553693465e-05,
 &#39;belly&#39;: 4.3529360553693465e-05,
 &#39;keen&#39;: 4.3529360553693465e-05,
 &#39;hands&#39;: 4.3529360553693465e-05,
 &#39;promptly&#39;: 4.3529360553693465e-05,
 &#39;commercial&#39;: 4.3529360553693465e-05,
 &#39;invention&#39;: 4.3529360553693465e-05,
 &#39;ghodbandar&#39;: 4.3529360553693465e-05,
 &#39;sn&#39;: 8.705872110738693e-05,
 &#39;plumbing&#39;: 4.3529360553693465e-05,
 &#39;tons&#39;: 8.705872110738693e-05,
 &#39;month&#39;: 0.00030470552387585427,
 &#39;devils&#39;: 8.705872110738693e-05,
 &#39;hurt&#39;: 4.3529360553693465e-05,
 &#39;tv&#39;: 0.0004352936055369347,
 &#39;vikky&#39;: 4.3529360553693465e-05,
 &#39;sterm&#39;: 4.3529360553693465e-05,
 &#39;haiyoh&#39;: 4.3529360553693465e-05,
 &#39;establish&#39;: 4.3529360553693465e-05,
 &#39;sweet&#39;: 4.3529360553693465e-05,
 &#39;morning&#39;: 4.3529360553693465e-05,
 &#39;phews&#39;: 4.3529360553693465e-05,
 &#39;ditto&#39;: 4.3529360553693465e-05,
 &#39;50pm&#39;: 8.705872110738693e-05,
 &#39;weddin&#39;: 4.3529360553693465e-05,
 &#39;bud&#39;: 4.3529360553693465e-05,
 &#39;hell&#39;: 4.3529360553693465e-05,
 &#39;easiest&#39;: 4.3529360553693465e-05,
 &#39;eastenders&#39;: 0.0001305880816610804,
 &#39;sneham&#39;: 4.3529360553693465e-05,
 &#39;strain&#39;: 4.3529360553693465e-05,
 &#39;practical&#39;: 4.3529360553693465e-05,
 &#39;jason&#39;: 4.3529360553693465e-05,
 &#39;97n7qp&#39;: 8.705872110738693e-05,
 &#39;magic&#39;: 4.3529360553693465e-05,
 &#39;remains&#39;: 4.3529360553693465e-05,
 &#39;08718720201&#39;: 0.0003482348844295477,
 &#39;shared&#39;: 4.3529360553693465e-05,
 &#39;cheap&#39;: 0.00021764680276846734,
 &#39;tonight&#39;: 8.705872110738693e-05,
 &#39;cartoon&#39;: 4.3529360553693465e-05,
 &#39;bullshit&#39;: 4.3529360553693465e-05,
 &#39;08715205273&#39;: 8.705872110738693e-05,
 &#39;waht&#39;: 4.3529360553693465e-05,
 &#39;timings&#39;: 4.3529360553693465e-05,
 &#39;foreign&#39;: 4.3529360553693465e-05,
 &#39;missunderstding&#39;: 4.3529360553693465e-05,
 &#39;crying&#39;: 4.3529360553693465e-05,
 &#39;tix&#39;: 4.3529360553693465e-05,
 &#39;ithink&#39;: 4.3529360553693465e-05,
 &#39;deltomorrow&#39;: 8.705872110738693e-05,
 &#39;ryder&#39;: 4.3529360553693465e-05,
 &#39;sd&#39;: 4.3529360553693465e-05,
 &#39;groovy&#39;: 4.3529360553693465e-05,
 &#39;sounding&#39;: 4.3529360553693465e-05,
 &#39;running&#39;: 8.705872110738693e-05,
 &#39;maga&#39;: 4.3529360553693465e-05,
 &#39;tonexs&#39;: 8.705872110738693e-05,
 &#39;flowing&#39;: 4.3529360553693465e-05,
 &#39;careers&#39;: 0.0001305880816610804,
 &#39;camp&#39;: 4.3529360553693465e-05,
 &#39;drinks&#39;: 0.0001305880816610804,
 &#39;maneesha&#39;: 4.3529360553693465e-05,
 &#39;mfl&#39;: 8.705872110738693e-05,
 &#39;youi&#39;: 4.3529360553693465e-05,
 &#39;8027&#39;: 8.705872110738693e-05,
 &#39;adults&#39;: 4.3529360553693465e-05,
 &#39;swhrt&#39;: 4.3529360553693465e-05,
 &#39;texts&#39;: 0.0008270578505201758,
 &#39;movie&#39;: 8.705872110738693e-05,
 &#39;downon&#39;: 4.3529360553693465e-05,
 &#39;during&#39;: 8.705872110738693e-05,
 &#39;mom&#39;: 4.3529360553693465e-05,
 &#39;cheesy&#39;: 4.3529360553693465e-05,
 &#39;irulinae&#39;: 4.3529360553693465e-05,
 &#39;ful&#39;: 4.3529360553693465e-05,
 &#39;finding&#39;: 4.3529360553693465e-05,
 &#39;darkness&#39;: 4.3529360553693465e-05,
 &#39;chill&#39;: 4.3529360553693465e-05,
 &#39;mymoby&#39;: 8.705872110738693e-05,
 &#39;got&#39;: 0.00021764680276846734,
 &#39;helpline&#39;: 0.0001305880816610804,
 &#39;shivratri&#39;: 4.3529360553693465e-05,
 &#39;hilarious&#39;: 4.3529360553693465e-05,
 &#39;2optout&#39;: 0.0002611761633221608,
 &#39;braved&#39;: 4.3529360553693465e-05,
 &#39;split&#39;: 4.3529360553693465e-05,
 &#39;5pm&#39;: 4.3529360553693465e-05,
 &#39;talent&#39;: 4.3529360553693465e-05,
 &#39;asssssholeeee&#39;: 4.3529360553693465e-05,
 &#39;pest&#39;: 4.3529360553693465e-05,
 &#39;combine&#39;: 4.3529360553693465e-05,
 &#39;customercare&#39;: 8.705872110738693e-05,
 &#39;teasing&#39;: 4.3529360553693465e-05,
 &#39;gm&#39;: 4.3529360553693465e-05,
 &#39;madoke&#39;: 4.3529360553693465e-05,
 &#39;index&#39;: 0.0001305880816610804,
 &#39;nike&#39;: 4.3529360553693465e-05,
 &#39;an&#39;: 0.0008270578505201758,
 &#39;solved&#39;: 4.3529360553693465e-05,
 &#39;tears&#39;: 4.3529360553693465e-05,
 &#39;spatula&#39;: 4.3529360553693465e-05,
 &#39;idea&#39;: 4.3529360553693465e-05,
 &#39;speaking&#39;: 4.3529360553693465e-05,
 &#39;each&#39;: 0.0003482348844295477,
 &#39;let&#39;: 0.00021764680276846734,
 &#39;morrow&#39;: 4.3529360553693465e-05,
 &#39;prize&#39;: 0.003351760762634397,
 &#39;pavanaputra&#39;: 4.3529360553693465e-05,
 &#39;maintain&#39;: 4.3529360553693465e-05,
 &#39;melnite&#39;: 4.3529360553693465e-05,
 &#39;lip&#39;: 4.3529360553693465e-05,
 &#39;above&#39;: 4.3529360553693465e-05,
 &#39;der&#39;: 4.3529360553693465e-05,
 &#39;stalk&#39;: 4.3529360553693465e-05,
 &#39;ldew&#39;: 0.0003482348844295477,
 &#39;olayiwola&#39;: 4.3529360553693465e-05,
 &#39;cream&#39;: 4.3529360553693465e-05,
 &#39;08&#39;: 0.0001305880816610804,
 &#39;knackered&#39;: 4.3529360553693465e-05,
 &#39;box385&#39;: 0.0001305880816610804,
 &#39;resolution&#39;: 4.3529360553693465e-05,
 &#39;semi&#39;: 4.3529360553693465e-05,
 &#39;mall&#39;: 4.3529360553693465e-05,
 &#39;financial&#39;: 4.3529360553693465e-05,
 &#39;told&#39;: 4.3529360553693465e-05,
 &#39;0870241182716&#39;: 8.705872110738693e-05,
 &#39;lucyxx&#39;: 4.3529360553693465e-05,
 &#39;experiment&#39;: 4.3529360553693465e-05,
 &#39;tissco&#39;: 4.3529360553693465e-05,
 &#39;contented&#39;: 4.3529360553693465e-05,
 &#39;clean&#39;: 4.3529360553693465e-05,
 &#39;youuuuu&#39;: 4.3529360553693465e-05,
 &#39;raksha&#39;: 4.3529360553693465e-05,
 &#39;thread&#39;: 4.3529360553693465e-05,
 &#39;w&#39;: 0.00017411744221477386,
 &#39;trauma&#39;: 4.3529360553693465e-05,
 &#39;puttin&#39;: 4.3529360553693465e-05,
 &#39;intention&#39;: 4.3529360553693465e-05,
 &#39;accent&#39;: 4.3529360553693465e-05,
 &#39;forgiven&#39;: 4.3529360553693465e-05,
 &#39;random&#39;: 4.3529360553693465e-05,
 &#39;thing&#39;: 8.705872110738693e-05,
 &#39;pansy&#39;: 4.3529360553693465e-05,
 &#39;handset&#39;: 0.00030470552387585427,
 &#39;himso&#39;: 4.3529360553693465e-05,
 &#39;864233&#39;: 8.705872110738693e-05,
 &#39;aight&#39;: 4.3529360553693465e-05,
 &#39;delicious&#39;: 4.3529360553693465e-05,
 &#39;taylor&#39;: 4.3529360553693465e-05,
 &#39;realise&#39;: 4.3529360553693465e-05,
 &#39;appt&#39;: 4.3529360553693465e-05,
 &#39;6&#39;: 0.0003482348844295477,
 &#39;j89&#39;: 8.705872110738693e-05,
 &#39;09061701444&#39;: 8.705872110738693e-05,
 &#39;muhommad&#39;: 4.3529360553693465e-05,
 &#39;genes&#39;: 4.3529360553693465e-05,
 &#39;images&#39;: 4.3529360553693465e-05,
 &#39;8&#39;: 8.705872110738693e-05,
 &#39;va&#39;: 4.3529360553693465e-05,
 &#39;tbs&#39;: 8.705872110738693e-05,
 &#39;loss&#39;: 4.3529360553693465e-05,
 &#39;oso&#39;: 4.3529360553693465e-05,
 &#39;goodies&#39;: 8.705872110738693e-05,
 &#39;pm&#39;: 0.00039176424498324117,
 &#39;collected&#39;: 8.705872110738693e-05,
 &#39;fran&#39;: 4.3529360553693465e-05,
 &#39;whether&#39;: 4.3529360553693465e-05,
 &#39;hearts&#39;: 4.3529360553693465e-05,
 &#39;liking&#39;: 4.3529360553693465e-05,
 &#39;varunnathu&#39;: 4.3529360553693465e-05,
 &#39;7ws&#39;: 8.705872110738693e-05,
 &#39;wotz&#39;: 4.3529360553693465e-05,
 &#39;cer&#39;: 4.3529360553693465e-05,
 &#39;moves&#39;: 4.3529360553693465e-05,
 &#39;arrange&#39;: 8.705872110738693e-05,
 &#39;corrupt&#39;: 4.3529360553693465e-05,
 &#39;09071517866&#39;: 8.705872110738693e-05,
 &#39;elephant&#39;: 4.3529360553693465e-05,
 &#39;08701417012150p&#39;: 0.0001305880816610804,
 &#39;placement&#39;: 4.3529360553693465e-05,
 &#39;neglect&#39;: 4.3529360553693465e-05,
 &#39;renewing&#39;: 8.705872110738693e-05,
 &#39;woo&#39;: 4.3529360553693465e-05,
 &#39;bout&#39;: 8.705872110738693e-05,
 &#39;14tcr&#39;: 8.705872110738693e-05,
 &#39;gently&#39;: 4.3529360553693465e-05,
 &#39;ads&#39;: 0.0001305880816610804,
 &#39;carpark&#39;: 4.3529360553693465e-05,
 &#39;short&#39;: 4.3529360553693465e-05,
 &#39;w1j6hl&#39;: 0.0004352936055369347,
 &#39;frnt&#39;: 4.3529360553693465e-05,
 &#39;report&#39;: 4.3529360553693465e-05,
 &#39;pehle&#39;: 4.3529360553693465e-05,
 &#39;lie&#39;: 4.3529360553693465e-05,
 &#39;syd&#39;: 4.3529360553693465e-05,
 &#39;bribe&#39;: 4.3529360553693465e-05,
 &#39;esplanade&#39;: 4.3529360553693465e-05,
 &#39;2yr&#39;: 0.0001305880816610804,
 &#39;south&#39;: 4.3529360553693465e-05,
 &#39;cash&#39;: 0.0026552909937753015,
 &#39;aft&#39;: 4.3529360553693465e-05,
 &#39;jenxxx&#39;: 4.3529360553693465e-05,
 &#39;community&#39;: 0.0001305880816610804,
 &#39;cupboard&#39;: 4.3529360553693465e-05,
 &#39;isaiah&#39;: 4.3529360553693465e-05,
 &#39;pounds&#39;: 0.0006964697688590954,
 &#39;oh&#39;: 4.3529360553693465e-05,
 &#39;pig&#39;: 4.3529360553693465e-05,
 &#39;cage&#39;: 4.3529360553693465e-05,
 &#39;presnts&#39;: 4.3529360553693465e-05,
 &#39;breathing&#39;: 4.3529360553693465e-05,
 &#39;fridge&#39;: 4.3529360553693465e-05,
 &#39;lasagna&#39;: 4.3529360553693465e-05,
 &#39;parties&#39;: 8.705872110738693e-05,
 &#39;objection&#39;: 4.3529360553693465e-05,
 &#39;4th&#39;: 4.3529360553693465e-05,
 &#39;word&#39;: 0.0008270578505201758,
 &#39;pocy&#39;: 4.3529360553693465e-05,
 &#39;drugdealer&#39;: 4.3529360553693465e-05,
 &#39;sheffield&#39;: 4.3529360553693465e-05,
 &#39;hoops&#39;: 4.3529360553693465e-05,
 &#39;200&#39;: 0.0004352936055369347,
 &#39;89034&#39;: 8.705872110738693e-05,
 &#39;ctter&#39;: 4.3529360553693465e-05,
 &#39;murderer&#39;: 4.3529360553693465e-05,
 &#39;railway&#39;: 4.3529360553693465e-05,
 &#39;cann&#39;: 4.3529360553693465e-05,
 &#39;shitin&#39;: 4.3529360553693465e-05,
 &#39;accomodations&#39;: 4.3529360553693465e-05,
 &#39;organizer&#39;: 4.3529360553693465e-05,
 &#39;shola&#39;: 4.3529360553693465e-05,
 &#39;digital&#39;: 0.0003482348844295477,
 &#39;draw&#39;: 0.001305880816610804,
 &#39;tacos&#39;: 4.3529360553693465e-05,
 &#39;bunch&#39;: 4.3529360553693465e-05,
 &#39;fantastic&#39;: 0.00030470552387585427,
 &#39;w111wx&#39;: 0.00021764680276846734,
 &#39;chop&#39;: 4.3529360553693465e-05,
 &#39;gobi&#39;: 4.3529360553693465e-05,
 &#39;chocolate&#39;: 4.3529360553693465e-05,
 &#39;august&#39;: 0.0001305880816610804,
 &#39;uhhhhrmm&#39;: 4.3529360553693465e-05,
 &#39;fringe&#39;: 4.3529360553693465e-05,
 &#39;cookies&#39;: 4.3529360553693465e-05,
 &#39;fwiw&#39;: 4.3529360553693465e-05,
 &#39;csbcm4235wc1n3xx&#39;: 0.00017411744221477386,
 &#39;form&#39;: 4.3529360553693465e-05,
 &#39;then&#39;: 0.0004352936055369347,
 &#39;useful&#39;: 4.3529360553693465e-05,
 &#39;lyk&#39;: 4.3529360553693465e-05,
 &#39;strings&#39;: 8.705872110738693e-05,
 &#39;killed&#39;: 4.3529360553693465e-05,
 &#39;shouldn&#39;: 4.3529360553693465e-05,
 &#39;ctagg&#39;: 4.3529360553693465e-05,
 &#39;uve&#39;: 8.705872110738693e-05,
 &#39;dressed&#39;: 4.3529360553693465e-05,
 &#39;location&#39;: 4.3529360553693465e-05,
 &#39;blimey&#39;: 4.3529360553693465e-05,
 &#39;nope&#39;: 4.3529360553693465e-05,
 &#39;flood&#39;: 4.3529360553693465e-05,
 &#39;hear&#39;: 0.00017411744221477386,
 &#39;fires&#39;: 4.3529360553693465e-05,
 &#39;09071512432&#39;: 8.705872110738693e-05,
 ...}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to be used as spam filter</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>

    <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\W&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="n">p_spam_given_message</span> <span class="o">=</span> <span class="n">p_spam</span>
    <span class="n">p_ham_given_message</span> <span class="o">=</span> <span class="n">p_ham</span>
    
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_spam</span><span class="p">:</span>
            <span class="n">p_spam_given_message</span> <span class="o">*=</span> <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_ham</span><span class="p">:</span>
            <span class="n">p_ham_given_message</span> <span class="o">*=</span> <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(Spam|message):&#39;</span><span class="p">,</span> <span class="n">p_spam_given_message</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;P(Ham|message):&#39;</span><span class="p">,</span> <span class="n">p_ham_given_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_ham_given_message</span> <span class="o">&gt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Label: Ham&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">p_ham_given_message</span> <span class="o">&lt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Label: Spam&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Equal proabilities, have a human classify this!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classify</span><span class="p">(</span><span class="s1">&#39;WINNER!! This is the secret code to unlock the money: C3421.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(Spam|message): 1.3481290211300841e-25
P(Ham|message): 1.9368049028589875e-27
Label: Spam
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classify</span><span class="p">(</span><span class="s1">&#39;Sounds good, Tom, then see u there&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(Spam|message): 2.4372375665888117e-25
P(Ham|message): 3.687530435009238e-21
Label: Ham
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="test-accuracy">
<h2>Test accuracy<a class="headerlink" href="#test-accuracy" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test the accuracy of the algorithme</span>

<span class="k">def</span> <span class="nf">classify_test_set</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>

    <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\W&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="n">p_spam_given_message</span> <span class="o">=</span> <span class="n">p_spam</span>
    <span class="n">p_ham_given_message</span> <span class="o">=</span> <span class="n">p_ham</span>

    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_spam</span><span class="p">:</span>
            <span class="n">p_spam_given_message</span> <span class="o">*=</span> <span class="n">p_wi_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">p_wi_ham</span><span class="p">:</span>
            <span class="n">p_ham_given_message</span> <span class="o">*=</span> <span class="n">p_wi_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">p_ham_given_message</span> <span class="o">&gt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;ham&#39;</span>
    <span class="k">elif</span> <span class="n">p_spam_given_message</span> <span class="o">&gt;</span> <span class="n">p_ham_given_message</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;spam&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;needs human classification&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;SMS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">classify_test_set</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Label</th>
      <th>SMS</th>
      <th>predicted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ham</td>
      <td>Later i guess. I needa do mcat study too.</td>
      <td>ham</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ham</td>
      <td>But i haf enuff space got like 4 mb...</td>
      <td>ham</td>
    </tr>
    <tr>
      <td>2</td>
      <td>spam</td>
      <td>Had your mobile 10 mths? Update to latest Oran...</td>
      <td>spam</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ham</td>
      <td>All sounds good. Fingers . Makes it difficult ...</td>
      <td>ham</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ham</td>
      <td>All done, all handed in. Don't know if mega sh...</td>
      <td>ham</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Accuracy of the spam filter</span>
<span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]:</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="mi">1</span>
        
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correct:&#39;</span><span class="p">,</span> <span class="n">correct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Incorrect:&#39;</span><span class="p">,</span> <span class="n">total</span> <span class="o">-</span> <span class="n">correct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy:&#39;</span><span class="p">,</span> <span class="n">correct</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Correct: 1100
Incorrect: 14
Accuracy: 0.9874326750448833
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>The accuracy is close to 98.74%, which is really good. Our spam filter looked at 1,114 messages that it hasn’t seen in training, and classified 1,100 correctly.</p>
<p>Next Steps
In this project, we managed to build a spam filter for SMS messages using the multinomial Naive Bayes algorithm. The filter had an accuracy of 98.74% on the test set we used, which is a pretty good result. Our initial goal was an accuracy of over 80%, and we managed to do way better than that.</p>
<p>Next steps include:</p>
<ul class="simple">
<li><p>Analyze the 14 messages that were classified incorrectly and try to figure out why the algorithm classified them incorrectly</p></li>
<li><p>Make the filtering process more complex by making the algorithm sensitive to letter case</p></li>
<li><p>Get the project portfolio-ready by using a few tips from our style guide for data science projects.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="HandwrittenDigitsClassifierUsingCrossValidation.html" title="previous page">Building A Handwritten Digits Classifier using Cross Validation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Arnoud Beerepoot<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>